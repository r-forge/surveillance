<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calibration Tests for Poisson or Negative Binomial Predictions — calibrationTest • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calibration Tests for Poisson or Negative Binomial Predictions — calibrationTest"><meta name="description" content='The implemented calibration tests for Poisson or negative binomial
  predictions of count data are based on proper scoring rules and
  described in detail in Wei and Held (2014).
  The following proper scoring rules are available:
  Dawid-Sebastiani score ("dss"),
  logarithmic score ("logs"),
  ranked probability score ("rps").'><meta property="og:description" content='The implemented calibration tests for Poisson or negative binomial
  predictions of count data are based on proper scoring rules and
  described in detail in Wei and Held (2014).
  The following proper scoring rules are available:
  Dawid-Sebastiani score ("dss"),
  logarithmic score ("logs"),
  ranked probability score ("rps").'><!-- For Rd equations in pkgdown 2.1.0, see https://katex.org/docs/autorender.html --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          throwOnError: false,
          macros: {"\\code": "\\texttt"}
      })
  });
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.24.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calibration Tests for Poisson or Negative Binomial Predictions</h1>

      <div class="d-none name"><code>calibration.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The implemented calibration tests for Poisson or negative binomial
  predictions of count data are based on proper scoring rules and
  described in detail in Wei and Held (2014).
  The following proper scoring rules are available:
  Dawid-Sebastiani score (<code>"dss"</code>),
  logarithmic score (<code>"logs"</code>),
  ranked probability score (<code>"rps"</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calibrationTest</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">calibrationTest</span><span class="op">(</span><span class="va">x</span>, <span class="va">mu</span>, size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dss"</span>, <span class="st">"logs"</span>, <span class="st">"rps"</span><span class="op">)</span>,</span>
<span>                tolerance <span class="op">=</span> <span class="fl">1e-4</span>, method <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>the observed counts.
    All involved functions are vectorized and also accept matrices or arrays.</p></dd>

  <dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>the means of the predictive distributions for the
    observations <code>x</code>.</p></dd>

  <dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>either <code>NULL</code> (default), indicating Poisson predictions with mean
    <code>mu</code>, or dispersion parameters of
    negative binomial forecasts for the observations <code>x</code>,
    parametrized as in <code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom</a></code> with variance
    <code>mu*(1+mu/size)</code>.</p></dd>

  <dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>a character string indicating which proper scoring rule to apply.</p></dd>

  <dt id="arg-tolerance">tolerance<a class="anchor" aria-label="anchor" href="#arg-tolerance"></a></dt>
<dd><p>absolute tolerance for the null expectation and variance of
    <code>"logs"</code> and <code>"rps"</code>. For the latter, see the note below.
    Unused for <code>which = "dss"</code> (closed form).</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>selection of the \(z\)-statistic: <code>method = 2</code> refers to
    the alternative test statistic \(Z_s^*\) of Wei and Held (2014,
    Discussion), which has been recommended for low counts.
    <code>method = 1</code> corresponds to Equation 5 in Wei and Held (2014).</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>unused (argument of the generic).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of class <code>"htest"</code>,
  which is a list with the following components:</p>
<dl><dt>method</dt>
<dd><p>a character string indicating the type of test
    performed (including <code>which</code> scoring rule).</p></dd>

  <dt>data.name</dt>
<dd><p>a character string naming the supplied <code>x</code> argument.</p></dd>

  <dt>statistic</dt>
<dd><p>the \(z\)-statistic of the test.</p></dd>

  <dt>parameter</dt>
<dd><p>the number of predictions underlying the test, i.e., <code>length(x)</code>.</p></dd>

  <dt>p.value</dt>
<dd><p>the p-value for the test.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If the <a href="https://CRAN.R-project.org/package=gsl" class="external-link"><span class="pkg">gsl</span></a> package is installed, its implementations of the
  Bessel and hypergeometric functions are used when calculating the null
  expectation and variance of the <code>rps</code>.
  These functions are faster and yield more accurate results (especially
  for larger <code>mu</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wei, W. and Held, L. (2014):
  Calibration tests for count data.
  <em>Test</em>, <b>23</b>, 787-805.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Meyer and Wei Wei</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="va">pi</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">mu</span>, size <span class="op">=</span> <span class="va">size</span><span class="op">)</span></span>
<span><span class="fu">calibrationTest</span><span class="op">(</span><span class="va">y</span>, mu <span class="op">=</span> <span class="va">mu</span>, size <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="co"># p = 0.99</span></span>
<span><span class="fu">calibrationTest</span><span class="op">(</span><span class="va">y</span>, mu <span class="op">=</span> <span class="va">mu</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># p = 4.3e-05</span></span>
<span><span class="fu">calibrationTest</span><span class="op">(</span><span class="va">y</span>, mu <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="co"># p = 0.6959</span></span>
<span><span class="fu">calibrationTest</span><span class="op">(</span><span class="va">y</span>, mu <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">size</span>, which <span class="op">=</span> <span class="st">"rps"</span><span class="op">)</span> <span class="co"># p = 0.1286</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

