<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calibration Tests for Poisson or Negative Binomial Predictions — calibrationTest • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Calibration Tests for Poisson or Negative Binomial Predictions — calibrationTest">
<meta property="og:description" content='The implemented calibration tests for Poisson or negative binomial
  predictions of count data are based on proper scoring rules and
  described in detail in Wei and Held (2014).
  The following proper scoring rules are available:
  Dawid-Sebastiani score ("dss"),
  logarithmic score ("logs"),
  ranked probability score ("rps").'>
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom>
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <img src="" class="pkg-logo" alt=""><div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Calibration Tests for Poisson or Negative Binomial Predictions</h1>
    
    <div class="d-none name"><code>calibration.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The implemented calibration tests for Poisson or negative binomial
  predictions of count data are based on proper scoring rules and
  described in detail in Wei and Held (2014).
  The following proper scoring rules are available:
  Dawid-Sebastiani score (<code>"dss"</code>),
  logarithmic score (<code>"logs"</code>),
  ranked probability score (<code>"rps"</code>).</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="fu"><a href="calibration.html">calibrationTest</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu"><a href="calibration.html">calibrationTest</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mu</span>, size <span class="op">=</span> <span class="cn">NULL</span>,
                which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dss"</span>, <span class="st">"logs"</span>, <span class="st">"rps"</span><span class="op">)</span>,
                tolerance <span class="op">=</span> <span class="fl">1e-4</span>, method <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">x</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>the observed counts.
    All involved functions are vectorized and also accept matrices or arrays.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">mu</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>the means of the predictive distributions for the
    observations <code>x</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">size</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>either <code>NULL</code> (default), indicating Poisson predictions with mean
    <code>mu</code>, or dispersion parameters of
    negative binomial forecasts for the observations <code>x</code>,
    parametrized as in <code><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></code> with variance
    <code>mu*(1+mu/size)</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">which</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>a character string indicating which proper scoring rule to apply.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">tolerance</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>absolute tolerance for the null expectation and variance of
    <code>"logs"</code> and <code>"rps"</code>. For the latter, see the note below.
    Unused for <code>which = "dss"</code> (closed form).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">method</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>selection of the \(z\)-statistic: <code>method = 2</code> refers to
    the alternative test statistic \(Z_s^*\) of Wei and Held (2014,
    Discussion), which has been recommended for low counts.
    <code>method = 1</code> corresponds to Equation 5 in Wei and Held (2014).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">...</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>unused (argument of the generic).</p></dd>
    </dl>
<h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code>"htest"</code>,
  which is a list with the following components:</p>
<dt>method</dt>
<dd><p>a character string indicating the type of test
    performed (including <code>which</code> scoring rule).</p></dd>
  <dt>data.name</dt>
<dd><p>a character string naming the supplied <code>x</code> argument.</p></dd>
  <dt>statistic</dt>
<dd><p>the \(z\)-statistic of the test.</p></dd>
  <dt>parameter</dt>
<dd><p>the number of predictions underlying the test, i.e., <code><a href="https://rdrr.io/r/base/length.html">length(x)</a></code>.</p></dd>
  <dt>p.value</dt>
<dd><p>the p-value for the test.</p></dd>

    <h2 class="hasAnchor" id="note">
<a class="anchor" href="#note"></a>Note</h2>

    <p>If the <a href="https://CRAN.R-project.org/package=gsl"><span class="pkg">gsl</span></a> package is installed, its implementations of the
  Bessel and hypergeometric functions are used when calculating the null
  expectation and variance of the <code>rps</code>.
  These functions are faster and yield more accurate results (especially
  for larger <code>mu</code>).</p>
    <h2 class="hasAnchor" id="references">
<a class="anchor" href="#references"></a>References</h2>

    <p>Wei, W. and Held, L. (2014):
  Calibration tests for count data.
  <em>Test</em>, <b>23</b>, 787-805.</p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Meyer and Wei Wei</p>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="va">pi</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">rnbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">mu</span>, size <span class="op">=</span> <span class="va">size</span><span class="op">)</span>
<span class="fu"><a href="calibration.html">calibrationTest</a></span><span class="op">(</span><span class="va">y</span>, mu <span class="op">=</span> <span class="va">mu</span>, size <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="co"># p = 0.99</span>
<span class="fu"><a href="calibration.html">calibrationTest</a></span><span class="op">(</span><span class="va">y</span>, mu <span class="op">=</span> <span class="va">mu</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># p = 4.3e-05</span>
<span class="fu"><a href="calibration.html">calibrationTest</a></span><span class="op">(</span><span class="va">y</span>, mu <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="co"># p = 0.6959</span>
<span class="fu"><a href="calibration.html">calibrationTest</a></span><span class="op">(</span><span class="va">y</span>, mu <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">size</span>, which <span class="op">=</span> <span class="st">"rps"</span><span class="op">)</span> <span class="co"># p = 0.1286</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

