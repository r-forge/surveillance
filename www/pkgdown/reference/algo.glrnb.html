<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Count Data Regression Charts — algo.glrnb • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Count Data Regression Charts — algo.glrnb"><meta name="description" content="Count data regression charts for the monitoring of surveillance time
 series as proposed by Höhle and Paul (2008).
 The implementation is described in Salmon et al. (2016)."><meta property="og:description" content="Count data regression charts for the monitoring of surveillance time
 series as proposed by Höhle and Paul (2008).
 The implementation is described in Salmon et al. (2016)."><!-- For Rd equations in pkgdown 2.1.0, see https://katex.org/docs/autorender.html --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          throwOnError: false,
          macros: {"\\code": "\\texttt"}
      })
  });
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.24.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Count Data Regression Charts</h1>

      <div class="d-none name"><code>algo.glrnb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Count data regression charts for the monitoring of surveillance time
 series as proposed by Höhle and Paul (2008).
 The implementation is described in Salmon et al. (2016).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">algo.glrnb</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="va">range</span>, c.ARL<span class="op">=</span><span class="fl">5</span>,</span>
<span>           mu0<span class="op">=</span><span class="cn">NULL</span>, alpha<span class="op">=</span><span class="fl">0</span>, Mtilde<span class="op">=</span><span class="fl">1</span>, M<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, change<span class="op">=</span><span class="st">"intercept"</span>,</span>
<span>           theta<span class="op">=</span><span class="cn">NULL</span>, dir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inc"</span>,<span class="st">"dec"</span><span class="op">)</span>,</span>
<span>           ret<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cases"</span>,<span class="st">"value"</span><span class="op">)</span>, xMax<span class="op">=</span><span class="fl">1e4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">algo.glrpois</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="va">range</span>, c.ARL<span class="op">=</span><span class="fl">5</span>,</span>
<span>             mu0<span class="op">=</span><span class="cn">NULL</span>, Mtilde<span class="op">=</span><span class="fl">1</span>, M<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, change<span class="op">=</span><span class="st">"intercept"</span>,</span>
<span>             theta<span class="op">=</span><span class="cn">NULL</span>, dir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inc"</span>,<span class="st">"dec"</span><span class="op">)</span>,</span>
<span>             ret<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cases"</span>,<span class="st">"value"</span><span class="op">)</span>, xMax<span class="op">=</span><span class="fl">1e4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-disprogobj">disProgObj<a class="anchor" aria-label="anchor" href="#arg-disprogobj"></a></dt>
<dd><p>object of class <code>disProg</code> to do surveillance for.
  For new <code><a href="sts-class.html">sts</a></code>-class data, use the <code><a href="wrap.algo.html">glrnb</a></code>
  wrapper, or the <code><a href="disProg2sts.html">sts2disProg</a></code> converter.</p></dd>

<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list controlling the behaviour of the algorithm</p><dl><dt><code>range</code></dt>
<dd><p>vector of indices in the observed vector
        to monitor (should be consecutive)</p></dd>


    <dt><code>mu0</code></dt>
<dd><p>A vector of in-control values of the mean of the
        Poisson / negative binomial
        distribution with the same length as <code>range</code>. If
        <code>NULL</code> the observed values in <code>1:(min(range)-1)</code> are
        used to estimate the beta vector through a generalized linear
        model. To
        fine-tune the model one can instead specify <code>mu0</code> as a
        list with two components:</p><dl><dt><code>S</code></dt>
<dd><p>integer number of harmonics to include
        (typically 1 or 2)</p></dd>

          <dt><code>trend</code></dt>
<dd><p>A Boolean indicating whether to include a term <code>t</code> in the GLM model</p></dd>

	
</dl><p>The fitting is controlled by the <code>estimateGLRNbHook</code>
        function. The in-control mean model is re-fitted after every
	alarm. The fitted models can be found as a list <code>mod</code> in
        the <code>control</code> slot after the call.</p>
<p>Note: If a value for <code>alpha</code> is given, then the inverse of
        this value is used as fixed <code>theta</code> in a
        <code><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html" class="external-link">negative.binomial</a></code> <code>glm</code>.
        If <code>is.null(alpha)</code> then the parameter is
        estimated as well (using <code><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></code>) –
        see the description of this parameter for details.</p></dd>

    <dt><code>alpha</code></dt>
<dd><p>The (known) dispersion parameter of the negative
        binomial distribution, i.e. the parametrization of the negative
        binomial is such that the variance is \(mean +
        alpha*mean^2\). Note: This parametrization
        is the inverse of the shape parametrization used in R – for
        example in <code>dnbinom</code> and <code>glr.nb</code>. Hence, if
        <code>alpha=0</code> then the negative binomial distribution boils
        down to the Poisson distribution and a call of <code>algo.glrnb</code>
        is equivalent to a call to <code>algo.glrpois</code>. If
        <code>alpha=NULL</code> the parameter is calculated as part of the
        in-control estimation. However, the parameter is estimated only
        once from the first fit. Subsequent fittings are only for the
        parameters of the linear predictor with <code>alpha</code> fixed.</p></dd>

    <dt><code>c.ARL</code></dt>
<dd><p>threshold in the GLR test,
        i.e. \(c_{\gamma}\)</p></dd>

    <dt><code>Mtilde</code></dt>
<dd><p>number of observations needed before we
        have a full rank the typical setup for the
        "<code>intercept</code>" and "<code>epi</code>" charts is <code>Mtilde=1</code></p></dd>

    <dt><code>M</code></dt>
<dd><p>number of time instances back in time in the
        window-limited approach, i.e. the last value
        considered is \(\max{1,n-M}\). To always look back
        until the first observation use <code>M=-1</code>.</p></dd>

    <dt><code>change</code></dt>
<dd><p>a string specifying the type of the
        alternative. Currently the two choices are
        <code>intercept</code> and <code>epi</code>. See the SFB
        Discussion Paper 500 for details.</p></dd>

    <dt><code>theta</code></dt>
<dd><p>if <code>NULL</code> then the GLR scheme is
        used. If not <code>NULL</code> the prespecified value for
        \(\kappa\) or \(\lambda\) is used in a recursive
        LR scheme, which is faster.</p></dd>

    <dt><code>dir</code></dt>
<dd><p>a string specifying the direction of testing in
        GLR scheme. With <code>"inc"</code> only increases in \(x\) are
        considered in the GLR-statistic, with <code>"dec"</code> decreases
        are regarded.</p></dd>

    <dt><code>ret</code></dt>
<dd><p>a string specifying the type of
        <code>upperbound</code>-statistic that is returned. With
        <code>"cases"</code> the number of cases that would have been
        necessary to produce an alarm or with <code>"value"</code> the
        GLR-statistic is computed (see below).</p></dd>

      <dt><code>xMax</code></dt>
<dd><p>Maximum value to try for x to see if this is
        the upperbound number of cases before sounding an alarm
        (Default: 1e4). This only applies for the GLR using the NegBin
        when <code>ret="cases"</code> – see details.</p></dd>


</dl><p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>algo.glrpois</code> simply calls <code>algo.glrnb</code> with
  <code>control$alpha</code> set to 0.</p>
<p><code>algo.glrnb</code> returns a list of class
    <code>survRes</code> (surveillance result), which includes the alarm
    value for recognizing an outbreak (1 for alarm, 0 for no alarm),
    the threshold value for recognizing the alarm and the input object
    of class disProg. The <code>upperbound</code> slot of the object are
    filled with the current \(GLR(n)\) value or with the number of
    cases that are necessary to produce an alarm at any time point
    \(\leq n\). Both lead to the same alarm timepoints, but
    <code>"cases"</code> has an obvious interpretation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>This function implements the seasonal count data chart based on
  generalized likelihood ratio (GLR) as described in the Höhle and Paul
  (2008) paper. A moving-window generalized likelihood ratio
  detector is used, i.e. the detector has the form
<!-- % -->
$$N = \inf\left\{ n : \max_{1\leq k \leq
      n} \left[ \sum_{t=k}^n \log \left\{
        \frac{f_{\theta_1}(x_t|z_t)}{f_{\theta_0}(x_t|z_t)} \right\}
    \right] \geq c_\gamma \right\} $$
<!-- % -->
where instead of \(1\leq k \leq n\) the GLR statistic is
computed for all \(k \in \{n-M, \ldots, n-\tilde{M}+1\}\). To
achieve the typical behaviour from \(1\leq k\leq n\) use
<code>Mtilde=1</code> and <code>M=-1</code>.</p>
<p>So \(N\) is the time point where the GLR statistic is above the
threshold the first time: An alarm is given and the surveillance is
reset starting from time \(N+1\). Note that the same
<code>c.ARL</code> as before is used, but if <code>mu0</code> is different at
\(N+1,N+2,\ldots\) compared to time \(1,2,\ldots\) the run length
properties differ. Because <code>c.ARL</code> to obtain a specific ARL can
only be obtained my Monte Carlo simulation there is no good way to
update <code>c.ARL</code> automatically at the moment. Also, FIR GLR-detectors
might be worth considering.</p>
<p>In case <code>is.null(theta)</code> and <code>alpha&gt;0</code> as well as
<code>ret="cases"</code> then a brute-force search is conducted for each time
point in range in order to determine the number of cases necessary
before an alarm is sounded. In case no alarm was sounded so far by time
\(t\), the function increases \(x[t]\) until an alarm is sounded any
time before time point \(t\). If no alarm is sounded by <code>xMax</code>, a return value
of 1e99 is given. Similarly, if an alarm was sounded by time \(t\) the
function counts down instead. Note: This is slow experimental code!</p>
<p>At the moment, window limited “<code>intercept</code>” charts have not been
extensively tested and are at the moment not supported. As speed is
not an issue here this doesn't bother too much. Therefore, a value of
<code>M=-1</code> is always used in the intercept charts.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>M. Höhle with contributions by V. Wimmer</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Höhle, M. and Paul, M. (2008):
  Count data regression charts for the monitoring of surveillance time
  series. Computational Statistics and Data Analysis, 52 (9), 4357-4368.</p>
<p>Salmon, M., Schumacher, D. and Höhle, M. (2016):
  Monitoring count time series in <span style="R">R</span>: Aberration detection in public
  health surveillance. <em>Journal of Statistical Software</em>,
  <b>70</b> (10), 1-35. <a href="https://doi.org/10.18637/jss.v070.i10" class="external-link">doi:10.18637/jss.v070.i10</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">##Simulate data and apply the algorithm</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span> ; <span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">120</span> ; <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">0.6</span>,<span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">52</span></span>
<span><span class="co">#log mu_{0,t}</span></span>
<span><span class="va">base</span> <span class="op">&lt;-</span> <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">omega</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">omega</span><span class="op">*</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="co">#Generate example data with changepoint and tau=tau</span></span>
<span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">base</span><span class="op">)</span></span>
<span><span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">base</span>  <span class="op">+</span> <span class="va">kappa</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Poisson example</span></span>
<span><span class="co">#Generate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>,<span class="va">mu0</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">t</span><span class="op">&gt;=</span><span class="va">tau</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s.ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="sts-class.html">sts</a></span><span class="op">(</span>observed<span class="op">=</span><span class="va">x</span>, state<span class="op">=</span><span class="op">(</span><span class="va">t</span><span class="op">&gt;=</span><span class="va">tau</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Plot the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s.ts</span>, xaxis.labelFormat<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#Run</span></span>
<span><span class="va">cntrl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="va">t</span>,c.ARL<span class="op">=</span><span class="fl">5</span>, Mtilde<span class="op">=</span><span class="fl">1</span>, mu0<span class="op">=</span><span class="va">mu0</span>,</span>
<span>             change<span class="op">=</span><span class="st">"intercept"</span>,ret<span class="op">=</span><span class="st">"value"</span>,dir<span class="op">=</span><span class="st">"inc"</span><span class="op">)</span></span>
<span><span class="va">glr.ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">glrpois</a></span><span class="op">(</span><span class="va">s.ts</span>,control<span class="op">=</span><span class="va">cntrl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">glr.ts</span>, xaxis.labelFormat<span class="op">=</span><span class="cn">NULL</span>, dx.upperbound<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">lr.ts</span>  <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">glrpois</a></span><span class="op">(</span><span class="va">s.ts</span>,control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cntrl</span>,theta<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lr.ts</span>, xaxis.labelFormat<span class="op">=</span><span class="cn">NULL</span>, dx.upperbound<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#using the legacy interface for "disProg" data</span></span>
<span><span class="va">lr.ts0</span>  <span class="op">&lt;-</span> <span class="fu">algo.glrpois</span><span class="op">(</span><span class="fu"><a href="disProg2sts.html">sts2disProg</a></span><span class="op">(</span><span class="va">s.ts</span><span class="op">)</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cntrl</span>,theta<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="stsSlots.html">upperbound</a></span><span class="op">(</span><span class="va">lr.ts</span><span class="op">)</span> <span class="op">==</span> <span class="va">lr.ts0</span><span class="op">$</span><span class="va">upperbound</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## NegBin example</span></span>
<span><span class="co">#Generate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>,mu<span class="op">=</span><span class="va">mu0</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">t</span><span class="op">&gt;=</span><span class="va">tau</span><span class="op">)</span><span class="op">)</span>,size<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">s.ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="sts-class.html">sts</a></span><span class="op">(</span>observed<span class="op">=</span><span class="va">x</span>, state<span class="op">=</span><span class="op">(</span><span class="va">t</span><span class="op">&gt;=</span><span class="va">tau</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s.ts</span>, xaxis.labelFormat<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run GLR based detection</span></span>
<span><span class="va">cntrl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="va">t</span>,c.ARL<span class="op">=</span><span class="fl">5</span>, Mtilde<span class="op">=</span><span class="fl">1</span>, mu0<span class="op">=</span><span class="va">mu0</span>, alpha<span class="op">=</span><span class="va">alpha</span>,</span>
<span>             change<span class="op">=</span><span class="st">"intercept"</span>,ret<span class="op">=</span><span class="st">"value"</span>,dir<span class="op">=</span><span class="st">"inc"</span><span class="op">)</span></span>
<span><span class="va">glr.ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">glrnb</a></span><span class="op">(</span><span class="va">s.ts</span>, control<span class="op">=</span><span class="va">cntrl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">glr.ts</span>, xaxis.labelFormat<span class="op">=</span><span class="cn">NULL</span>, dx.upperbound<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#CUSUM LR detection with backcalculated number of cases</span></span>
<span><span class="va">cntrl2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="va">t</span>,c.ARL<span class="op">=</span><span class="fl">5</span>, Mtilde<span class="op">=</span><span class="fl">1</span>, mu0<span class="op">=</span><span class="va">mu0</span>, alpha<span class="op">=</span><span class="va">alpha</span>,</span>
<span>              change<span class="op">=</span><span class="st">"intercept"</span>,ret<span class="op">=</span><span class="st">"cases"</span>,dir<span class="op">=</span><span class="st">"inc"</span>,theta<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="va">glr.ts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">glrnb</a></span><span class="op">(</span><span class="va">s.ts</span>, control<span class="op">=</span><span class="va">cntrl2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">glr.ts2</span>, xaxis.labelFormat<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

