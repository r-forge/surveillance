<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spatial Interaction Function Objects — twinstim_siaf • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial Interaction Function Objects — twinstim_siaf"><meta name="description" content="A spatial interaction function for use in twinstim
  can be constructed via the siaf function.
  It checks the supplied function elements, assigns defaults for
  missing arguments, and returns all checked arguments in a list.
  However, for standard applications it is much easier to use one of the
  pre-defined spatial interaction functions, e.g.,
  siaf.gaussian."><meta property="og:description" content="A spatial interaction function for use in twinstim
  can be constructed via the siaf function.
  It checks the supplied function elements, assigns defaults for
  missing arguments, and returns all checked arguments in a list.
  However, for standard applications it is much easier to use one of the
  pre-defined spatial interaction functions, e.g.,
  siaf.gaussian."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@bastistician"><meta name="twitter:site" content="@bastistician"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spatial Interaction Function Objects</h1>

      <div class="d-none name"><code>twinstim_siaf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A spatial interaction function for use in <code><a href="twinstim.html">twinstim</a></code>
  can be constructed via the <code>siaf</code> function.
  It checks the supplied function elements, assigns defaults for
  missing arguments, and returns all checked arguments in a list.
  However, for standard applications it is much easier to use one of the
  pre-defined spatial interaction functions, e.g.,
  <code><a href="twinstim_iaf.html">siaf.gaussian</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">siaf</span><span class="op">(</span><span class="va">f</span>, <span class="cn">F</span>, <span class="va">Fcircle</span>, <span class="va">effRange</span>, <span class="va">deriv</span>, <span class="va">Deriv</span>, <span class="va">simulate</span>, <span class="va">npars</span>,</span>
<span>     validpars <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>the spatial interaction function. It must accept
    two arguments, the first one being a (2-column) coordinate matrix, the
    second one a parameter vector. For marked <code>twinstim</code>, it must
    accept the type of the event (integer code) as its third argument
    (either a single type for all locations or separate types for each
    location).</p></dd>


  <dt id="arg-f">F<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>function computing the integral of \(f(s)\) (passed as
    second argument) over a polygonal <code>"owin"</code> domain (first argument).
    The third and fourth argument are
    the parameter vector and the (<em>single</em>) type, respectively.
    There may be additional arguments, which can then be specified in
    the <code>control.siaf$F</code> argument list of <code>twinstim</code>. If the <code>F</code>
    function is missing, a general default (<code><a href="https://rdrr.io/pkg/polyCub/man/polyCub.html" class="external-link">polyCub</a></code>)
    will be used, with extra arguments <code>method</code> (default: <code>"SV"</code>)
    and corresponding accuracy parameters.</p></dd>


  <dt id="arg-fcircle">Fcircle<a class="anchor" aria-label="anchor" href="#arg-fcircle"></a></dt>
<dd><p>optional function for fast calculation of the
    (two-dimensional) integral of \(f(s)\) over a circle with radius
    <code>r</code> (first argument). Further arguments are as for <code>f</code>. It
    must not be vectorized (will always be called with single radius
    and a single type). If this function is specified, integration of
    the <code>siaf</code> over the spatial influence region of an event will
    be faster if the region is actually circular. This is the case if
    the event is located at least a distance <code>eps.s</code> from the border
    of the observation region <code>W</code>, or if the distance to the border
    is larger than the effective integration range (if specified, see
    <code>effRange</code> below).</p></dd>


  <dt id="arg-effrange">effRange<a class="anchor" aria-label="anchor" href="#arg-effrange"></a></dt>
<dd><p>optional function returning the “effective”
    range of \(f(s)\) for the given set of parameters (the first and
    only argument) such that the circle with radius <code>effRange</code>
    contains the numerically essential proportion of the
    integral mass. For the Gaussian kernel the default is
    <code>function (logsd) 6*exp(logsd)</code>. The return value must be a
    vector of length <code>nTypes</code> (effective range for each type). This
    function is only used if <code>Fcircle</code> is also specified.</p></dd>


  <dt id="arg-deriv">deriv<a class="anchor" aria-label="anchor" href="#arg-deriv"></a></dt>
<dd><p>optional derivative of \(f(s)\) <em>with respect to
      the parameters</em>. It takes the same arguments as <code>f</code> but
    returns a matrix with as many rows as there were coordinates in the
    input and <code>npars</code> columns. This derivative is necessary for the
    calculation of the score function in <code><a href="twinstim.html">twinstim()</a></code>, which is
    advantageous for the numerical log-likelihood maximization.</p></dd>


  <dt id="arg-deriv">Deriv<a class="anchor" aria-label="anchor" href="#arg-deriv"></a></dt>
<dd><p>function computing the integral of <code>deriv</code> (passed as
    second argument) over a polygonal <code>"owin"</code> domain (first
    argument). The return value is thus a vector of length <code>npars</code>.
    The third argument is the parameter vector and the fourth argument
    is a (<em>single</em>) type and must be named <code>type</code>.
    There may be additional arguments, which can then be specified in
    the <code>control.siaf$Deriv</code> argument list of <code>twinstim</code>. If the
    <code>Deriv</code> function is missing, a general default
    (<code><a href="https://rdrr.io/pkg/polyCub/man/polyCub.html" class="external-link">polyCub</a></code>) will be used, with extra arguments
    <code>method</code> (default: <code>"SV"</code>) and corresponding accuracy parameters.</p></dd>


  <dt id="arg-simulate">simulate<a class="anchor" aria-label="anchor" href="#arg-simulate"></a></dt>
<dd><p>optional function returning a sample drawn from the
    spatial kernel (only required for the simulation of <code>twinstim</code>
    models).  Its first argument is the size of the sample to
    generate, next the parameter vector, an optional single event type,
    and an optional upper bound for the radius within which to simulate
    points. The function must return a two-column <em>matrix</em> of the
    sampled locations.
    Note that the simulation method actually samples only one location
    at a time, thus it is sufficient to have a working
    <code>function(n=1, pars, type, ub)</code>.</p></dd>


  <dt id="arg-npars">npars<a class="anchor" aria-label="anchor" href="#arg-npars"></a></dt>
<dd><p>the number of parameters of the spatial interaction
    function <code>f</code> (i.e. the length of its second argument).</p></dd>


  <dt id="arg-validpars">validpars<a class="anchor" aria-label="anchor" href="#arg-validpars"></a></dt>
<dd><p>optional function taking one argument, the parameter vector, indicating if it
    is valid. This approach to specify parameter constraints is rarely
    needed, because usual box-constrained parameters can be taken into
    account by using L-BFGS-B as the optimization method in
    <code>twinstim</code> (with arguments <code>lower</code> and <code>upper</code>), and
    positivity constraints by using log-parametrizations.
    This component is not necessary (and ignored) if <code>npars == 0</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>list of checked arguments.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Meyer</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="twinstim_iaf.html">siaf.gaussian</a></code> for a pre-defined spatial interaction
  function, and <code><a href="twinstim_tiaf.html">tiaf</a></code> for the temporal interaction function.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

