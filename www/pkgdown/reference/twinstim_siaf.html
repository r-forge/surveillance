<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Spatial Interaction Function Objects — twinstim_siaf • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spatial Interaction Function Objects — twinstim_siaf">
<meta property="og:description" content="A spatial interaction function for use in twinstim
  can be constructed via the siaf function.
  It checks the supplied function elements, assigns defaults for
  missing arguments, and returns all checked arguments in a list.
  However, for standard applications it is much easier to use one of the
  pre-defined spatial interaction functions, e.g.,
  siaf.gaussian.">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom data-tolerance="5" data-offset="100">
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Spatial Interaction Function Objects</h1>
    
    <div class="d-none name"><code>twinstim_siaf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A spatial interaction function for use in <code><a href="twinstim.html">twinstim</a></code>
  can be constructed via the <code>siaf</code> function.
  It checks the supplied function elements, assigns defaults for
  missing arguments, and returns all checked arguments in a list.
  However, for standard applications it is much easier to use one of the
  pre-defined spatial interaction functions, e.g.,
  <code><a href="twinstim_iaf.html">siaf.gaussian</a></code>.</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="fu">siaf</span><span class="op">(</span><span class="va">f</span>, <span class="cn">F</span>, <span class="va">Fcircle</span>, <span class="va">effRange</span>, <span class="va">deriv</span>, <span class="va">Deriv</span>, <span class="va">simulate</span>, <span class="va">npars</span>,
     validpars <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">f</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>the spatial interaction function. It must accept
    two arguments, the first one being a (2-column) coordinate matrix, the
    second one a parameter vector. For marked <code>twinstim</code>, it must
    accept the type of the event (integer code) as its third argument
    (either a single type for all locations or separate types for each
    location).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">F</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>function computing the integral of \(f(s)\) (passed as
    second argument) over a polygonal <code>"owin"</code> domain (first argument).
    The third and fourth argument are
    the parameter vector and the (<em>single</em>) type, respectively.
    There may be additional arguments, which can then be specified in
    the <code>control.siaf$F</code> argument list of <code>twinstim</code>. If the <code>F</code>
    function is missing, a general default (<code><a href="https://rdrr.io/pkg/polyCub/man/polyCub.html">polyCub</a></code>) 
    will be used, with extra arguments <code>method</code> (default: <code>"SV"</code>) 
    and corresponding accuracy parameters.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">Fcircle</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>optional function for fast calculation of the
    (two-dimensional) integral of \(f(s)\) over a circle with radius
    <code>r</code> (first argument). Further arguments are as for <code>f</code>. It
    must not be vectorized (will always be called with single radius
    and a single type). If this function is specified, integration of
    the <code>siaf</code> over the spatial influence region of an event will
    be faster if the region is actually circular. This is the case if
    the event is located at least a distance <code>eps.s</code> from the border
    of the observation region <code>W</code>, or if the distance to the border
    is larger than the effective integration range (if specified, see
    <code>effRange</code> below).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">effRange</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>optional function returning the “effective”
    range of \(f(s)\) for the given set of parameters (the first and
    only argument) such that the circle with radius <code>effRange</code>
    contains the numerically essential proportion of the 
    integral mass. For the Gaussian kernel the default is
    <code>function (logsd) 6*exp(logsd)</code>. The return value must be a
    vector of length <code>nTypes</code> (effective range for each type). This
    function is only used if <code>Fcircle</code> is also specified.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">deriv</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>optional derivative of \(f(s)\) <em>with respect to
      the parameters</em>. It takes the same arguments as <code>f</code> but
    returns a matrix with as many rows as there were coordinates in the
    input and <code>npars</code> columns. This derivative is necessary for the
    calculation of the score function in <code><a href="twinstim.html">twinstim()</a></code>, which is
    advantageous for the numerical log-likelihood maximization.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">Deriv</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>function computing the integral of <code>deriv</code> (passed as
    second argument) over a polygonal <code>"owin"</code> domain (first
    argument). The return value is thus a vector of length <code>npars</code>.
    The third argument is the parameter vector and the fourth argument
    is a (<em>single</em>) type and must be named <code>type</code>.
    There may be additional arguments, which can then be specified in
    the <code>control.siaf$Deriv</code> argument list of <code>twinstim</code>. If the
    <code>Deriv</code> function is missing, a general default
    (<code><a href="https://rdrr.io/pkg/polyCub/man/polyCub.html">polyCub</a></code>) will be used, with extra arguments
    <code>method</code> (default: <code>"SV"</code>) and corresponding accuracy parameters.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">simulate</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>optional function returning a sample drawn from the
    spatial kernel (only required for the simulation of <code>twinstim</code>
    models).  Its first argument is the size of the sample to
    generate, next the parameter vector, an optional single event type,
    and an optional upper bound for the radius within which to simulate
    points. The function must return a two-column <em>matrix</em> of the
    sampled locations. 
    Note that the simulation method actually samples only one location
    at a time, thus it is sufficient to have a working
    <code>function(n=1, pars, type, ub)</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">npars</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>the number of parameters of the spatial interaction
    function <code>f</code> (i.e. the length of its second argument).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">validpars</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>optional function taking one argument, the parameter vector, indicating if it
    is valid. This approach to specify parameter constraints is rarely
    needed, because usual box-constrained parameters can be taken into
    account by using L-BFGS-B as the optimization method in
    <code>twinstim</code> (with arguments <code>lower</code> and <code>upper</code>), and
    positivity constraints by using log-parametrizations.
    This component is not necessary (and ignored) if <code>npars == 0</code>.</p></dd>
    </dl>
<h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p>list of checked arguments.</p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Meyer</p>
    <h2 class="hasAnchor" id="see-also">
<a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index"><p><code><a href="twinstim_iaf.html">siaf.gaussian</a></code> for a pre-defined spatial interaction
  function, and <code><a href="twinstim_tiaf.html">tiaf</a></code> for the temporal interaction function.</p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

