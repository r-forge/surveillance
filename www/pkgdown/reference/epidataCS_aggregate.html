<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Conversion (aggregation) of "epidataCS" to "epidata" or "sts" — epidataCS_aggregate • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conversion (aggregation) of " epidatacs to or epidatacs_aggregate><meta name="description" content='Continuous-time continuous-space epidemic data stored in an object of
  class "epidataCS" can be aggregated in space or in space
  and time yielding an object of class "epidata" or
  "sts" for use of twinSIR or
  hhh4 modelling, respectively.'><meta property="og:description" content='Continuous-time continuous-space epidemic data stored in an object of
  class "epidataCS" can be aggregated in space or in space
  and time yielding an object of class "epidata" or
  "sts" for use of twinSIR or
  hhh4 modelling, respectively.'><!-- For Rd equations in pkgdown 2.1.0, see https://katex.org/docs/autorender.html --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          throwOnError: false,
          macros: {"\\code": "\\texttt"}
      })
  });
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Conversion (aggregation) of <code>"epidataCS"</code> to <code>"epidata"</code> or <code>"sts"</code></h1>

      <div class="d-none name"><code>epidataCS_aggregate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Continuous-time continuous-space epidemic data stored in an object of
  class <code>"<a href="epidataCS.html">epidataCS</a>"</code> can be aggregated in space or in space
  and time yielding an object of class <code>"<a href="epidata.html">epidata</a>"</code> or
  <code>"<a href="sts-class.html">sts</a>"</code> for use of <code><a href="twinSIR.html">twinSIR</a></code> or
  <code><a href="hhh4.html">hhh4</a></code> modelling, respectively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">## aggregation in space and time over 'stgrid' for use of 'hhh4' models</span></span>
<span><span class="fu">epidataCS2sts</span><span class="op">(</span><span class="va">object</span>, <span class="va">freq</span>, <span class="va">start</span>, <span class="va">neighbourhood</span>,</span>
<span>              tiles <span class="op">=</span> <span class="cn">NULL</span>, popcol.stgrid <span class="op">=</span> <span class="cn">NULL</span>, popdensity <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## aggregation in space for use of 'twinSIR' models</span></span>
<span><span class="co"># S3 method for class 'epidataCS'</span></span>
<span><span class="fu"><a href="epidata.html">as.epidata</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">tileCentroids</span>, eps <span class="op">=</span> <span class="fl">0.001</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-object-data">object, data<a class="anchor" aria-label="anchor" href="#arg-object-data"></a></dt>
<dd><p>an object of class <code>"<a href="epidataCS.html">epidataCS</a>"</code>.</p></dd>

  <dt id="arg-freq-start">freq,start<a class="anchor" aria-label="anchor" href="#arg-freq-start"></a></dt>
<dd><p>see the description of the <code>"<a href="sts-class.html">sts</a>"</code> class.
    The <code>start</code> specification should reflect the beginning of
    <code>object$stgrid</code>, i.e., the start of the first time interval.</p></dd>

  <dt id="arg-neighbourhood">neighbourhood<a class="anchor" aria-label="anchor" href="#arg-neighbourhood"></a></dt>
<dd><p>binary adjacency or neighbourhood-order matrix of the regions
    (<code>tiles</code>). If missing but <code>tiles</code> is given, a binary
    adjacency matrix will be auto-generated from <code>tiles</code> using
    functionality of the <span class="pkg">spdep</span> package (see
    <code><a href="poly2adjmat.html">poly2adjmat</a></code>).
    Since the <code>"neighbourhood"</code> slot in <code>"<a href="sts-class.html">sts</a>"</code>
    is actually optional, <code>neighbourhood=NULL</code> also works.</p></dd>

  <dt id="arg-tiles">tiles<a class="anchor" aria-label="anchor" href="#arg-tiles"></a></dt>
<dd><p>object inheriting from <code>"<a href="https://edzer.github.io/sp/reference/SpatialPolygons-class.html" class="external-link">SpatialPolygons</a>"</code>
    representing the regions in <code>object$stgrid</code> (column
    <code>"tile"</code>). It will become the <code>"map"</code> slot of the
    resulting <code>"sts"</code> object.
    Its <code>row.names</code> must match <code>levels(object$stgrid$tile)</code>.
    If <code>neighbourhood</code> is provided, <code>tiles</code> is optional (not
    required for <code>hhh4</code>, but for plots of the resulting
    <code>"sts"</code> object).</p></dd>

  <dt id="arg-popcol-stgrid">popcol.stgrid<a class="anchor" aria-label="anchor" href="#arg-popcol-stgrid"></a></dt>
<dd><p>single character or numeric value indexing the
    column in <code>object$stgrid</code> which contains the population data
    (counts or densities, depending on the <code>popdensity</code> argument).
    This will become the <code>"populationFrac"</code> slot (optional).</p></dd>

  <dt id="arg-popdensity">popdensity<a class="anchor" aria-label="anchor" href="#arg-popdensity"></a></dt>
<dd><p>logical indicating if the column referenced by
    <code>popcol.stgrid</code> contains population densities or absolute counts.</p></dd>


  <dt id="arg-tilecentroids">tileCentroids<a class="anchor" aria-label="anchor" href="#arg-tilecentroids"></a></dt>
<dd><p>a coordinate matrix of the region centroids (i.e., the result of
    <code>coordinates(tiles)</code>). Its row names must match
    <code>levels(data$stgrid$tile)</code>.
    This will be the coordinates used for the “population” (i.e.,
    the <code>tiles</code> from <code>"<a href="epidataCS.html">epidataCS</a>"</code>) in the
    discrete-space <code><a href="twinSIR.html">twinSIR</a></code> modelling.</p></dd>

  <dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>numeric scalar for breaking tied removal and infection times between different
    individuals (tiles), which might occur during conversion from
    <code>"epidataCS"</code> to <code>"epidata"</code>. Rather dumb, this is simply done
    by subtracting <code>eps</code> from each tied removal time.
    One should consider other ways of breaking the tied event times.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>unused (argument of the generic).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Conversion to <code>"<a href="sts-class.html">sts</a>"</code> only makes sense if the time
  intervals (<code>BLOCK</code>s) of the <code>stgrid</code> are regularly spaced
  (to give <code>freq</code> intervals per year). Note that events of the
  prehistory (not covered by <code>stgrid</code>) are not included in the
  resulting <code>sts</code> object.</p>
<p>Some comments on the conversion to <code>"epidata"</code>:
  the conversion results into SIS epidemics only,
  i.e. the at-risk indicator is set to 1 immediately after
  recovery. A tile is considered infective if at least one individual
  within the tile is infective, otherwise it is susceptible.
  The lengths of the infectious periods are taken from
  <code>data$events$eps.t</code>. There will be no <code>f</code> columns in the resulting
  <code>"epidata"</code>. These must be generated by a subsequent call to
  <code><a href="epidata.html">as.epidata</a></code> with desired <code>f</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>epidataCS2sts</code>: an object of class <code>"<a href="sts-class.html">sts</a>"</code>
  representing the multivariate time-series of the number of
  cases aggregated over <code>stgrid</code>.</p>
<p><code>as.epidata.epidataCS</code>: an object of class
  <code>"<a href="epidata.html">epidata</a>"</code> representing an SIS epidemic in form of a
  multivariate point process (one for each region/<code>tile</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Meyer</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="epidata.html">epidata</a></code> and <code><a href="twinSIR.html">twinSIR</a></code></p>
<p><code>linkS4class{sts}</code> and <code><a href="hhh4.html">hhh4</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"imdepi"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes"</span>, <span class="st">"districtsD.RData"</span>, package<span class="op">=</span><span class="st">"surveillance"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## convert imdepi point pattern into multivariate time series</span></span>
<span><span class="va">imdsts</span> <span class="op">&lt;-</span> <span class="fu">epidataCS2sts</span><span class="op">(</span><span class="va">imdepi</span>, freq <span class="op">=</span> <span class="fl">12</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2002</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        neighbourhood <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># not needed here</span></span>
<span>                        tiles <span class="op">=</span> <span class="va">districtsD</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## check the overall number of events by district</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="stsSlots.html">observed</a></span><span class="op">(</span><span class="va">imdsts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">imdepi</span><span class="op">$</span><span class="va">events</span><span class="op">$</span><span class="va">tile</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## compare plots of monthly number of cases</span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imdepi</span>, <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imdsts</span>, type <span class="op">=</span> <span class="va">observed</span> <span class="op">~</span> <span class="va">time</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot number of cases by district</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imdsts</span>, type <span class="op">=</span> <span class="va">observed</span> <span class="op">~</span> <span class="va">unit</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## also test conversion to an SIS event history ("epidata") of the "tiles"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"intervals"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">imdepi_short</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">imdepi</span>, <span class="va">time</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">)</span>  <span class="co"># to reduce the runtime</span></span>
<span>    <span class="va">imdepi_short</span><span class="op">$</span><span class="va">stgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">imdepi_short</span><span class="op">$</span><span class="va">stgrid</span>, <span class="va">start</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="va">imdepidata</span> <span class="op">&lt;-</span> <span class="fu"><a href="epidata.html">as.epidata</a></span><span class="op">(</span><span class="va">imdepi_short</span>,</span>
<span>                             tileCentroids <span class="op">=</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">districtsD</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">imdepidata</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

