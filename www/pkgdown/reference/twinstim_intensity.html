<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plotting Intensities of Infection over Time or Space — twinstim_intensity • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting Intensities of Infection over Time or Space — twinstim_intensity"><meta name="description" content='intensityplot method to plot the evolution of the total infection
intensity, its epidemic proportion or its endemic proportion over time
or space (integrated over the other dimension) of fitted
twinstim models (or simEpidataCS).
The "simEpidataCS"-method is just a wrapper around
intensityplot.twinstim by making the "simEpidataCS" object
"twinstim"-compatible, i.e. enriching it by the
required model components and environment.
The intensity.twinstim auxiliary function returns functions which
calculate the endemic or epidemic intensity at a specific time point or
location (integrated over the other dimension).'><meta property="og:description" content='intensityplot method to plot the evolution of the total infection
intensity, its epidemic proportion or its endemic proportion over time
or space (integrated over the other dimension) of fitted
twinstim models (or simEpidataCS).
The "simEpidataCS"-method is just a wrapper around
intensityplot.twinstim by making the "simEpidataCS" object
"twinstim"-compatible, i.e. enriching it by the
required model components and environment.
The intensity.twinstim auxiliary function returns functions which
calculate the endemic or epidemic intensity at a specific time point or
location (integrated over the other dimension).'><!-- For Rd equations in pkgdown 2.1.0, see https://katex.org/docs/autorender.html --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          throwOnError: false,
          macros: {"\\code": "\\texttt"}
      })
  });
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plotting Intensities of Infection over Time or Space</h1>

      <div class="d-none name"><code>twinstim_intensity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code><a href="intensityplot.html">intensityplot</a></code> method to plot the evolution of the total infection
intensity, its epidemic proportion or its endemic proportion over time
or space (integrated over the other dimension) of fitted
<code><a href="twinstim.html">twinstim</a></code> models (or <code><a href="twinstim_simulation.html">simEpidataCS</a></code>).
The <code>"simEpidataCS"</code>-method is just a wrapper around
<code>intensityplot.twinstim</code> by making the <code>"simEpidataCS"</code> object
<code>"twinstim"</code>-compatible, i.e. enriching it by the
required model components and environment.</p>
<p>The <code>intensity.twinstim</code> auxiliary function returns functions which
calculate the endemic or epidemic intensity at a specific time point or
location (integrated over the other dimension).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'twinstim'</span></span>
<span><span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>    which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"epidemic proportion"</span>, <span class="st">"endemic proportion"</span>, <span class="st">"total intensity"</span><span class="op">)</span>,</span>
<span>    aggregate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"space"</span><span class="op">)</span>, types <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">qmatrix</span><span class="op">)</span>,</span>
<span>    <span class="va">tiles</span>, tiles.idcol <span class="op">=</span> <span class="cn">NULL</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    tgrid <span class="op">=</span> <span class="fl">101</span>, rug.opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    sgrid <span class="op">=</span> <span class="fl">128</span>, polygons.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, points.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    cex.fun <span class="op">=</span> <span class="va">sqrt</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'simEpidataCS'</span></span>
<span><span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">intensity.twinstim</span><span class="op">(</span><span class="va">x</span>,</span>
<span>    aggregate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"space"</span><span class="op">)</span>, types <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">qmatrix</span><span class="op">)</span>, </span>
<span>    <span class="va">tiles</span>, tiles.idcol <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class <code>"twinstim"</code> or <code>"simEpidataCS"</code>, respectively.</p></dd>

  <dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p><code>"epidemic proportion"</code>, <code>"endemic proportion"</code>,
    or <code>"total intensity"</code>.  Partial matching is applied.  Determines
    whether to plot the path of the total intensity or its
    epidemic or endemic proportions over time or space (<code>which</code>)
    aggregated over the other dimension and <code>types</code>.</p></dd>

  <dt id="arg-aggregate">aggregate<a class="anchor" aria-label="anchor" href="#arg-aggregate"></a></dt>
<dd><p>One of <code>"time"</code> or <code>"space"</code>. The former results in a plot
    of the evolution of <code>which</code> as a function of time (integrated
    over the observation region \(\bold{W}\)), whereas the latter
    produces a <code>spplot</code> of <code>which</code> over \(\bold{W}\)
    (spanned by <code>tiles</code>). In both cases, <code>which</code> is evaluated
    on a grid of values, given by <code>tgrid</code> or <code>sgrid</code>, respectively.</p></dd>

  <dt id="arg-types">types<a class="anchor" aria-label="anchor" href="#arg-types"></a></dt>
<dd><p>event types to aggregate. By default, all types of events are
    aggregated, but one could also be interested in only one specific
    type or a subset of event types.</p></dd>

  <dt id="arg-tiles">tiles<a class="anchor" aria-label="anchor" href="#arg-tiles"></a></dt>
<dd><p>object of class <code>"<a href="https://edzer.github.io/sp/reference/SpatialPolygons-class.html" class="external-link">SpatialPolygons</a>"</code> representing
    the decomposition of \(\bold{W}\) into different regions (as used
    in the corresponding <code>stgrid</code> of the <code>"<a href="epidataCS.html">epidataCS</a>"</code>.
    This is only needed for <code>aggregate = "space"</code>.</p></dd>

  <dt id="arg-tiles-idcol">tiles.idcol<a class="anchor" aria-label="anchor" href="#arg-tiles-idcol"></a></dt>
<dd><p>either a column index for <code>tiles@data</code> (if <code>tiles</code> is a
    <code>"<a href="https://edzer.github.io/sp/reference/SpatialPolygonsDataFrame-class.html" class="external-link">SpatialPolygonsDataFrame</a>"</code>), or <code>NULL</code>
    (default), which refers to the <code>"ID"</code> slot of the polygons,
    i.e., <code>row.names(tiles)</code>.
    The ID's must correspond to the factor levels of
    <code>stgrid$tile</code> of the <code>"<a href="epidataCS.html">epidataCS</a>"</code> on which
    <code>x</code> was fitted.</p></dd>

  <dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical indicating if a plot is desired, which defaults to <code>TRUE</code>.
    Otherwise, a function will be returned, which takes a vector of time
    points (if <code>aggregate = "time"</code>) or a matrix of coordinates (if
    <code>aggregate = "space"</code>), and returns <code>which</code> on this grid.</p></dd>

  <dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>logical.  If <code>TRUE</code> and <code>aggregate = "time"</code>, paths are
    added to the current plot, using <code>lines</code>.  This does not work
    for <code>aggregate = "space"</code>.</p></dd>

  <dt id="arg-tgrid">tgrid<a class="anchor" aria-label="anchor" href="#arg-tgrid"></a></dt>
<dd><p>either a numeric vector of time points when to evaluate
    <code>which</code>, or a scalar representing the desired number of
    evaluation points in the observation interval \([t_0, T]\).
    This argument is unused for <code>aggregate = "space"</code>.</p></dd>

  <dt id="arg-rug-opts">rug.opts<a class="anchor" aria-label="anchor" href="#arg-rug-opts"></a></dt>
<dd><p>if a list, its elements are passed as arguments to the function
    <code><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></code>, which will mark the time points of the events if
    <code>aggregate = "time"</code> (it is unused in the spatial case);
    otherwise (e.g., <code>NULL</code>), no <code>rug</code> will be produced.
    By default, the <code>rug</code> argument <code>ticksize</code> is set to 0.02
    and <code>quiet</code> is set to <code>TRUE</code>.  Note that the argument
    <code>x</code> of the <code>rug</code> function, which contains the
    locations for the <code>rug</code> is fixed internally and can not be
    modified.</p></dd>

  <dt id="arg-sgrid">sgrid<a class="anchor" aria-label="anchor" href="#arg-sgrid"></a></dt>
<dd><p>either an object of class <code>"<a href="https://edzer.github.io/sp/reference/SpatialPixels-class.html" class="external-link">SpatialPixels</a>"</code> (or
    coercible to that class) representing the locations where to
    evaluate <code>which</code>, or a scalar representing the approximate
    number of points of a grid constructed on the bounding box of
    <code>tiles</code>.
    <code>sgrid</code> is internally subsetted to contain only
    points inside <code>tiles</code>.
    This argument is unused for <code>aggregate = "time"</code>.</p></dd>

  <dt id="arg-polygons-args">polygons.args<a class="anchor" aria-label="anchor" href="#arg-polygons-args"></a></dt>
<dd><p>if a list, its elements are passed as arguments to
    <code><a href="https://edzer.github.io/sp/reference/panel.html" class="external-link">sp.polygons</a></code>, which will add <code>tiles</code> to the plot
    if <code>aggregate = "space"</code> (it is unused for the temporal plot).
    By default, the fill <code>col</code>our of the tiles is set to
    <code>"darkgrey"</code>.</p></dd>

  <dt id="arg-points-args">points.args<a class="anchor" aria-label="anchor" href="#arg-points-args"></a></dt>
<dd><p>if a list, its elements are passed as arguments to
    <code><a href="https://edzer.github.io/sp/reference/panel.html" class="external-link">sp.points</a></code>, which will add the event locations to the plot
    if <code>aggregate = "space"</code> (it is unused for the temporal plot).
    By default, the plot symbol is set to <code>pch=1</code>. The sizes
    of the points are determined as the product of the argument <code>cex</code>
    (default: 0.5) of this list and the sizes obtained from
    the function <code>cex.fun</code> which accounts for multiple events at the
    same location.</p></dd>

  <dt id="arg-cex-fun">cex.fun<a class="anchor" aria-label="anchor" href="#arg-cex-fun"></a></dt>
<dd><p>function which takes a vector of counts of events
    at each unique location and returns a (vector of) <code>cex</code>
    value(s) for the sizes of the points at the event locations used in
    <code>points.args</code>.
    Defaults to the <code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt()</a></code> function, which for the default
    circular <code>pch=1</code> means that the area of each point is
    proportional to the number of events at its location.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to <code>plot</code> or <code>lines</code> (if
    <code>aggregate = "time"</code>), or to <code><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></code> (if
    <code>aggregate = "space"</code>).<br>
    For <code>intensityplot.simEpidataCS</code>, arguments passed to
    <code>intensityplot.twinstim</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>plot = FALSE</code> or <code>aggregate = "time"</code>,
  a function is returned, which takes a vector of
  time points (if <code>aggregate = "time"</code>) or a matrix of coordinates
  (if <code>aggregate = "space"</code>), and returns <code>which</code> on this grid.
  <code>intensity.twinstim</code> returns a list containing such functions for
  the endemic and epidemic intensity (but these are not vectorized).</p>
<p>If <code>plot = TRUE</code> and <code>aggregate = "space"</code>, the
  <code><a href="https://rdrr.io/pkg/lattice/man/trellis.object.html" class="external-link">trellis.object</a></code> of the spatial plot is returned.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Meyer</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="twinstim_plot.html">plot.twinstim</a></code>, which calls <code>intensityplot.twinstim</code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"imdepi"</span>, <span class="st">"imdepifit"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for the intensityplot we need the model environment, which can be</span></span>
<span><span class="co"># easily added by the intelligent update method (no need to refit the model)</span></span>
<span><span class="va">imdepifit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">imdepifit</span>, model<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## path of the total intensity</span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">imdepifit</span>, which<span class="op">=</span><span class="st">"total intensity"</span>,</span>
<span>              aggregate<span class="op">=</span><span class="st">"time"</span>, tgrid<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imdepi</span>, <span class="st">"time"</span>, breaks<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## time course of the epidemic proportion by event</span></span>
<span><span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">imdepifit</span>, which<span class="op">=</span><span class="st">"epidemic proportion"</span>,</span>
<span>              aggregate<span class="op">=</span><span class="st">"time"</span>, tgrid<span class="op">=</span><span class="fl">500</span>, types<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">imdepifit</span>, which<span class="op">=</span><span class="st">"epidemic proportion"</span>,</span>
<span>              aggregate<span class="op">=</span><span class="st">"time"</span>, tgrid<span class="op">=</span><span class="fl">500</span>, types<span class="op">=</span><span class="fl">2</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">imdepi</span><span class="op">$</span><span class="va">events</span><span class="op">$</span><span class="va">type</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"event type"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## endemic and total intensity in one plot</span></span>
<span><span class="va">intensity_endprop</span> <span class="op">&lt;-</span> <span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">imdepifit</span>, which<span class="op">=</span><span class="st">"endemic proportion"</span>,</span>
<span>                                   aggregate<span class="op">=</span><span class="st">"time"</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">intensity_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">imdepifit</span>, which<span class="op">=</span><span class="st">"total intensity"</span>,</span>
<span>                                 aggregate<span class="op">=</span><span class="st">"time"</span>, tgrid<span class="op">=</span><span class="fl">501</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">intensity_endprop</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu">intensity_total</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span>, n<span class="op">=</span><span class="fl">501</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">0.36</span>, labels<span class="op">=</span><span class="st">"total"</span>, col<span class="op">=</span><span class="fl">1</span>, pos<span class="op">=</span><span class="fl">2</span>, font<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">0.08</span>, labels<span class="op">=</span><span class="st">"endemic"</span>, col<span class="op">=</span><span class="fl">2</span>, pos<span class="op">=</span><span class="fl">2</span>, font<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## spatial shape of the intensity (aggregated over time)</span></span>
<span></span>
<span>  <span class="co">## load borders of Germany's districts</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes"</span>, <span class="st">"districtsD.RData"</span>, package<span class="op">=</span><span class="st">"surveillance"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># total intensity (using a rather sparse 'sgrid' for speed)</span></span>
<span>  <span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">imdepifit</span>, which<span class="op">=</span><span class="st">"total intensity"</span>,</span>
<span>                aggregate<span class="op">=</span><span class="st">"space"</span>, tiles<span class="op">=</span><span class="va">districtsD</span>, sgrid<span class="op">=</span><span class="fl">500</span>,</span>
<span>                col.regions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>  <span class="co"># epidemic proportion by type</span></span>
<span>  <span class="va">maps_epiprop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">imdepifit</span>, which<span class="op">=</span><span class="st">"epidemic"</span>, aggregate<span class="op">=</span><span class="st">"space"</span>,</span>
<span>                    types<span class="op">=</span><span class="va">type</span>, tiles<span class="op">=</span><span class="va">districtsD</span>, sgrid<span class="op">=</span><span class="fl">1000</span>,</span>
<span>                    main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">imdepifit</span><span class="op">$</span><span class="va">qmatrix</span><span class="op">)</span><span class="op">[</span><span class="va">type</span><span class="op">]</span>,</span>
<span>                    scales<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>draw<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                    col.regions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">10</span>,<span class="st">"YlOrRd"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    colorkey<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Epidemic proportion"</span>, cex<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">maps_epiprop</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, more<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">maps_epiprop</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

