<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CUSUM method — algo.cusum • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="CUSUM method — algo.cusum"><meta name="description" content="Approximate one-side CUSUM method for a Poisson variate based on the
        cumulative sum of the deviation between a reference value k and the
        transformed observed values.
        An alarm is raised if the cumulative sum equals or exceeds a prespecified
        decision boundary h. The function can handle time varying expectations."><meta property="og:description" content="Approximate one-side CUSUM method for a Poisson variate based on the
        cumulative sum of the deviation between a reference value k and the
        transformed observed values.
        An alarm is raised if the cumulative sum equals or exceeds a prespecified
        decision boundary h. The function can handle time varying expectations."><!-- For Rd equations in pkgdown 2.1.0, see https://katex.org/docs/autorender.html --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          throwOnError: false,
          macros: {"\\code": "\\texttt"}
      })
  });
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.24.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>CUSUM method</h1>

      <div class="d-none name"><code>algo.cusum.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Approximate one-side CUSUM method for a Poisson variate based on the
        cumulative sum of the deviation between a reference value k and the
        transformed observed values.
        An alarm is raised if the cumulative sum equals or exceeds a prespecified
        decision boundary h. The function can handle time varying expectations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">algo.cusum</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="va">range</span>, k <span class="op">=</span> <span class="fl">1.04</span>, h <span class="op">=</span> <span class="fl">2.26</span>, </span>
<span>           m <span class="op">=</span> <span class="cn">NULL</span>, trans <span class="op">=</span> <span class="st">"standard"</span>, alpha <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-disprogobj">disProgObj<a class="anchor" aria-label="anchor" href="#arg-disprogobj"></a></dt>
<dd><p>object of class disProg (including the observed and the state chain)</p></dd>

        <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>control object:</p><dl><dt><code>range</code></dt>
<dd><p>determines the desired time points which should be evaluated</p></dd>

            <dt><code>k</code></dt>
<dd><p>is the reference value</p></dd>

            <dt><code>h</code></dt>
<dd><p>the decision boundary</p></dd>

            <dt><code>m</code></dt>
<dd><p>how to determine the expected number of cases –
                the following arguments are possible</p><dl><dt><code>numeric</code></dt>
<dd><p>a vector of values having the
                    same length as <code>range</code>. If a single numeric
                    value is specified then this value is replicated
                    <code>length(range)</code> times.</p></dd>

                <dt><code>NULL</code></dt>
<dd><p>A single value is estimated by
                    taking the mean of all observations previous to
                    the first <code>range</code> value.</p></dd>

                <dt><code>"glm"</code></dt>
<dd><p>A GLM of the form $$\log(m_t)
                      = \alpha + \beta t + \sum_{s=1}^S (\gamma_s
                      \sin(\omega_s t) + \delta_s \cos(\omega_s t)),$$
                    where \(\omega_s = \frac{2\pi}{52}s\) are the
                    Fourier frequencies is fitted. Then this model is
                    used to predict the <code>range</code> values.</p></dd>


</dl></dd>

            <dt><code>trans</code></dt>
<dd><p>one of the following transformations (warning: Anscombe and NegBin transformations are experimental)</p><dl><dt><code>rossi</code></dt>
<dd><p>standardized variables z3 as proposed by Rossi</p></dd>

                <dt><code>standard</code></dt>
<dd><p>standardized variables z1 (based
             on asymptotic normality) - This is the default.</p></dd>

                <dt><code>anscombe</code></dt>
<dd><p>anscombe residuals – experimental</p></dd>

                <dt><code>anscombe2nd</code></dt>
<dd><p>anscombe residuals as in Pierce and Schafer (1986) based on 2nd order approximation of E(X)  – experimental</p></dd>

                <dt><code>pearsonNegBin</code></dt>
<dd><p>compute Pearson residuals for NegBin – experimental</p></dd>

                <dt><code>anscombeNegBin</code></dt>
<dd><p>anscombe residuals for NegBin – experimental</p></dd>

                <dt><code>none</code></dt>
<dd><p>no transformation</p></dd>


</dl><p></p></dd>

              <dt><code>alpha</code></dt>
<dd><p>parameter of the negative binomial distribution, s.t. the variance is \(m+\alpha *m^2\)</p></dd>


</dl><p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>algo.cusum</code> gives a list of class <code>"survRes"</code> which includes the
    vector of alarm values for every timepoint in <code>range</code> and the vector
    of cumulative sums for every timepoint in <code>range</code> for the system
    specified by <code>k</code> and <code>h</code>, the range and the input object of
    class <code>"disProg"</code>.</p>
<p>The <code>upperbound</code> entry shows for each time instance the number of diseased individuals
    it would have taken the cusum to signal. Once the CUSUM signals no resetting is applied, i.e.
    signals occurs until the CUSUM statistic again returns below the threshold.</p>
<p>In case <code>control$m="glm"</code> was used, the returned
    <code>control$m.glm</code> entry contains the fitted <code>"glm"</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This implementation is experimental, but will not be developed further.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>M. Paul and M. Höhle</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>G. Rossi, L. Lampugnani and M. Marchi (1999), An approximate CUSUM procedure for surveillance of health events, Statistics in Medicine, 18, 2111–2122</p>
<p>D. A. Pierce and D. W. Schafer (1986), Residuals in Generalized Linear Models, Journal of the American Statistical Association, 81, 977–986</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Xi ~ Po(5), i=1,...,500</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">321</span><span class="op">)</span></span>
<span><span class="va">stsObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="sts-class.html">sts</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">500</span>,lambda<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># there should be no alarms as mean doesn't change</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">cusum</a></span><span class="op">(</span><span class="va">stsObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fl">100</span><span class="op">:</span><span class="fl">500</span>, trans <span class="op">=</span> <span class="st">"anscombe"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, xaxis.labelFormat <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulated data</span></span>
<span><span class="va">disProgObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.pointSource.html">sim.pointSource</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                              A <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, beta <span class="op">=</span> <span class="fl">0</span>, phi <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                              frequency <span class="op">=</span> <span class="fl">10</span>, state <span class="op">=</span> <span class="cn">NULL</span>, K <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">disProgObj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test weeks 200 to 250 for outbreaks</span></span>
<span><span class="va">surv0</span> <span class="op">&lt;-</span> <span class="fu">algo.cusum</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fl">200</span><span class="op">:</span><span class="fl">250</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surv0</span>, xaxis.years <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># alternatively, using the newer "sts" interface</span></span>
<span><span class="va">stsObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="disProg2sts.html">disProg2sts</a></span><span class="op">(</span><span class="va">disProgObj</span><span class="op">)</span></span>
<span><span class="va">surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">cusum</a></span><span class="op">(</span><span class="va">stsObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fl">200</span><span class="op">:</span><span class="fl">250</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="stsSlots.html">upperbound</a></span><span class="op">(</span><span class="va">surv</span><span class="op">)</span> <span class="op">==</span> <span class="va">surv0</span><span class="op">$</span><span class="va">upperbound</span><span class="op">)</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

