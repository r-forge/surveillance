<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Outbreak Detection Algorithm (BODA) — boda • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Outbreak Detection Algorithm (BODA) — boda"><meta name="description" content="The function takes range values of a univariate surveillance time
  series sts and for each time point uses a negative binomial
  regression model to compute the predictive posterior distribution for
  the current observation. The
  \((1-\alpha)\cdot 100\%\)
  quantile of this predictive distribution is then
  used as bound: If the actual observation is above the bound an alarm
  is raised.
  The Bayesian Outbreak Detection Algorithm (boda) is due to
  Manitz and Höhle (2013) and its implementation is
  illustrated in Salmon et al. (2016).
  However, boda should be considered as an experiment, see the
  Warning section below!"><meta property="og:description" content="The function takes range values of a univariate surveillance time
  series sts and for each time point uses a negative binomial
  regression model to compute the predictive posterior distribution for
  the current observation. The
  \((1-\alpha)\cdot 100\%\)
  quantile of this predictive distribution is then
  used as bound: If the actual observation is above the bound an alarm
  is raised.
  The Bayesian Outbreak Detection Algorithm (boda) is due to
  Manitz and Höhle (2013) and its implementation is
  illustrated in Salmon et al. (2016).
  However, boda should be considered as an experiment, see the
  Warning section below!"><!-- For Rd equations in pkgdown 2.1.0, see https://katex.org/docs/autorender.html --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          throwOnError: false,
          macros: {"\\code": "\\texttt"}
      })
  });
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Outbreak Detection Algorithm (BODA)</h1>

      <div class="d-none name"><code>boda.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function takes <code>range</code> values of a univariate surveillance time
  series <code>sts</code> and for each time point uses a negative binomial
  regression model to compute the predictive posterior distribution for
  the current observation. The
  \((1-\alpha)\cdot 100\%\)
  quantile of this predictive distribution is then
  used as bound: If the actual observation is above the bound an alarm
  is raised.
  The Bayesian Outbreak Detection Algorithm (<code>boda</code>) is due to
  Manitz and Höhle (2013) and its implementation is
  illustrated in Salmon et al. (2016).
  However, <code>boda</code> should be considered as an experiment, see the
  Warning section below!</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">boda</span><span class="op">(</span><span class="va">sts</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    range<span class="op">=</span><span class="cn">NULL</span>, X<span class="op">=</span><span class="cn">NULL</span>, trend<span class="op">=</span><span class="cn">FALSE</span>, season<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    prior<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'iid'</span>,<span class="st">'rw1'</span>,<span class="st">'rw2'</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, mc.munu<span class="op">=</span><span class="fl">100</span>, </span>
<span>    mc.y<span class="op">=</span><span class="fl">10</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    samplingMethod<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'joint'</span>,<span class="st">'marginals'</span><span class="op">)</span>,</span>
<span>    quantileMethod<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MC"</span>,<span class="st">"MM"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-sts">sts<a class="anchor" aria-label="anchor" href="#arg-sts"></a></dt>
<dd><p>object of class sts (including the <code>observed</code> and the
    <code>state</code> time series)</p></dd>

  <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>Control object given as a <code>list</code> containing the following components:</p><dl><dt><code>range</code></dt>
<dd><p>Specifies the index of all timepoints which
	should be tested. If range is <code>NULL</code> all possible
	timepoints are used.</p></dd>

      <dt><code>X</code></dt>
<dd></dd>

      <dt><code>trend</code></dt>
<dd><p>Boolean indicating whether a linear trend term should be
	included in the model for the expectation the log-scale</p></dd>

      <dt><code>season</code></dt>
<dd><p>Boolean to indicate whether a cyclic spline
	should be included.</p></dd>

      <dt><code>alpha</code></dt>
<dd><p>The threshold for declaring an observed count as
	an aberration is the \((1-\alpha)\cdot 100\%\)
	quantile of the predictive posterior.</p></dd>

      <dt><code>mc.munu</code></dt>
<dd></dd>

      <dt><code>mc.y</code></dt>
<dd><p>Number of samples of \(y\) to generate for
	each par of the mean and size parameter. A total of \(mc.munu
	  \times mc.y\) samples are generated.</p></dd>

      <dt><code>verbose</code></dt>
<dd><p>Argument sent to the inla call. When using ESS
	it might be necessary to force verbose mode for INLA to work.</p></dd>

      <dt><code>samplingMethod</code></dt>
<dd><p>Should one sample from the parameters joint distribution (joint) or from their respective marginal posterior distribution (marginals)?</p></dd>

      <dt>quantileMethod</dt>
<dd><p>Character, either <code>MC</code> or <code>MM</code>. Indicates how to compute the quantile based on the posterior distribution (no matter the inference method): either by sampling <code>mc.munu</code> values from the posterior distribution of the parameters and then for each sampled parameters vector sampling <code>mc.y</code> response values so that one gets a vector of response values based on which one computes an empirical quantile (MC method, as explained in Manitz and Höhle 2013); or by sampling <code>mc.munu</code> from the posterior distribution of the parameters and then compute the quantile of the mixture distribution using bisectioning, which is faster.</p></dd>


</dl><p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function requires the <span style="R">R</span> package <span class="pkg">INLA</span>, which is currently
  <em>not</em> available from CRAN. It can be obtained from INLA's own
  repository via
  <code>install.packages("INLA", repos="https://inla.r-inla-download.org/R/stable")</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>This function is currently experimental!! It also heavily
  depends on the <span class="pkg">INLA</span> package so changes there might affect the
  operational ability of this function. Since the computations
  for the Bayesian GAM are quite involved do not expect this function
  to be particularly fast.</p>
<p>Results are not reproducible if <span class="pkg">INLA</span> uses parallelization (as by default);
  set <code>INLA::inla.setOption(num.threads = "1:1")</code> to avoid that,
  then do <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code> as usual.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>J. Manitz, M. Höhle, M. Salmon</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Manitz, J. and Höhle, M. (2013):
  Bayesian outbreak detection algorithm for monitoring reported cases of
  campylobacteriosis in Germany.
  Biometrical Journal, 55(4), 509-526.</p>
<p>Salmon, M., Schumacher, D. and Höhle, M. (2016):
  Monitoring count time series in <span style="R">R</span>: Aberration detection in public
  health surveillance. <em>Journal of Statistical Software</em>,
  <b>70</b> (10), 1-35. <a href="https://doi.org/10.18637/jss.v070.i10" class="external-link">doi:10.18637/jss.v070.i10</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span>
<span>  <span class="co">## running this example takes a couple of minutes</span></span>
<span></span>
<span>  <span class="co">#Load the campylobacteriosis data for Germany</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"campyDE"</span><span class="op">)</span></span>
<span>  <span class="co">#Make an sts object from the data.frame</span></span>
<span>  <span class="va">cam.sts</span> <span class="op">&lt;-</span>  <span class="fu"><a href="sts-class.html">sts</a></span><span class="op">(</span>epoch<span class="op">=</span><span class="va">campyDE</span><span class="op">$</span><span class="va">date</span>,</span>
<span>                  observed<span class="op">=</span><span class="va">campyDE</span><span class="op">$</span><span class="va">case</span>, state<span class="op">=</span><span class="va">campyDE</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#Define monitoring period</span></span>
<span><span class="co">#  range &lt;- which(epoch(cam.sts)&gt;=as.Date("2007-01-01"))</span></span>
<span><span class="co">#  range &lt;- which(epoch(cam.sts)&gt;=as.Date("2011-12-10"))</span></span>
<span>  <span class="va">range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cam.sts</span><span class="op">)</span>,n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="va">range</span>, X<span class="op">=</span><span class="cn">NULL</span>, trend<span class="op">=</span><span class="cn">TRUE</span>, season<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                  prior<span class="op">=</span><span class="st">'iid'</span>, alpha<span class="op">=</span><span class="fl">0.025</span>, mc.munu<span class="op">=</span><span class="fl">100</span>, mc.y<span class="op">=</span><span class="fl">10</span>,</span>
<span>                  samplingMethod <span class="op">=</span> <span class="st">"joint"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#Apply the boda algorithm in its simples form, i.e. spline is</span></span>
<span>  <span class="co">#described by iid random effects and no extra covariates</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"INLA"</span><span class="op">)</span>  <span class="co"># needs to be attached</span></span>
<span>  <span class="va">cam.boda1</span> <span class="op">&lt;-</span> <span class="fu">boda</span><span class="op">(</span><span class="va">cam.sts</span>, control<span class="op">=</span><span class="va">control</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cam.boda1</span>, xlab<span class="op">=</span><span class="st">'time [weeks]'</span>, ylab<span class="op">=</span><span class="st">'No. reported'</span>, dx.upperbound<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="co"># }</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

