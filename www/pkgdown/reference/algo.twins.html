<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit a Two-Component Epidemic Model using MCMC — algo.twins • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a Two-Component Epidemic Model using MCMC — algo.twins"><meta name="description" content="Fits a negative binomial model as described in Held et al. (2006)
  to an univariate time series of counts.
This is an experimental implementation that may be removed
  in future versions of the package."><meta property="og:description" content="Fits a negative binomial model as described in Held et al. (2006)
  to an univariate time series of counts.
This is an experimental implementation that may be removed
  in future versions of the package."><!-- For Rd equations in pkgdown 2.1.0, see https://katex.org/docs/autorender.html --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          throwOnError: false,
          macros: {"\\code": "\\texttt"}
      })
  });
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit a Two-Component Epidemic Model using MCMC</h1>

      <div class="d-none name"><code>algo.twins.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a negative binomial model as described in Held et al. (2006)
  to an univariate time series of counts.</p>
<p>This is an experimental implementation that may be removed
  in future versions of the package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">algo.twins</span><span class="op">(</span><span class="va">disProgObj</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>burnin<span class="op">=</span><span class="fl">1000</span>, filter<span class="op">=</span><span class="fl">10</span>,</span>
<span>   sampleSize<span class="op">=</span><span class="fl">2500</span>, noOfHarmonics<span class="op">=</span><span class="fl">1</span>, alpha_xi<span class="op">=</span><span class="fl">10</span>, beta_xi<span class="op">=</span><span class="fl">10</span>,</span>
<span>   psiRWSigma<span class="op">=</span><span class="fl">0.25</span>,alpha_psi<span class="op">=</span><span class="fl">1</span>, beta_psi<span class="op">=</span><span class="fl">0.1</span>, nu_trend<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>   logFile<span class="op">=</span><span class="st">"twins.log"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-disprogobj">disProgObj<a class="anchor" aria-label="anchor" href="#arg-disprogobj"></a></dt>
<dd><p>object of class <code>disProg</code></p></dd>

  <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>control object:</p><dl><dt><code>burnin</code></dt>
<dd><p>Number of burn in samples.</p></dd>

        <dt><code>filter</code></dt>
<dd><p>Thinning parameter. If <code>filter = 10</code> every 10th sample is after the burn in is returned.</p></dd>

        <dt><code>sampleSize</code></dt>
<dd><p>Number of returned samples. Total
	  number of samples = <code>burnin</code>+<code>filter</code>*<code>sampleSize</code></p></dd>

	<dt><code>noOfHarmonics</code></dt>
<dd><p>Number of harmonics to use in the
	  modelling, i.e. \(L\) in (2.2) of Held et al (2006).</p></dd>

        <dt><code>alpha_xi</code></dt>
<dd><p>Parameter \(\alpha_{\xi}\) of the hyperprior of the epidemic parameter \(\lambda\)</p></dd>

        <dt><code>beta_xi</code></dt>
<dd><p>Parameter \(\beta_{\xi}\) of the hyperprior of the epidemic parameter \(\lambda\)</p></dd>

        <dt><code>psiRWSigma</code></dt>
<dd><p>Starting value for the tuning of the variance of the random walk proposal for the overdispersion parameter \(\psi\).</p></dd>

        <dt><code>alpha_psi</code></dt>
<dd><p>Parameter \(\alpha_{\psi}\) of the prior of the overdispersion parameter \(\psi\)</p></dd>

        <dt><code>beta_psi</code></dt>
<dd><p>Parameter \(\beta_{\psi}\)
	  of the prior of the overdispersion parameter \(\psi\)</p></dd>

	<dt><code>nu_trend</code></dt>
<dd><p>Adjust for a linear trend in the endemic
	  part? (default: <code>FALSE</code>)</p></dd>

        <dt><code>logFile</code></dt>
<dd><p>Base file name for the output files. The function writes three output files in the current working directory <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd()</a></code>. If <code>logfile = "twins.log"</code> the results are stored in the three files <code class="file">twins.log</code>, <code class="file">twins.log2</code> and <code class="file">twins.log.acc</code>.<br><code class="file">twins.log</code> contains the returned samples of the parameters \(\psi\), \(\gamma_{0}\), \(\gamma_{1}\), \(\gamma_{2}\), K, \(\xi_{\lambda}\) \(\lambda_{1},...,\lambda{n}\), the predictive distribution of the number of cases at time \(n+1\) and the deviance.<br><code class="file">twins.log2</code> contains the sample means of the variables \(X_{t}, Y_{t}, \omega_{t}\) and the relative frequency of a changepoint at time t for t=1,...,n and the relative frequency of a predicted changepoint at time n+1.<br><code class="file">twins.log.acc</code> contains the acceptance rates of \(\psi\), the changepoints and the endemic parameters \(\gamma_{0}\), \(\gamma_{1}\), \(\gamma_{2}\) in the third column and the variance of the random walk proposal for the update of the parameter \(\psi\) in the second column.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function is not a
  surveillance algorithm, but only a modelling approach as described in
  the Held et. al (2006) paper.</p>
<p>Note also that the function writes three logfiles in the current
  working directory <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd()</a></code>: <code class="file">twins.log</code>,
  <code class="file">twins.log.acc</code> and <code class="file">twins.log2</code>.
  Thus you need to have write permissions in the current working
  directory.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code>atwins</code> with elements</p>
<dl><dt>control</dt>
<dd><p>specified control object</p></dd>

  <dt>disProgObj</dt>
<dd><p>specified <code>disProg</code>-object</p></dd>

  <dt>logFile</dt>
<dd><p>contains the returned samples of the parameters \(\psi\), \(\gamma_{0}\), \(\gamma_{1}\), \(\gamma_{2}\), K, \(\xi_{\lambda}\) \(\lambda_{1},...,\lambda{n}\), the predictive distribution and the deviance.</p></dd>

  <dt>logFile2</dt>
<dd><p>contains the sample means of the variables \(X_{t}, Y_{t}, \omega_{t}\) and the relative frequency of a changepoint at time t for t=1,...,n and the relative frequency of a predicted changepoint at time n+1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Held, L., Hofmann, M., Höhle, M. and Schmid V. (2006):
  A two-component model for counts of infectious diseases.
  <em>Biostatistics</em>, <b>7</b>, pp. 422–437.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>M. Hofmann and M. Höhle and
  D. Sabanés Bové</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Load the data used in the Held et al. (2006) paper</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"hepatitisA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fix seed - this is used for the MCMC samplers in twins</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Call algorithm and save result (use short chain without filtering for speed)</span></span>
<span><span class="va">oldwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="co"># where logfiles will be written</span></span>
<span><span class="va">otwins</span> <span class="op">&lt;-</span> <span class="fu">algo.twins</span><span class="op">(</span><span class="va">hepatitisA</span>,</span>
<span>                     control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>burnin<span class="op">=</span><span class="fl">500</span>, filter<span class="op">=</span><span class="fl">1</span>, sampleSize<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">oldwd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This shows the entire output (use ask=TRUE for pause between plots)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">otwins</span>, ask<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direct access to MCMC output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">otwins</span><span class="op">$</span><span class="va">logFile</span><span class="op">$</span><span class="va">psi</span>,xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span>,main<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"coda"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="va">otwins</span><span class="op">$</span><span class="va">logFile</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"psi"</span>,<span class="st">"xipsi"</span>,<span class="st">"K"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

