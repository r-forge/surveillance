<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Surveillance for Count Time Series Using the Classic Farrington Method — algo.farrington • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Surveillance for Count Time Series Using the Classic Farrington Method — algo.farrington"><meta name="description" content="Implements the procedure of Farrington et al. (1996).
  At each time point of the specified range, a GLM is fitted to
  predict the counts. This is then compared to the observed
  counts. If the observation is above a specific quantile of
  the prediction interval, then an alarm is raised."><meta property="og:description" content="Implements the procedure of Farrington et al. (1996).
  At each time point of the specified range, a GLM is fitted to
  predict the counts. This is then compared to the observed
  counts. If the observation is above a specific quantile of
  the prediction interval, then an alarm is raised."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@bastistician"><meta name="twitter:site" content="@bastistician"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Surveillance for Count Time Series Using the Classic Farrington Method</h1>

      <div class="d-none name"><code>algo.farrington.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the procedure of Farrington et al. (1996).
  At each time point of the specified <code>range</code>, a GLM is fitted to
  predict the counts. This is then compared to the observed
  counts. If the observation is above a specific quantile of
  the prediction interval, then an alarm is raised.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># original interface for a single "disProg" time series</span></span>
<span><span class="fu">algo.farrington</span><span class="op">(</span><span class="va">disProgObj</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    range<span class="op">=</span><span class="cn">NULL</span>, b<span class="op">=</span><span class="fl">5</span>, w<span class="op">=</span><span class="fl">3</span>, reweight<span class="op">=</span><span class="cn">TRUE</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    alpha<span class="op">=</span><span class="fl">0.05</span>, trend<span class="op">=</span><span class="cn">TRUE</span>, limit54<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>, powertrans<span class="op">=</span><span class="st">"2/3"</span>,</span>
<span>    fitFun<span class="op">=</span><span class="st">"algo.farrington.fitGLM.fast"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># wrapper for "sts" data, possibly multivariate</span></span>
<span><span class="fu">farrington</span><span class="op">(</span><span class="va">sts</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    range<span class="op">=</span><span class="cn">NULL</span>, b<span class="op">=</span><span class="fl">5</span>, w<span class="op">=</span><span class="fl">3</span>, reweight<span class="op">=</span><span class="cn">TRUE</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-disprogobj">disProgObj<a class="anchor" aria-label="anchor" href="#arg-disprogobj"></a></dt>
<dd><p>an object of class <code>"disProg"</code> (a list including <code>observed</code> and
    <code>state</code> time series).</p></dd>

  <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>list of control parameters</p><dl><dt><code>range</code></dt>
<dd><p>Specifies the index of all timepoints which
        should be tested. If range is <code>NULL</code> the maximum number
        of possible weeks is used (i.e. as many weeks as possible while
	still having enough reference values).</p></dd>

    <dt><code>b</code></dt>
<dd><p>how many years back in time to include when
        forming the base counts.</p></dd>

    <dt><code>w</code></dt>
<dd><p>windows size, i.e. number of weeks to include
        before and after the current week</p></dd>

    <dt><code>reweight</code></dt>
<dd><p>Boolean specifying whether to perform reweight step</p></dd>

    <dt><code>trend</code></dt>
<dd><p>If <code>TRUE</code> a trend is included and kept in
        case the conditions documented in Farrington et al. (1996) are met
        (see the results). If <code>FALSE</code> then NO trend is fit.</p></dd>

    <dt><code>verbose</code></dt>
<dd><p>Boolean indicating whether to show extra debugging information.</p></dd>

    <dt><code>plot</code></dt>
<dd><p>Boolean specifying whether to show the final GLM model fit graphically (use
        History|Recording to see all pictures).</p></dd>

    <dt><code>powertrans</code></dt>
<dd><p>Power transformation to apply to the
        data. Use either "2/3" for skewness correction (Default),
        "1/2" for variance stabilizing transformation or "none" for no
        transformation.</p></dd>

    <dt><code>alpha</code></dt>
<dd><p>An approximate (two-sided) \((1-\alpha)\)
        prediction interval is calculated.</p></dd>

    <dt><code>limit54</code></dt>
<dd><p>To avoid alarms in cases where the time series only
        has about 0-2 cases the algorithm uses the following heuristic
        criterion (see Section 3.8 of the Farrington paper) to protect
        against low counts: no alarm is sounded if fewer than
        \(cases=5\) reports were received in the past \(period=4\)
        weeks. <code>limit54=c(cases,period)</code> is a vector allowing the
        user to change these numbers. Note: As of version 0.9-7 the
        term "last" period of weeks includes the current week -
        otherwise no alarm is sounded for horrible large numbers if
        the four weeks before that are too low.</p></dd>

    <dt><code>fitFun</code></dt>
<dd><p>String containing the name of the fit
        function to be used for fitting the GLM. The options are
        <code>algo.farrington.fitGLM.fast</code> (default) and
        <code>algo.farrington.fitGLM</code> or
        <code>algo.farrington.fitGLM.populationOffset</code>. See details of
        <code><a href="algo.farrington.fitGLM.html">algo.farrington.fitGLM</a></code> for more information.</p></dd>


</dl><p></p></dd>

  <dt id="arg-sts">sts<a class="anchor" aria-label="anchor" href="#arg-sts"></a></dt>
<dd><p>an object of class <code>"<a href="sts-class.html">sts</a>"</code>.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments for <code><a href="wrap.algo.html">wrap.algo</a></code>,
    e.g., <code>verbose=FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The following steps are performed according to the Farrington
  et al. (1996) paper.</p><ol><li><p>fit of the initial model and initial estimation of mean and
  overdispersion.</p></li>
<li><p>calculation of the weights omega (correction for past outbreaks)</p></li>
<li><p>refitting of the model</p></li>
<li><p>revised estimation of overdispersion</p></li>
<li><p>rescaled model</p></li>
<li><p>omission of the trend, if it is not significant</p></li>
<li><p>repetition of the whole procedure</p></li>
<li><p>calculation of the threshold value</p></li>
<li><p>computation of exceedance score</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For <code>algo.farrington</code>, a list object of class <code>"survRes"</code>
with elements <code>alarm</code>, <code>upperbound</code>, <code>trend</code>,
<code>disProgObj</code>, and <code>control</code>.</p>
<p>For <code>farrington</code>, the input <code>"<a href="sts-class.html">sts</a>"</code> object with updated
<code>alarm</code>, <code>upperbound</code> and <code>control</code> slots, and subsetted
to <code>control$range</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>M. Höhle</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="algo.farrington.fitGLM.html">algo.farrington.fitGLM</a></code>,
  <code><a href="algo.farrington.threshold.html">algo.farrington.threshold</a></code></p>
<p>An improved Farrington algorithm is available as function
  <code><a href="farringtonFlexible.html">farringtonFlexible</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>A statistical algorithm for the early detection of outbreaks of
  infectious disease, Farrington, C.P., Andrews, N.J, Beale A.D. and
  Catchpole, M.A. (1996), J. R. Statist. Soc. A, 159, 547-563.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">#load "disProg" data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"salmonella.agona"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Do surveillance for the last 42 weeks</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">salmonella.agona</span><span class="op">$</span><span class="va">observed</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>b<span class="op">=</span><span class="fl">4</span>,w<span class="op">=</span><span class="fl">3</span>,range<span class="op">=</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">42</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>,reweight<span class="op">=</span><span class="cn">TRUE</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>,alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">algo.farrington</span><span class="op">(</span><span class="va">salmonella.agona</span>,control<span class="op">=</span><span class="va">control</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Generate Poisson counts and create an "sts" object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">520</span>,lambda<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">stsObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="sts-class.html">sts</a></span><span class="op">(</span>observed<span class="op">=</span><span class="va">x</span>, frequency<span class="op">=</span><span class="fl">52</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="surveillance.options.html">surveillance.options</a></span><span class="op">(</span><span class="st">"allExamples"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#Compare timing of the two possible fitters for algo.farrington</span></span>
<span>  <span class="va">range</span> <span class="op">&lt;-</span> <span class="fl">312</span><span class="op">:</span><span class="fl">520</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> <span class="va">sts1</span> <span class="op">&lt;-</span> <span class="fu">farrington</span><span class="op">(</span><span class="va">stsObj</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="va">range</span>,</span>
<span>                         fitFun<span class="op">=</span><span class="st">"algo.farrington.fitGLM.fast"</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> <span class="va">sts2</span> <span class="op">&lt;-</span> <span class="fu">farrington</span><span class="op">(</span><span class="va">stsObj</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="va">range</span>,</span>
<span>                         fitFun<span class="op">=</span><span class="st">"algo.farrington.fitGLM"</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">#Check if results are the same</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="stsSlots.html">upperbound</a></span><span class="op">(</span><span class="va">sts1</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="stsSlots.html">upperbound</a></span><span class="op">(</span><span class="va">sts2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

