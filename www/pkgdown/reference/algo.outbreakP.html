<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Semiparametric surveillance of outbreaks — algo.outbreakP • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Semiparametric surveillance of outbreaks — algo.outbreakP"><meta name="description" content="Frisen and Andersson (2009) method for semiparametric surveillance of outbreaks"><meta property="og:description" content="Frisen and Andersson (2009) method for semiparametric surveillance of outbreaks"><!-- For Rd equations in pkgdown 2.1.0, see https://katex.org/docs/autorender.html --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          throwOnError: false,
          macros: {"\\code": "\\texttt"}
      })
  });
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Semiparametric surveillance of outbreaks</h1>

      <div class="d-none name"><code>algo.outbreakP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Frisen and Andersson (2009) method for semiparametric surveillance of outbreaks</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">algo.outbreakP</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="va">range</span>, k<span class="op">=</span><span class="fl">100</span>,</span>
<span>               ret<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cases"</span>,<span class="st">"value"</span><span class="op">)</span>,maxUpperboundCases<span class="op">=</span><span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-disprogobj">disProgObj<a class="anchor" aria-label="anchor" href="#arg-disprogobj"></a></dt>
<dd><p>object of class disProg (including the observed and the state chain).</p></dd>

<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list controlling the behaviour of the algorithm</p><dl><dt><code>range</code></dt>
<dd><p>determines the desired
        time-points which should be monitored. Note that it is
        automatically assumed that ALL other values in <code>disProgObj</code>
        can be used for the estimation, i.e. for a specific value <code>i</code>
        in <code>range</code> all values from 1 to <code>i</code> are used for estimation.</p></dd>

    <dt><code>k</code></dt>
<dd><p>The threshold value. Once the outbreak statistic
        is above this threshold <code>k</code> an alarm is sounded.</p></dd>

    <dt><code>ret</code></dt>
<dd><p>a string specifying the type of
        <code>upperbound</code>-statistic that is returned. With
        <code>"cases"</code> the number of cases that would have been
        necessary to produce an alarm (NNBA) or with <code>"value"</code> the
        outbreakP-statistic is computed (see below).</p></dd>

    <dt><code>maxUpperboundCases</code></dt>
<dd><p>Upperbound when numerically searching
        for NNBA. Default is 1e5.</p></dd>


</dl><p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>algo.outbreakP</code> gives a list of class <code>survRes</code> which
  includes the vector of alarm values for every time-point in
  <code>range</code>, the vector of threshold values for every time-point
  in <code>range</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A generalized likelihood ratio test based on the Poisson
  distribution is implemented where the means of the in-control and
  out-of-control states are computed by isotonic regression.</p>
<p>$$OutbreakP(s) = \prod_{t=1}^s \left( \frac{\hat{\mu}^{C1}(t)}{\hat{\mu}^D(t)} \right)^{x(t)}$$</p>
<p>where \(\hat{\mu}^{C1}(t)\) is the estimated mean obtained by
 uni-modal regression under the assumption of one change-point and
 \(\hat{\mu}^D(t)\) is the estimated result when there is no
 change-point (i.e. this is just the mean of all observations). Note
 that the contrasted hypothesis assume all means are equal until the
 change-point, i.e. this detection method is especially suited for
 detecting a shift from a relative constant mean. Hence, this is less
 suited for detection in diseases with strong seasonal endemic
 component. Onset of influenza detection is an example where this
 method works particular well.</p>
<p>In case <code>control$ret == "cases"</code> then a brute force numerical
 search for the number needed before alarm (NNBA) is performed. That
 is, given the past observations, what's the minimum number which would
 have caused an alarm? Note: Computing this might take a while because
 the search is done by sequentially increasing/decreasing the last
 observation by one for each time point in <code>control$range</code> and
 then calling the workhorse function of the algorithm again. The argument
 <code>control$maxUpperboundCases</code> controls the upper limit of this
 search (default is 1e5).
 Currently, even though the statistic has passed the threshold, the NNBA
 is still computed. After a few time instances what typically happens is
 that no matter the observed value we would have an alarm at this time point. In this case the value of NNBA is set to <code>NA</code>. Furthermore, the first time
 point is always <code>NA</code>, unless <code>k&lt;1</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>The code is an extended R port of the Java code by Marianne
 Frisén and Linus Schiöler from the
 Computer Assisted Search For Epidemics (CASE) project,
 formerly available from <code>https://case.folkhalsomyndigheten.se/</code>
 under the GNU GPL License v3.
 <!-- %% A manual on how to use an Excel implementation of the method -->
 <!-- %% is available at \url{http://economics.handels.gu.se/english/Units+and+Centra/statistical_research_unit/software}. --></p>
<p>An additional feature of the R code is that it contains a search for
 NNBA (see details).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>M. Höhle – based on Java code by M. Frisen and
  L. Schiöler</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Frisén, M., Andersson and Schiöler, L., (2009), Robust
outbreak surveillance of epidemics in Sweden, Statistics in
Medicine, 28(3):476-493.</p>
<p>Frisén, M. and Andersson, E., (2009) Semiparametric
Surveillance of Monotonic Changes, Sequential Analysis 28(4):434-454.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">#Use data from outbreakP manual (http://www.hgu.gu.se/item.aspx?id=16857)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">16</span>,<span class="fl">23</span>,<span class="fl">33</span>,<span class="fl">34</span>,<span class="fl">48</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Generate sts object with these observations</span></span>
<span><span class="va">mysts</span> <span class="op">&lt;-</span> <span class="fu"><a href="sts-class.html">sts</a></span><span class="op">(</span><span class="va">y</span>, alarm<span class="op">=</span><span class="va">y</span><span class="op">*</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run the algorithm and present results</span></span>
<span><span class="co">#Only the value of outbreakP statistic</span></span>
<span><span class="fu"><a href="stsSlots.html">upperbound</a></span><span class="op">(</span><span class="fu"><a href="wrap.algo.html">outbreakP</a></span><span class="op">(</span><span class="va">mysts</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">100</span>,</span>
<span>           ret<span class="op">=</span><span class="st">"value"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Graphical illustration with number-needed-before-alarm (NNBA) upperbound.</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">outbreakP</a></span><span class="op">(</span><span class="va">mysts</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">100</span>,</span>
<span>           ret<span class="op">=</span><span class="st">"cases"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>,dx.upperbound<span class="op">=</span><span class="fl">0</span>,lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,legend.opts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Infected"</span>,</span>
<span>      <span class="st">"NNBA"</span>,<span class="st">"Outbreak"</span>,<span class="st">"Alarm"</span><span class="op">)</span>,horiz<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

