<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.25.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/events.html">Events</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Changelog</h1>

    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.25.0" id="surveillance-1250-2025-06-24">surveillance 1.25.0 (2025-06-24)<a class="anchor" aria-label="anchor" href="#surveillance-1250-2025-06-24"></a></h2>
<div class="section level3">
<h3 id="new-features-1-25-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-25-0"></a></h3>
<ul><li><p><code><a href="../reference/algo.cusum.html">algo.cusum()</a></code> gains a <code>reset</code> option: if enabled, the CUSUM statistic restarts from 0 after an alarm. (Wish of Ann Christin Vietor.)</p></li>
<li><p><code><a href="../reference/twinstim_intensity.html">intensityplot.twinstim()</a></code> in its spatial variant now automatically labels the color key.</p></li>
<li><p><code><a href="../reference/twinstim_intensity.html">intensityplot.twinstim()</a></code> now also supports plotting the component intensities, not just their proportions.</p></li>
<li><p><code><a href="../reference/hhh4_plot.html">plotHHH4_neweights()</a></code> now only excludes distance 0 by default when the model has an AR component.</p></li>
<li><p><code><a href="../reference/stsplot.html">plot.sts()</a></code> now allows <code>type = ~time</code> and <code>type = ~unit</code> as short forms of <code>type = observed ~ time</code> and <code>type = observed ~ unit</code>, respectively.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-25-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-25-0"></a></h3>
<ul><li><p><code><a href="../reference/algo.glrnb.html">algo.glrnb()</a></code> warns about unimplemented <code>dir</code>ection settings.</p></li>
<li><p><code>intensityplot.twinstim(..., aggregate = "space")</code> no longer disables <code>checkEmptyRC</code> when it calls <code><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">sp::spplot()</a></code>, so grids with horizontal or vertical gaps are now plotted without artifacts.</p></li>
<li><p><code><a href="../reference/hhh4_plot.html">plot.hhh4()</a></code> can now be called with an <em>unnamed</em> <code>type</code> argument and additional named arguments of specific methods.</p></li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-25-0">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-25-0"></a></h3>
<ul><li>The deprecated function <code>stsplot_spacetime()</code> has been removed. <code><a href="../reference/stsplot.html">plot.sts()</a></code> with the old <code>type = observed ~ 1 | unit</code> now uses <code><a href="../reference/stsplot_space.html">stsplot_space()</a></code> with a warning.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.24.1" id="surveillance-1241-2024-11-05">surveillance 1.24.1 (2024-11-05)<a class="anchor" aria-label="anchor" href="#surveillance-1241-2024-11-05"></a></h2>
<p>This maintenance release adjusts a test of <code><a href="../reference/formatDate.html">formatDate()</a></code> to be compatible with recent changes in R-devel.</p>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.24.0" id="surveillance-1240-2024-10-01">surveillance 1.24.0 (2024-10-01)<a class="anchor" aria-label="anchor" href="#surveillance-1240-2024-10-01"></a></h2>
<div class="section level3">
<h3 id="new-features-1-24-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-24-0"></a></h3>
<ul><li><p><code><a href="../reference/hhh4_methods.html">residuals.hhh4()</a></code> can now also compute <code>type = "pearson"</code> residuals.</p></li>
<li><p>The standard <code><a href="https://rdrr.io/r/stats/time.html" class="external-link">frequency()</a></code> and <code><a href="https://rdrr.io/r/stats/start.html" class="external-link">start()</a></code> generics can now be used to extract the respective slots from an <code>"sts"</code> object.</p></li>
<li><p>When indexing a spatial <code>"sts"</code> object that contains a map by region names, i.e., <code>&lt;sts&gt;[,&lt;character&gt;]</code>, the additional argument <code>drop = TRUE</code> can now be used to subset the map accordingly.</p></li>
</ul></div>
<div class="section level3">
<h3 id="package-infrastructure-1-24-0">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-24-0"></a></h3>
<ul><li>
<strong>sp</strong> version 2.1-4 is now required, mainly to skip versions that produce misleading/obsolete startup messages or throw unnecessary warnings when <strong>sf</strong> is not available.</li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-24-0">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-24-0"></a></h3>
<ul><li>The experimental <code><a href="../reference/surveillance-defunct.html">algo.twins()</a></code> implementation of <a href="https://doi.org/10.1093/biostatistics/kxj016" class="external-link">Held et al. (2006)</a> has been removed from the package. The source code has been migrated to a separate R package, <strong>twins</strong>, which is archived at <a href="https://codeberg.org/EE-hub/twins" class="external-link uri">https://codeberg.org/EE-hub/twins</a>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-24-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-24-0"></a></h3>
<ul><li>
<code>update.hhh4(S =)</code> can now be used for a previously disabled model component, when it simply uses <code>f = ~1</code> and adds the requested number of harmonics (but gives a warning as the specification may need to be tweaked, e.g., for an offset).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.23.1" id="surveillance-1231-2024-09-02">surveillance 1.23.1 (2024-09-02)<a class="anchor" aria-label="anchor" href="#surveillance-1231-2024-09-02"></a></h2>
<div class="section level3">
<h3 id="new-features-1-23-1">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-23-1"></a></h3>
<ul><li><p>The <code><a href="../reference/sts-class.html">sts()</a></code> constructor now also accepts an <code>"sf"</code> object as <code>map</code> input; it is internally converted to <code>"SpatialPolygons"</code> as required by the <code>"sts"</code> class. (Based on a patch by Sophie Reichert.)</p></li>
<li><p><code><a href="../reference/epidataCS.html">as.epidataCS()</a></code> is faster in determining potential event sources.</p></li>
</ul></div>
<div class="section level3">
<h3 id="package-infrastructure-1-23-1">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-23-1"></a></h3>
<ul><li>
<strong>Rcpp</strong> is no longer used. Only two small helper functions (for <code>backprojNP(eq3a.method="C")</code> and <code><a href="../reference/epidataCS.html">as.epidataCS()</a></code>) were using it (inefficiently) and have been replaced by C implementations. This also reduces the size of the installed package.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.23.0" id="surveillance-1230-2024-05-03">surveillance 1.23.0 (2024-05-03)<a class="anchor" aria-label="anchor" href="#surveillance-1230-2024-05-03"></a></h2>
<div class="section level3">
<h3 id="new-features-1-23-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-23-0"></a></h3>
<ul><li>
<code><a href="../reference/epidataCS_update.html">update.epidataCS()</a></code> gained an argument <code>stgrid</code> to update the spatio-temporal grid data in an existing <code>"epidataCS"</code> object. This enables updates/transformations of endemic variables and/or changes of the time intervals without needing to do <code><a href="../reference/epidataCS.html">as.epidataCS()</a></code> from scratch.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-23-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-23-0"></a></h3>
<ul><li><p>Start values for endemic intercepts in <code><a href="../reference/twinstim.html">twinstim()</a></code> are now robust against non-finite values in offset terms.</p></li>
<li><p><code>intensityplot.twinstim(aggregate = "space")</code> no longer fails for endemic-only fits.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.22.1" id="surveillance-1221-2023-11-27">surveillance 1.22.1 (2023-11-27)<a class="anchor" aria-label="anchor" href="#surveillance-1221-2023-11-27"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-1-22-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-22-1"></a></h3>
<ul><li>The <code><a href="../reference/pit.html">pit()</a></code> plot could lack some tick marks on the y-axis (for R &gt;= 4.2.0).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.22.0" id="surveillance-1220-2023-10-30">surveillance 1.22.0 (2023-10-30)<a class="anchor" aria-label="anchor" href="#surveillance-1220-2023-10-30"></a></h2>
<div class="section level3">
<h3 id="package-infrastructure-1-22-0">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-22-0"></a></h3>
<ul><li>Legacy functions <code><a href="../reference/unionSpatialPolygons.html">unionSpatialPolygons()</a></code> and <code><a href="../reference/polyAtBorder.html">polyAtBorder()</a></code> now use <strong>sf</strong> in place of <strong>rgeos</strong>.</li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-22-0">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-22-0"></a></h3>
<ul><li><p>Long unused methods for <code>"gpc.poly"</code> objects (from package <strong>gpclib</strong>) have now been removed and <code>surveillance.options("gpclib")</code> is obsolete.</p></li>
<li><p>Package <strong>rgeos</strong> is no longer available as a <code>clipper</code> method for <code><a href="../reference/epidataCS.html">as.epidataCS()</a></code>. The previous default <strong>polyclip</strong> remains as the only option.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.21.1" id="surveillance-1211-2023-05-16">surveillance 1.21.1 (2023-05-16)<a class="anchor" aria-label="anchor" href="#surveillance-1211-2023-05-16"></a></h2>
<p>This is a maintenance release, fixing encoding-related portability issues and increasing test coverage for rarely used functionality.</p>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.21.0" id="surveillance-1210-2023-03-14">surveillance 1.21.0 (2023-03-14)<a class="anchor" aria-label="anchor" href="#surveillance-1210-2023-03-14"></a></h2>
<div class="section level3">
<h3 id="minor-changes-1-21-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-21-0"></a></h3>
<ul><li><p><code><a href="../reference/nbOrder.html">nbOrder()</a></code> has been re-implemented: it is now more efficient and no longer depends on <strong>spdep</strong>. Furthermore, it now defaults to <code>maxlag = Inf</code>; the historical default <code>maxlag = 1</code> was barely useful. It no longer messages (about the range of the detected orders).</p></li>
<li><p>Printing <code>"sts"</code> objects with a map now shows the first row of the attached data (if present) instead of the object summary.</p></li>
</ul></div>
<div class="section level3">
<h3 id="package-infrastructure-1-21-0">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-21-0"></a></h3>
<ul><li>Accommodate the current evolution of <strong>sp</strong>: <strong>sf</strong> is suggested and some examples are now conditionalized on its availability.</li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-21-0">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-21-0"></a></h3>
<ul><li><p><strong>surveillance</strong> no longer relies on the <strong>maptools</strong> package: <code><a href="../reference/unionSpatialPolygons.html">unionSpatialPolygons()</a></code> with <code>method = "gpclib"</code> is deprecated and now uses the default method with a warning.</p></li>
<li><p>Long unused <code><a href="../reference/surveillance-defunct.html">scale.gpc.poly()</a></code> and <code><a href="../reference/surveillance-defunct.html">inside.gpc.poly()</a></code> are deprecated; the unused and undocumented <code>diameter.gpc.poly()</code> method has been removed.</p></li>
<li><p><code>stsplot_spacetime()</code> is formally deprecated; it has long been superseded by <code><a href="../reference/stsplot_space.html">stsplot_space()</a></code> and an <code><a href="../reference/animate.html">animate()</a></code> method for <code>"sts"</code> objects.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.20.3" id="surveillance-1203-2022-11-14">surveillance 1.20.3 (2022-11-14)<a class="anchor" aria-label="anchor" href="#surveillance-1203-2022-11-14"></a></h2>
<div class="section level3">
<h3 id="package-infrastructure-1-20-3">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-20-3"></a></h3>
<ul><li>
<code>vignette("monitoringCounts")</code> now uses <strong>knitr</strong> as its engine to work around <a href="https://bugs.R-project.org/show_bug.cgi?id=18318" class="external-link">Bug 18318</a>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.20.2" id="surveillance-1202-2022-10-31">surveillance 1.20.2 (2022-10-31)<a class="anchor" aria-label="anchor" href="#surveillance-1202-2022-10-31"></a></h2>
<div class="section level3">
<h3 id="new-features-1-20-2">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-20-2"></a></h3>
<ul><li>
<code><a href="../reference/hhh4_plot.html">plotHHH4_fitted()</a></code> can now produce simple (unformatted) time indexes if argument <code>xaxis = NA</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-20-2">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-20-2"></a></h3>
<ul><li><p>Various documentation improvements, including an example for <code><a href="../reference/hhh4_predict.html">predict.hhh4()</a></code>.</p></li>
<li><p><code><a href="../reference/twinstim_intensity.html">intensityplot.twinstim()</a></code> no longer depends on package <a href="https://CRAN.R-project.org/package=maptools" class="external-link"><strong>maptools</strong></a>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-20-2">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-20-2"></a></h3>
<ul><li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> now warns about interaction terms in model formulae. These are not implemented and were silently ignored previously.</p></li>
<li><p>Fixed a memory leak in <code><a href="../reference/surveillance-defunct.html">algo.twins()</a></code>; note that this old experimental MCMC implementation for a two-component epidemic model may be removed in future versions of the package.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.20.1" id="surveillance-1201-2022-07-13">surveillance 1.20.1 (2022-07-13)<a class="anchor" aria-label="anchor" href="#surveillance-1201-2022-07-13"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-1-20-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-20-1"></a></h3>
<ul><li><p><code><a href="../reference/ks.plot.unif.html">ks.plot.unif()</a></code>: accommodate to <code>NO_S_TYPEDEFS</code> in R &gt;= 4.3.0.</p></li>
<li><p><code><a href="../reference/boda.html">boda()</a></code> with <code>samplingMethod="marginals"</code> gave all-<code>NA</code> upperbounds in INLA &gt;= 21.07.10. <code><a href="../reference/boda.html">boda()</a></code> now also works around a scoping issue (with <code>E</code>) in recent versions of INLA that led to wrongly scaled upperbounds.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.20.0" id="surveillance-1200-2022-02-15">surveillance 1.20.0 (2022-02-15)<a class="anchor" aria-label="anchor" href="#surveillance-1200-2022-02-15"></a></h2>
<div class="section level3">
<h3 id="new-features-1-20-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-20-0"></a></h3>
<ul><li><p><code><a href="../reference/hhh4_plot.html">plotHHH4_season()</a></code> gained a <code>period</code> argument to support harmonics with periods longer than the frequency of the <code>"sts"</code> object.</p></li>
<li><p><code><a href="../reference/stsplot_space.html">stsplot_space()</a></code> now supports passing a <code>col</code> argument to <code><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">sp::spplot()</a></code> to change the colour of the polygon lines.</p></li>
<li><p><code><a href="../reference/hhh4_plot.html">plotHHH4_fitted()</a></code> can now handle time series with missing values.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-20-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-20-0"></a></h3>
<ul><li><p>If the Nelder-Mead optimizer is used for the variance parameters in <code><a href="../reference/hhh4.html">hhh4()</a></code>, it is now limited to 500 (not 300) iterations by default (consistent with the default in <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>).</p></li>
<li><p>Printing an <code>"sts"</code> object now omits the <code>neighbourhood</code> component if that was not set (all-<code>NA</code> prototype).</p></li>
<li><p><code>simulate.hhh4(..., simplify = TRUE)</code> now consistently returns a 3d array (nTime x nUnit x nsim), even for <code>nsim = 1</code> (for which plotting now works).</p></li>
<li><p>The default legend in <code><a href="../reference/stsplot_time.html">stsplot_time1()</a></code> now only includes plotted elements.</p></li>
<li><p><code><a href="../reference/wrap.algo.html">wrap.algo()</a></code> no longer prints progress when there is only one area.</p></li>
<li><p><code><a href="../reference/hhh4_methods.html">summary.hhh4()</a></code> now prints the number of excluded observations (due to missingness), if any.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-20-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-20-0"></a></h3>
<ul><li><p>The <code>print</code>-method for <code><a href="../reference/hhh4_methods.html">summary.hhh4()</a></code> did not apply the <code>digits</code> argument to the coefficient matrix. Furthermore, printing of estimated variance parameters now adheres to <em>significant</em> <code>digits</code> as documented.</p></li>
<li><p>The <code>[</code>-method for the <code>"hhh4sims"</code> class was not registered and thus only available internally. Array-like subsetting of simulated counts now retains the class.</p></li>
<li><p><code><a href="../reference/farringtonFlexible.html">farringtonFlexible()</a></code> with activated <code>populationOffset</code> (non-default) always used the population data of the <em>first</em> time series in the fitting step while iterating over a multivariate <code>"sts"</code> object.</p></li>
<li><p><code>plotHHH4_ri(..., exp = TRUE)</code> failed to use a log-scale color axis if further <code>colorkey</code> options were passed in a list. The (default) color breaks could fail to span the range of the data without warning (resulting in unfilled polygons). This is now checked and the default breaks are now equally spaced on the log-scale.</p></li>
<li><p><code><a href="../reference/stsplot_time.html">stsplot_time1()</a></code> did not pass <code>lty</code> to <code><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon()</a></code> and <code>lwd</code> to <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend()</a></code>.</p></li>
<li><p><code><a href="../reference/scores.html">rps()</a></code> was wrong for distributions close to a point mass at zero, e.g., for <code>mu = 1e-3</code> and <code>x &gt;= 4</code>. It is now also protected against wide (quasi-continuous) NegBin distributions that would consume too much memory with discrete RPS calculation (returning a missing value with a warning). [both issues spotted by F. Rousseu]</p></li>
<li><p>Plots of legacy <code>"disProg"</code> and <code>"survRes"</code> objects are now generated via internal <code><a href="../reference/disProg2sts.html">disProg2sts()</a></code> conversion and <code><a href="../reference/stsplot_time.html">stsplot_time()</a></code>. This fixes their x-axis labels for the default <code>xaxis.years=TRUE</code>. The obsolete arguments <code>startyear</code> and <code>firstweek</code> are now ignored with a warning.</p></li>
<li><p>The default legend of <code><a href="../reference/stsplot_time.html">stsplot_time1()</a></code> did not show the fill color in the non-default case <code>!is.na(col[1])</code>.</p></li>
<li><p>Multivariate <code><a href="../reference/hhh4.html">hhh4()</a></code> with neighbourhood component treated <code>NA</code> counts as zero when calculating the weighted sum over units. A missing count at <em>t-1</em> in any unit now gives <code>NA</code> values for the neighbourhood terms of all units at time <em>t</em>, thus reducing <code><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs()</a></code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-20-0">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-20-0"></a></h3>
<ul><li><p><code><a href="../reference/create.disProg.html">create.disProg()</a></code> is deprecated. Methods for legacy <code>"disProg"</code> objects are kept for backwards compatibility, but new projects should use <code><a href="../reference/sts-class.html">sts()</a></code>.</p></li>
<li><p>The long-deprecated <code><a href="../reference/surveillance-defunct.html">qlomax()</a></code> implementation has been removed.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.19.1" id="surveillance-1191-2021-03-30">surveillance 1.19.1 (2021-03-30)<a class="anchor" aria-label="anchor" href="#surveillance-1191-2021-03-30"></a></h2>
<div class="section level3">
<h3 id="documentation-1-19-1">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-19-1"></a></h3>
<ul><li>The project website at <a href="https://surveillance.R-Forge.R-project.org/" class="external-link uri">https://surveillance.R-Forge.R-project.org/</a> has been overhauled using <a href="https://pkgdown.r-lib.org/" class="external-link"><strong>pkgdown</strong></a>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-19-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-19-1"></a></h3>
<ul><li><p>The <code>CRS</code> of <code>data(imdepi)</code> and <code>data(measlesWeserEms)</code> have been updated via <code><a href="https://edzer.github.io/sp/reference/CRS-class.html" class="external-link">sp::rebuild_CRS()</a></code> to avoid warnings when <strong>rgdal</strong> is loaded with new PROJ and GDAL libraries.</p></li>
<li><p><code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> now internally resets the CRS (temporary), which avoids spurious warnings and also reduces its runtime by about 25%.</p></li>
<li><p>Fix encoding error in <code>vignette("twinstim")</code> for CRAN’s non-UTF8 Linux test machine.</p></li>
<li><p>This version of <strong>surveillance</strong> (formally) requires the new <a href="https://CRAN.R-project.org/package=spatstat" class="external-link"><strong>spatstat</strong></a> umbrella package to avoid collisions of old <strong>spatstat</strong> and its new sub-packages (we only use <a href="https://CRAN.R-project.org/package=spatstat.geom" class="external-link"><strong>spatstat.geom</strong></a>). The <strong>spatstat</strong> dependence will be dropped in the future.</p></li>
<li><p>The <code>epoch&lt;-</code> replacement method for <code>"sts"</code> objects now accepts a <code>"Date"</code> vector. The standard plots may give nicer x-axis annotation if indexed by dates. See the <code>xaxis.*</code> arguments of <code><a href="../reference/stsplot_time.html">stsplot_time()</a></code>.</p></li>
<li><p><code><a href="../reference/sts_tidy.html">tidy.sts()</a></code> (and thus <code><a href="../reference/sts_ggplot.html">autoplot.sts()</a></code>) failed for date-indexed <code>"sts"</code> objects with non-standard frequencies. [spotted by Junyi Lu]</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.19.0" id="surveillance-1190-2021-01-29">surveillance 1.19.0 (2021-01-29)<a class="anchor" aria-label="anchor" href="#surveillance-1190-2021-01-29"></a></h2>
<div class="section level3">
<h3 id="new-features-1-19-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-19-0"></a></h3>
<ul><li><p>The <code><a href="../reference/nowcast.html">nowcast()</a></code> function with <code>method="bayes.trunc.ddcp"</code> now adds support for negative binomial response distribution instead of Poisson. Furthermore, additional components of the design matrix for the discrete time survival model can be provided, which allows the inclusion of, e.g., day of the week effects. Finally, the order of the polynomial created by the change-points in the discrete time survival model can now be specified. For further details see the work of Guenther et al. (2020) about nowcasting the Covid-19 outbreak in Bavaria, Germany.</p></li>
<li><p><code><a href="../reference/sts_animate.html">animate.sts()</a></code> can position the <code>timeplot</code> on other sides of the map.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-19-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-19-0"></a></h3>
<ul><li><p>The weighted sum in the <code>ne</code>ighbourhood component of <code><a href="../reference/hhh4.html">hhh4()</a></code> models is computed more efficiently.</p></li>
<li><p><code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> (and thus <code><a href="../reference/twinstim_simulation.html">simulate.twinstim()</a></code>) uses a slightly more efficient location sampler for models with <code>siaf = siaf.constant()</code>. Simulation results will differ from previous package versions even if the same random <code>seed</code> is used.</p></li>
<li><p>The default <code>main</code> title for <code><a href="../reference/stsplot_space.html">stsplot_space()</a></code> now uses the ISO year-week format for weekly <code>"sts"</code> data.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-19-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-19-0"></a></h3>
<ul><li><p>Bug fix in the <code><a href="../reference/farringtonFlexible.html">farringtonFlexible()</a></code>-function, which for the argument <code>thresholdMethod=="nbPlugin"</code> and <code>thresholdMethod=="muan"</code> unfortunately computed the limit as an <code>(1-alpha/2)</code> prediction interval instead of the documented <code>(1-alpha)</code> prediction interval. This affects four threshold values in Table 2 of <code>vignette("monitoringCounts")</code>. The default method <code>"delta"</code> worked as expected.</p></li>
<li><p>In <code><a href="../reference/hhh4.html">hhh4()</a></code> models without AR component, the matrix of fitted values could lack column names.</p></li>
<li><p>Experimental time-varying neighbourhood weights in <code><a href="../reference/hhh4.html">hhh4()</a></code> were indexed differently in model fitting and in the <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate()</a></code> method (undocumented behaviour). Both now use the latter variant, where the mean at time <em>t</em> uses products of weights at time <em>t</em> and observed counts at time <em>t-1</em>. [reported by Johannes Bracher]</p></li>
<li><p>For weekly <code>sts</code> indexed via <code>start</code> and <code>freq=52</code>, <code>epoch(sts, as.Date=TRUE)</code> now interprets the <code>start</code> week according to ISO 8601. For example, <code>start = c(2020, 5)</code> corresponds to 2020-01-27, not 2020-02-03. This affects <code><a href="../reference/sts-class.html">as.xts.sts()</a></code> and the time plot in <code><a href="../reference/sts_animate.html">animate.sts()</a></code>.</p></li>
<li><p><code><a href="../reference/stsplot_space.html">stsplot_space()</a></code> automatically extends manual color breaks (<code>at</code>), if the intervals do not cover the data range.</p></li>
<li><p><code><a href="../reference/twinstim_simEndemicEvents.html">simEndemicEvents()</a></code> and thus <code>epitest(..., method="simulate")</code> are no longer slowed down by intermediate <code><a href="https://edzer.github.io/sp/reference/CRS-class.html" class="external-link">sp::CRS()</a></code> computations.</p></li>
</ul></div>
<div class="section level3">
<h3 id="package-infrastructure-1-19-0">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-19-0"></a></h3>
<ul><li><p>Removed unused <strong>rmapshaper</strong> from “Suggests” and moved <strong>xts</strong> to “Enhances” (used only for <code>as.xts.sts</code>).</p></li>
<li><p>Switched testing framework from (nowadays heavy) <strong>testthat</strong> to <a href="https://CRAN.R-project.org/package=tinytest" class="external-link"><strong>tinytest</strong></a>. Together with moving <strong>ggplot2</strong> to “Enhances” (used only for <code>autoplot.sts</code>) — and only then — this switch further reduces the total number of required packages for a complete check (i.e., installing with <code>dependencies = TRUE</code>) in a <em>factory-fresh</em> R environment from 119 to 94.</p></li>
<li><p><a href="https://CRAN.R-project.org/package=spatstat" class="external-link"><strong>spatstat</strong></a> was split into several sub-packages, of which we only need to import <a href="https://CRAN.R-project.org/package=spatstat.geom" class="external-link"><strong>spatstat.geom</strong></a>. This new package requires <code>R &gt;= 3.5.0</code>, though.</p></li>
<li><p><strong>surveillance</strong> now requires <code>R &gt;= 3.6.0</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.18.0" id="surveillance-1180-2020-03-18">surveillance 1.18.0 (2020-03-18)<a class="anchor" aria-label="anchor" href="#surveillance-1180-2020-03-18"></a></h2>
<div class="section level3">
<h3 id="new-features-1-18-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-18-0"></a></h3>
<ul><li><p>New spatial interaction function for <code><a href="../reference/twinstim.html">twinstim()</a></code>: <code><a href="../reference/twinstim_iaf.html">siaf.exponential()</a></code> implements the exponential kernel <em>f(x) = exp(-x/σ)</em>, which is a useful alternative if the two-parameter power-law kernel is not identifiable.</p></li>
<li><p>The <code>plot</code>-type <code>"maps"</code> for <code>"hhh4"</code> fits, <code><a href="../reference/hhh4_plot.html">plotHHH4_maps()</a></code>, now allows for map-specific color keys via <code>zmax = NA</code> (useful for <code>prop = TRUE</code>).</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-18-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-18-0"></a></h3>
<ul><li><p>The <code><a href="../reference/nowcast.html">nowcast()</a></code>-function now also works for <code>method="bayes.trunc.ddcp"</code> method when the number of breakpoints is greater than 1.</p></li>
<li><p>The <code>amplitudeShift</code> transformation for sine-cosine coefficient pairs in the <code>summary</code> of multivariate <code>"hhh4"</code> models was incorrect in the rare case that the model used unit-specific seasonal terms (<code>addSeason2formula</code> with <code>length(S) &gt; 1</code>).</p></li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-18-0">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-18-0"></a></h3>
<ul><li>The original <code><a href="../reference/surveillance-defunct.html">algo.hhh()</a></code> implementation of the HHH model has been removed from the package. The function <code><a href="../reference/hhh4.html">hhh4()</a></code> provides an improved and much extended implementation since 2012.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.17.3" id="surveillance-1173-2019-12-16">surveillance 1.17.3 (2019-12-16)<a class="anchor" aria-label="anchor" href="#surveillance-1173-2019-12-16"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-1-17-3">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-17-3"></a></h3>
<ul><li><p>The <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code>-method for <code>"epidataCS"</code> objects did not work with a negative <code>n</code> argument.</p></li>
<li><p>Fix for <code>"matrix"</code> changes in R-devel.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.17.2" id="surveillance-1172-2019-11-11">surveillance 1.17.2 (2019-11-11)<a class="anchor" aria-label="anchor" href="#surveillance-1172-2019-11-11"></a></h2>
<div class="section level3">
<h3 id="minor-changes-1-17-2">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-17-2"></a></h3>
<ul><li>For multivariate time series, <code><a href="../reference/sts-class.html">sts()</a></code> now checks for mismatches in column names of supplied matrices (<code>observed</code>, <code>population</code>, <code>neighbourhood</code>, …). This is to catch input where the units (columns) are ordered differently in different slots, which would flaw subsequent analyses.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-17-2">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-17-2"></a></h3>
<ul><li>
<code><a href="../reference/twinSIR_simulation.html">simulate.twinSIR()</a></code> ignored the <code>atRiskY</code> indicator of the underlying <code>"epidata"</code>, so always assumed a completely susceptible population. Initially infectious individuals are now inherited. For the previous behaviour, adjust the supplied <code>data</code> via <code>data$atRiskY &lt;- 1</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.17.1" id="surveillance-1171-2019-09-13">surveillance 1.17.1 (2019-09-13)<a class="anchor" aria-label="anchor" href="#surveillance-1171-2019-09-13"></a></h2>
<div class="section level3">
<h3 id="new-features-1-17-1">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-17-1"></a></h3>
<ul><li>New one-parameter power-law kernel <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw1()</a></code> with fixed <code>sigma = 1</code>. Useful if <code>sigma</code> is difficult to estimate with <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw()</a></code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-17-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-17-1"></a></h3>
<ul><li><p><code><a href="../reference/pit.html">pit()</a></code>’s default <code>ylab</code> was wrong (default are densities not relative frequencies).</p></li>
<li><p><code><a href="../reference/R0.html">R0()</a></code> for <code>"twinstim"</code> fits with specified <code>newevents</code> now handles levels of epidemic factor variables automatically via the new <code>xlevels</code> attribute stored in the fitted model.</p></li>
<li><p>Some S3 methods for the <code>"sts"</code> class are now formally registered and identical to the established S4 methods.</p></li>
<li><p>Minor additions and fixes in the package documentation.</p></li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-17-1">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-17-1"></a></h3>
<ul><li>
<code><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors()</a></code>, exported since 1.14.0, has been renamed <code><a href="../reference/hcl.colors.html">.hcl.colors()</a></code> and is now internal again, to avoid a name clash with R’s own such function introduced in R 3.6.0.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.17.0" id="surveillance-1170-2019-02-22">surveillance 1.17.0 (2019-02-22)<a class="anchor" aria-label="anchor" href="#surveillance-1170-2019-02-22"></a></h2>
<div class="section level3">
<h3 id="new-features-1-17-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-17-0"></a></h3>
<ul><li><p><code>W_powerlaw(..., from0 = TRUE)</code> enables more parsimonious <code>hhh4</code> models in that the power-law weights are modified to include the autoregressive (0-distance) case (see <code>vignette("hhh4_spacetime")</code>). The unstructured distance weights <code><a href="../reference/hhh4_W.html">W_np()</a></code> gained <code>from0</code> support as well.</p></li>
<li><p><code><a href="../reference/sts-class.html">sts()</a></code> creation can now handle <code>epoch</code> arguments of class <code>Date</code> directly.</p></li>
<li><p>The <code><a href="../reference/ranef.html">ranef()</a></code>-method for <code>"hhh4"</code> fits gained a logical argument <code>intercept</code> to extract the unit-specific intercepts of the log-linear predictors instead of the default zero-mean deviations around the fixed intercepts. The corresponding <code>plot</code> method (<code>type="ri"</code>) gained an argument <code>exp</code>: if set to <code>TRUE</code> random effects are <code>exp</code>-transformed and thus show multiplicative effects. [based on feedback by Tim Pollington]</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-17-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-17-0"></a></h3>
<ul><li><p><code><a href="../reference/hhh4_W.html">W_np()</a></code>’s argument <code>to0</code> has been renamed to <code>truncate</code>. The old name still works but is deprecated.</p></li>
<li><p><code><a href="../reference/hhh4_plot.html">plotHHH4_ri()</a></code> now uses <code>cm.colors(100)</code> as <code>col.regions</code>, and 0-centered color breaks by default.</p></li>
<li><p>The help pages of <code><a href="../reference/twinSIR.html">twinSIR()</a></code> and related functions now give examples based on <code>data("hagelloch")</code> instead of using the toy dataset <code>data("fooepidata")</code>. The latter is now obsolete and will be removed in future versions of the package.</p></li>
<li><p>The elements of the <code>control</code> list stored in the result of <code><a href="../reference/algo.farrington.html">algo.farrington()</a></code> are now consistently ordered as in the default <code>control</code> argument.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-17-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-17-0"></a></h3>
<ul><li><p>Using negative indices to exclude time points from an <code>"sts"</code> object (e.g., <code>x[-1,]</code>) is now supported and equivalent to the corresponding subset expression of retained indexes (<code>x[2:nrow(x),]</code>) in resetting the <code>start</code> and <code>epoch</code> slots. [reported by Johannes Bracher]</p></li>
<li><p>For weekly <code>"sts"</code> data with <code>epochAsDate=TRUE</code>, the <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> method computed <code>freq</code> by <code>"%Y"</code>-year instead of by <code>"%G"</code>-year, which was inconsistent with the <code>epochInPeriod</code> variable.</p></li>
<li><p>For <em>non</em>-weekly <code>"sts"</code> data with <code>epochAsDate=TRUE</code>, <code><a href="../reference/sts-class.html">year()</a></code> as well as the <code>year</code> column of the <code><a href="../reference/sts_tidy.html">tidy.sts()</a></code> output corresponded to the ISO week-based year. It now gives the calendar year.</p></li>
<li><p><code><a href="../reference/sts_creation.html">sts_creation()</a></code> hard-coded <code>start = c(2006, 1)</code>.</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate()</a></code>ing an <code>"sts"</code> object over time now recomputes fractions from the cumulated population values if and only if this is no <code>multinomialTS</code> and already contains population fractions. The same rule holds when subsetting units of an <code>"sts"</code> object. The <code>aggregate</code>-method previously failed to recompute fractions in some cases.</p></li>
<li><p>For <code><a href="../reference/farringtonFlexible.html">farringtonFlexible()</a></code> with multivariate time series, only the last unit had stored the additional control items (exceedence scores, p-values, …), all others were 0. [reported by Johannes Bracher]</p></li>
<li><p>The supplementary p-values returned by <code><a href="../reference/farringtonFlexible.html">farringtonFlexible()</a></code> in <code>control$pvalue</code> were wrong for the default approach, where <code>thresholdMethod="delta"</code> (the original Farrington method) and a power transformation was applied to the data (<code>powertrans != "none"</code>). Similarly, <code><a href="../reference/algo.farrington.html">algo.farrington()</a></code> returned wrong predictive probabilities in <code>control$pd[,1]</code> if a power transformation was used. [reported by Lore Merdrignac]</p></li>
<li><p>The <code>control</code> argument list of <code><a href="../reference/algo.farrington.html">algo.farrington()</a></code> as stated in the formal function definition was incomplete (<code>plot</code> was missing) and partially out of sync with the default values that were actually set inside the function (<code>b=5</code> and <code>alpha=0.05</code>). This has been fixed. Results of <code><a href="../reference/algo.farrington.html">algo.farrington()</a></code> would only be affected if the function was called without any <code>control</code> options (which is hardly possible). So this can be regarded as a documentation error. The formal <code>control</code> list of the <code><a href="../reference/algo.farrington.html">farrington()</a></code> wrapper function has been adjusted accordingly.</p></li>
<li><p>The <code>control</code> argument lists of <code><a href="../reference/farringtonFlexible.html">farringtonFlexible()</a></code> and <code><a href="../reference/bodaDelay.html">bodaDelay()</a></code> as stated in the formal function definitions were partially out of sync with respect to the following default values that were actually set inside these functions: <code>b=5</code> (not 3), <code>alpha=0.05</code> (not 0.01), <code>pastWeeksNotIncluded=w</code> (not 26), and, for <code><a href="../reference/bodaDelay.html">bodaDelay()</a></code> only, <code>delay=FALSE</code> (not <code>TRUE</code>). This has been fixed. Results would only be affected if the functions were called without any <code>control</code> options (which is hardly possible). So this can be regarded as a documentation error.</p></li>
<li><p><code><a href="../reference/pairedbinCUSUM.html">pairedbinCUSUM()</a></code> did not properly subset the <code>sts</code> object if a <code>range</code> was specified, and forgot to store the <code>control</code> arguments in the result.</p></li>
<li><p><code><a href="../reference/wrap.algo.html">wrap.algo()</a></code> now aborts if the monitored range is not supplied as a numeric vector.</p></li>
<li><p>In <code>vignette("monitoringCounts")</code>: several inconsistencies between code and output have been fixed.</p></li>
<li><p><code><a href="../reference/epidataCS_aggregate.html">epidataCS2sts()</a></code> no longer transfers the <code>stgrid$BLOCK</code> indices to the <code>epoch</code> slot of the resulting <code>"sts"</code> object (to avoid <code>epoch[1] != 1</code> scenarios).</p></li>
<li><p>The <code><a href="../reference/ranef.html">ranef()</a></code> matrix extracted from fitted <code>"hhh4"</code> models could have wrong column names.</p></li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-17-0">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-17-0"></a></h3>
<ul><li>Several ancient functions deprecated in 1.16.1 are now defunct: <code><a href="../reference/surveillance-defunct.html">compMatrix.writeTable()</a></code>, <code><a href="../reference/surveillance-defunct.html">makePlot()</a></code>, <code><a href="../reference/surveillance-defunct.html">test()</a></code>, <code><a href="../reference/surveillance-defunct.html">testSim()</a></code>, <code><a href="../reference/surveillance-defunct.html">readData()</a></code> (the raw txt files have been removed as well), <code><a href="../reference/surveillance-defunct.html">correct53to52()</a></code>, <code><a href="../reference/surveillance-defunct.html">enlargeData()</a></code>, <code><a href="../reference/surveillance-defunct.html">toFileDisProg()</a></code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.16.2" id="surveillance-1162-2018-07-24">surveillance 1.16.2 (2018-07-24)<a class="anchor" aria-label="anchor" href="#surveillance-1162-2018-07-24"></a></h2>
<div class="section level3">
<h3 id="minor-changes-1-16-2">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-16-2"></a></h3>
<ul><li><p><code><a href="../reference/sts_ggplot.html">autoplot.sts()</a></code> gained a <code>width</code> argument to adjust the bar width, which now defaults to 7 for weekly time series (previously was 90% of that so there were gaps between the bars).</p></li>
<li><p><code>"epidataCS"</code> generation now (again) employs <a href="https://CRAN.R-project.org/package=spatstat" class="external-link"><strong>spatstat</strong></a>’s <code>bdist.points()</code>, which has been accelerated in version 1.56-0. If you use the <code><a href="../reference/twinstim.html">twinstim()</a></code>-related modelling part of <strong>surveillance</strong>, you are thus advised to update your <strong>spatstat</strong> installation.</p></li>
<li><p>The <code><a href="../reference/boda.html">boda()</a></code> examples in <code>vignette("monitoringCounts")</code> have been updated to also work with recent versions of <strong>INLA</strong>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-16-2">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-16-2"></a></h3>
<ul><li><p>Offsets in <code>hhh4</code>’s epidemic components were ignored by <code><a href="../reference/hhh4_simulate.html">simulate.hhh4()</a></code> [spotted by Johannes Bracher] as well as in dominant eigenvalues (“maxEV”).</p></li>
<li><p>The color key in <code><a href="../reference/fanplot.html">fanplot()</a></code> is no longer distorted by <code>log="y"</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.16.1" id="surveillance-1161-2018-05-28">surveillance 1.16.1 (2018-05-28)<a class="anchor" aria-label="anchor" href="#surveillance-1161-2018-05-28"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-1-16-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-16-1"></a></h3>
<ul><li><p><code><a href="../reference/sts_ggplot.html">autoplot.sts()</a></code> now sets the calling environment as the <code>plot_env</code> of the result.</p></li>
<li><p>Several <code>twinstim</code>-related functions finally allow for prehistory events (long supported by <code><a href="../reference/twinstim.html">twinstim()</a></code> itself): <code><a href="../reference/epidataCS.html">as.epidataCS()</a></code>, <code><a href="../reference/glm_epidataCS.html">glm_epidataCS()</a></code>, <code><a href="../reference/epidataCS_aggregate.html">as.epidata.epidataCS()</a></code>.</p></li>
<li><p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> for SI[R]S-type <code>"epidata"</code> failed if there were initially infectious individuals.</p></li>
</ul></div>
<div class="section level3">
<h3 id="deprecated--defunct-1-16-1">Deprecated &amp; Defunct<a class="anchor" aria-label="anchor" href="#deprecated--defunct-1-16-1"></a></h3>
<ul><li>Several ancient functions have been deprecated and may be removed in future versions of <strong>surveillance</strong>: <code><a href="../reference/surveillance-defunct.html">qlomax()</a></code>, <code><a href="../reference/surveillance-defunct.html">readData()</a></code>, <code><a href="../reference/surveillance-defunct.html">toFileDisProg()</a></code>, <code><a href="../reference/surveillance-defunct.html">correct53to52()</a></code>, <code><a href="../reference/surveillance-defunct.html">enlargeData()</a></code>, <code><a href="../reference/surveillance-defunct.html">compMatrix.writeTable()</a></code>, <code><a href="../reference/surveillance-defunct.html">test()</a></code>, <code><a href="../reference/surveillance-defunct.html">testSim()</a></code>, <code><a href="../reference/surveillance-defunct.html">makePlot()</a></code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.16.0" id="surveillance-1160-2018-01-24">surveillance 1.16.0 (2018-01-24)<a class="anchor" aria-label="anchor" href="#surveillance-1160-2018-01-24"></a></h2>
<div class="section level3">
<h3 id="new-features-1-16-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-16-0"></a></h3>
<ul><li><p>The <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> method for <code>"sts"</code> objects gained a <code>tidy</code> argument, which enables conversion to the long data format and is also available as function <code><a href="../reference/sts_tidy.html">tidy.sts()</a></code>.</p></li>
<li><p>A <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><strong>ggplot2</strong></a> variant of <code><a href="../reference/stsplot_time.html">stsplot_time()</a></code> is now available via <code><a href="../reference/sts_ggplot.html">autoplot.sts()</a></code>.</p></li>
<li><p><code><a href="../reference/epidata.html">as.epidata.data.frame()</a></code> gained an argument <code>max.time</code> to specify the end of the observation period (which by default coincides with the last observed event).</p></li>
<li><p>The now exported function <code><a href="../reference/fanplot.html">fanplot()</a></code> wraps <a href="https://CRAN.R-project.org/package=fanplot" class="external-link"><strong>fanplot</strong></a><code>::fan()</code>. It is used by <code><a href="../reference/hhh4_validation.html">plot.oneStepAhead()</a></code> and <code><a href="../reference/hhh4_simulate_plot.html">plot.hhh4sims()</a></code>, which now have an option to add the point forecasts to the fan as well.</p></li>
<li><p><code><a href="../reference/hhh4_plot.html">plotHHH4_fitted()</a></code> (and <code><a href="../reference/hhh4_plot.html">plotHHH4_fitted1()</a></code>) gained an option <code>total</code> to sum the fitted components over all units.</p></li>
</ul></div>
<div class="section level3">
<h3 id="significant-changes-1-16-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-16-0"></a></h3>
<ul><li><p>Package <a href="https://CRAN.R-project.org/package=polyCub" class="external-link"><strong>polyCub</strong></a> is no longer automatically attached (only imported).</p></li>
<li><p><code><a href="../reference/hhh4_validation.html">scores.oneStepAhead()</a></code> no longer reverses the ordering of the time points by default, as announced in 1.15.0.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-16-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-16-0"></a></h3>
<ul><li><p>Some code in <code>vignette("monitoringCounts")</code> has been adjusted to work with the new version of <a href="https://CRAN.R-project.org/package=MGLM" class="external-link"><strong>MGLM</strong></a> (0.0.9).</p></li>
<li><p>Added a <code>[</code>-method for the <code>"hhh4sims"</code> class to retain the attributes when subsetting simulations.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-16-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-16-0"></a></h3>
<ul><li><p><code>aggregate(stsObj, by = "unit")</code> no longer results in empty colnames (set to <code>"overall"</code>). The obsolete map is dropped.</p></li>
<li>
<p>The <code>subset</code> argument of <code><a href="../reference/twinSIR.html">twinSIR()</a></code> was partially ignored:</p>
<ul><li><p>If <code>nIntervals = 1</code>, the model <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> reported the total number of events.</p></li>
<li><p>Automatic <code>knots</code>, model <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code>, as well as the rug in <code><a href="../reference/intensityplot.html">intensityplot()</a></code> were computed from the whole set of event times.</p></li>
</ul></li>
<li><p>The <code><a href="../reference/epidata.html">as.epidata.data.frame()</a></code> converter did not actually allow for latent periods (via <code>tE.col</code>). This is now possible but considered experimental (methods for <code>"epidata"</code> currently ignore latent periods).</p></li>
<li><p>The <code><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal()</a></code> methods for <code>"hhh4"</code> and <code>"twinstim"</code> objects now first check for the correct classes.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.15.0" id="surveillance-1150-2017-10-06">surveillance 1.15.0 (2017-10-06)<a class="anchor" aria-label="anchor" href="#surveillance-1150-2017-10-06"></a></h2>
<div class="section level3">
<h3 id="new-features-1-15-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-15-0"></a></h3>
<ul><li><p><code><a href="../reference/twinstim_iaf.html">siaf.gaussian()</a></code> now also employs a <code>polyCub.iso()</code> integration routine by default (similar to the powerlaw-type kernels), instead of adaptive midpoint cubature. This increases precision and considerably accelerates estimation of <code><a href="../reference/twinstim.html">twinstim()</a></code> models with a Gaussian spatial interaction function. Models fitted with the new default (<code>F.adaptive=FALSE, F.method="iso"</code>) will likely differ from previous fits (<code>F.adaptive=TRUE</code>), and the numerical difference depends on the adaptive bandwidth used before (the default <code>adapt=0.1</code> yielded a rather rough approximation of the integral).</p></li>
<li><p>Added <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code>, <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code>, and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> methods for <code>"oneStepAhead"</code> predictions.</p></li>
<li><p>Exported the function <code><a href="../reference/twinstim_simEndemicEvents.html">simEndemicEvents()</a></code> to simulate a spatio-temporal point pattern from an endemic-only <code>"twinstim"</code>; faster than via the general <code><a href="../reference/twinstim_simulation.html">simulate.twinstim()</a></code> method.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-15-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-15-0"></a></h3>
<ul><li><p><code>twinstim(..., siaf = siaf.gaussian())</code> uses a larger default initial value for the kernel’s standard deviation (based on the size of the observation region).</p></li>
<li><p>Non-default parametrizations of <code><a href="../reference/twinstim_iaf.html">siaf.gaussian()</a></code> are deprecated, i.e., always use <code>logsd=TRUE</code> and <code>density=FALSE</code>.</p></li>
<li><p><code><a href="../reference/twinstim.html">twinstim()</a></code> uses a smaller default initial value for the epidemic intercept, which usually allows for faster convergence.</p></li>
<li><p><code><a href="../reference/hhh4_update.html">update.hhh4()</a></code> now allows <code>subset.upper</code> values beyond the originally fitted time range (but still within the time range of the underlying <code>"sts"</code> object).</p></li>
<li><p><code><a href="../reference/hhh4_validation.html">scores.oneStepAhead()</a></code> by default reverses the ordering of the time points. This awkward behaviour will change in the next version, so the method now warns if the default <code>reverse=TRUE</code> is used without explicit specification.</p></li>
<li><p>Minor improvements in the documentation and some vignettes: corrected typos, simplified example code, documented some methods.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-15-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-15-0"></a></h3>
<ul><li><p>The C-routines introduced in version 1.14.0 used <code>==</code> comparisons on parameter values to choose among case-specific formulae (e.g., for <em>d==2</em> in <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw()</a></code>). We now employ an absolute tolerance of 1e-7 (which should fix the failing tests on Solaris).</p></li>
<li><p>Interaction functions for <code><a href="../reference/twinstim.html">twinstim()</a></code>, such as <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw()</a></code> or <code><a href="../reference/twinstim_iaf.html">tiaf.exponential()</a></code>, no longer live in the global environment as this risks using masked base functions.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.14.0" id="surveillance-1140-2017-06-29">surveillance 1.14.0 (2017-06-29)<a class="anchor" aria-label="anchor" href="#surveillance-1140-2017-06-29"></a></h2>
<div class="section level3">
<h3 id="documentation-1-14-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-14-0"></a></h3>
<ul><li>The replication code from Meyer et al. (2017, JSS) is now included as <code>demo("v77i11")</code>. It exemplifies the spatio-temporal endemic-epidemic modelling frameworks <code>twinstim</code>, <code>twinSIR</code>, and <code>hhh4</code> (see also the corresponding vignettes).</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-14-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-14-0"></a></h3>
<ul><li><p>Pure C-implementations of integration routines for spatial interaction functions considerably accelerate the estimation of <code><a href="../reference/twinstim.html">twinstim()</a></code> models containing <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw()</a></code>, <code><a href="../reference/twinstim_iaf.html">siaf.powerlawL()</a></code>, or <code><a href="../reference/twinstim_iaf.html">siaf.student()</a></code>.</p></li>
<li><p>The color palette generating function used by <code>sts</code> plots, <code>hcl.colors</code>, is now exported.</p></li>
<li><p>The utility function <code>clapply</code> (<em>c</em>onditional <code>lapply</code>) is now exported.</p></li>
<li><p>Some utility functions for <code>hhh4</code> fits are now exported (<code>update.hhh4</code>, <code>getNEweights</code>, <code>coefW</code>), as well as several internal functions for use by <code>hhh4</code> add-on packages (<code>meanHHH</code>, <code>sizeHHH</code>, <code>decompose.hhh4</code>).</p></li>
<li><p>The <code>"fan"</code>-type plot function for <code>"hhh4sims"</code> gained a <code>key.args</code> argument for an automatic color key.</p></li>
<li><p>New auxiliary function <code><a href="../reference/makeControl.html">makeControl()</a></code>, which may be used to specify a <code><a href="../reference/hhh4.html">hhh4()</a></code> model.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-14-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-14-0"></a></h3>
<ul><li>
<code><a href="../reference/twinstim.html">twinstim()</a></code> now throws an informative error message when trying to fit a purely epidemic model to data containing endemic events (i.e., events without ancestors). The <code><a href="../reference/twinstim.html">help("twinstim")</a></code> exemplifies such a model.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-14-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-14-0"></a></h3>
<ul><li><p><code>siaf.powerlaw()$deriv</code> returned <code>NaN</code> for the partial derivative wrt the decay parameter <em>d</em>, if <em>d</em> was large enough for <em>f</em> to be numerically equal to 0. It will now return 0 in this case.</p></li>
<li><p><code><a href="../reference/twinstim.html">twinstim()</a></code> could fail (with an error from <code>duplicated.default</code>) if the fitted time range was substantially reduced via the <code>T</code> argument.</p></li>
<li><p>The <code>"simEpidataCSlist"</code> generated by <code>simulate.twinstim(..., simplify = TRUE)</code> was missing the elements <code>bbox</code> and <code>control.siaf</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.13.1" id="surveillance-1131-2017-04-28">surveillance 1.13.1 (2017-04-28)<a class="anchor" aria-label="anchor" href="#surveillance-1131-2017-04-28"></a></h2>
<div class="section level3">
<h3 id="documentation-1-13-1">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-13-1"></a></h3>
<ul><li>The paper on “Spatio-Temporal Analysis of Epidemic Phenomena Using the R Package <strong>surveillance</strong>” (by Sebastian Meyer, Leonhard Held, and Michael Höhle) will appear in the upcoming volume of the <em>Journal of Statistical Software</em>. The main sections 3 to 5 of the paper are contained in the package as <code>vignette("twinstim")</code>, <code>vignette("twinSIR")</code>, and <code>vignette("hhh4_spacetime")</code>, respectively.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-13-1">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-13-1"></a></h3>
<ul><li><p>The <code><a href="../reference/calibration.html">calibrationTest()</a></code> and <code><a href="../reference/pit.html">pit()</a></code> methods for <code>"oneStepAhead"</code> forecasts gained an argument <code>units</code> to allow for unit-specific assessments.</p></li>
<li><p>A default <code>scores</code>-method is now available to compute a set of proper scoring rules for Poisson or NegBin predictions.</p></li>
<li><p>New plot <code>type = "fan"</code> for simulations from <code>"hhh4"</code> models to produce a fan chart using the <a href="https://CRAN.R-project.org/package=fanplot" class="external-link"><strong>fanplot</strong></a> package.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-13-1">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-13-1"></a></h3>
<ul><li>
<code><a href="../reference/hhh4_validation.html">scores.hhh4()</a></code> sets rownames for consistency with <code><a href="../reference/hhh4_validation.html">scores.oneStepAhead()</a></code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-13-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-13-1"></a></h3>
<ul><li>The <code>"Lambda.const"</code> matrix returned by <code><a href="../reference/hhh4_plot.html">getMaxEV_season()</a></code> was wrong for models with asymmetric neighbourhood weights. [spotted by Johannes Bracher]<br>
Dominant eigenvalues (<code>"maxEV"</code>) were not affected by this bug.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.13.0" id="surveillance-1130-2016-12-20">surveillance 1.13.0 (2016-12-20)<a class="anchor" aria-label="anchor" href="#surveillance-1130-2016-12-20"></a></h2>
<div class="section level3">
<h3 id="new-features-1-13-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-13-0"></a></h3>
<ul><li><p><code>earsC</code> now has two new arguments thanks to Howard Burkom: the number of past time units to be used in calculation is now not always 7, it can be chosen in the <code>baseline</code> parameter. Furthermore, the <code>minSigma</code> parameter allows to get a threshold in the case of sparse data. When one doesn’t give any value for those two parameters, the algorithm works like it used to.</p></li>
<li><p><code><a href="../reference/sts_animate.html">animate.sts()</a></code> gained support for date labels in the bottom <code>timeplot</code>.</p></li>
<li><p><code><a href="../reference/stsplot_space.html">stsplot_space()</a></code> and <code><a href="../reference/sts_animate.html">animate.sts()</a></code> can now generate incidence maps based on the population information stored in the supplied <code>"sts"</code> object. Furthermore, <code><a href="../reference/sts_animate.html">animate.sts()</a></code> now supports time-varying population numbers.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-13-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-13-0"></a></h3>
<ul><li>
<code><a href="../reference/hhh4.html">hhh4()</a></code> guards against the misuse of <code>family = factor("Poisson")</code> for univariate time series. Previously, this resulted in a negative binomial model by definition, but is now interpreted as <code>family = "Poisson"</code> (with a warning).</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-13-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-13-0"></a></h3>
<ul><li><p><code><a href="../reference/sts_animate.html">animate.sts()</a></code> now supports objects with missing values (with a warning). Furthermore, the automatic color breaks have been improved for incidence maps, also in <code><a href="../reference/stsplot_space.html">stsplot_space()</a></code>.</p></li>
<li><p>The <code>as.data.frame</code>-method for the <code>"sts"</code> class, applied to classical time-index-based <code>"sts"</code> objects (<code>epochAsDate=FALSE</code>), ignored a <code>start</code> epoch different from 1 when computing the <code>epochInPeriod</code> indexes. Furthermore, the returned <code>epochInPeriod</code> now is a fraction of <code>freq</code>, for consistency with the result for objects with <code>epochAsDate=TRUE</code>.</p></li>
<li><p><code><a href="../reference/hhh4_simulate.html">simulate.hhh4()</a></code> did not handle shared overdispersion parameters correctly. The different parameters were simply recycled to the number of units, ignoring the factor specification from the model’s <code>family</code>. [spotted by Johannes Bracher]</p></li>
<li><p>Simulations from <em>endemic-only</em> <code>"hhh4"</code> models with unit-specific overdispersion parameters used wrong variances. [spotted by Johannes Bracher]</p></li>
<li><p><code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> predictions of <code>type</code> <code>"rolling"</code> (or <code>"first"</code>) were incorrect for time points <code>tp</code> (<code>tp[1]</code>) beyond the originally fitted time range (in that they were based on the original time range only). This usage of <code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> was never really supported and is now caught when checking the <code>tp</code> argument.</p></li>
<li><p><code><a href="../reference/hhh4_simulate_plot.html">plot.hhh4simslist()</a></code> ignored its <code>par.settings</code> argument if <code>groups=NULL</code> (default).</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.12.2" id="surveillance-1122-2016-11-14">surveillance 1.12.2 (2016-11-14)<a class="anchor" aria-label="anchor" href="#surveillance-1122-2016-11-14"></a></h2>
<div class="section level3">
<h3 id="new-features-1-12-2">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-12-2"></a></h3>
<ul><li><p>The internal auxiliary function, which determines the sets of potential source events in <code>"epidataCS"</code> has been implemented in C++, which accelerates <code><a href="../reference/epidataCS.html">as.epidataCS()</a></code>, <code><a href="../reference/epidataCS_permute.html">permute.epidataCS()</a></code>, and therefore <code><a href="../reference/twinstim_epitest.html">epitest()</a></code>. This is only really relevant for <code>"epidataCS"</code> with a large number of events (&gt;1000, say).</p></li>
<li><p>Negative-binomial <code><a href="../reference/hhh4.html">hhh4()</a></code> models may not converge for non-overdispersed data (try, e.g., <code>set.seed(1); hhh4(sts(rpois(104, 10)), list(family="NegBin1"))</code>). The resulting non-convergence warning message now mentions low overdispersion if this is detected. [suggested by Johannes Bracher]</p></li>
<li><p>An additional <code>type="delay"</code> option was added to the <code>plot</code> method of <code>stsNC</code> objects. Furthermore, an <code>animate_nowcasts</code> function allows one to animate a sequence of nowcasts.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-12-2">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-12-2"></a></h3>
<ul><li>In the <code>animate</code>-method for <code>"sts"</code> objects, the default top padding of <strong>lattice</strong> plots is now disabled for the bottom <code>timeplot</code> to reduce the space between the panels. Furthermore, the new option <code>fill</code> can be used to make the panel of the <code>timeplot</code> as large as possible.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-12-2">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-12-2"></a></h3>
<ul><li><p><code><a href="../reference/bodaDelay.html">bodaDelay()</a></code>: fixed spurious warnings from <code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom()</a></code>.</p></li>
<li><p><code>vignette("monitoringCounts")</code>: fixed <code>boda</code>-related code and cache to obtain same results as in corresponding JSS paper.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.12.1" id="surveillance-1121-2016-05-18">surveillance 1.12.1 (2016-05-18)<a class="anchor" aria-label="anchor" href="#surveillance-1121-2016-05-18"></a></h2>
<div class="section level3">
<h3 id="documentation-1-12-1">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-12-1"></a></h3>
<ul><li>The new <code>vignette("monitoringCounts")</code> illustrates the monitoring of count time series in R with a particular focus on aberration detection in public health surveillance. This vignette corresponds to a recently accepted manuscript for the <em>Journal of Statistical Software</em> (Salmon, Schumacher, and Höhle, 2016).</li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-12-1">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-12-1"></a></h3>
<ul><li><p>Non-convergent <code><a href="../reference/hhh4.html">hhh4()</a></code> fits now obey the structure of standard <code>"hhh4"</code> objects. In particular, such fits now also contain the <code>control</code> and <code>stsObj</code> elements, allowing for model <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>s of non-convergent fits.</p></li>
<li><p><code><a href="../reference/knox.html">knox()</a></code> warns about symmetric input matrices.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-12-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-12-1"></a></h3>
<ul><li><p>The code of <code><a href="../reference/boda.html">boda()</a></code> (with <code>samplingMethod="joint"</code>) and <code><a href="../reference/bodaDelay.html">bodaDelay()</a></code> (with <code>inferenceMethod="INLA"</code>) has been adjusted to a change of arguments of <strong>INLA</strong>’s <code>inla.posterior.sample</code> function. Accordingly, the minimum <strong>INLA</strong> version required to run <code><a href="../reference/boda.html">boda()</a></code> and <code><a href="../reference/bodaDelay.html">bodaDelay()</a></code> is 0.0-1458166556.</p></li>
<li><p>The functions returned by <code><a href="../reference/hhh4_W.html">W_powerlaw()</a></code> now have the package namespace as their environment to support situations where the package is not attached.</p></li>
<li><p>Attaching package <a href="https://CRAN.R-project.org/package=nlme" class="external-link"><strong>nlme</strong></a> after <strong>surveillance</strong> no longer masks <code>"hhh4"</code>’s <code>ranef</code>-method. (We now import the <code>fixef</code> and <code>ranef</code> generics from <strong>nlme</strong>.)</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.12.0" id="surveillance-1120-2016-04-02">surveillance 1.12.0 (2016-04-02)<a class="anchor" aria-label="anchor" href="#surveillance-1120-2016-04-02"></a></h2>
<div class="section level3">
<h3 id="documentation-1-12-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-12-0"></a></h3>
<ul><li>
<p>Several new vignettes illustrate <em>endemic-epidemic</em> modeling frameworks for spatio-temporal surveillance data:</p>
<dl><dt><code>vignette("twinstim")</code></dt>
<dd>
<p>describes a spatio-temporal point process regression model.</p>
</dd>
<dt><code>vignette("twinSIR")</code></dt>
<dd>
<p>describes a multivariate temporal point process regression model.</p>
</dd>
<dt><code>vignette("hhh4_spacetime")</code></dt>
<dd>
<p>describes an areal time-series model for infectious disease counts.</p>
</dd>
</dl><p>These vignettes are based on a recently accepted manuscript for the <em>Journal of Statistical Software</em> (Meyer, Held, and Höhle, 2016).</p>
</li>
<li><p>Improved the documentation on various help pages.</p></li>
<li><p>The <code><a href="../reference/hhh4.html">hhh4()</a></code>-based analysis of <code>data("fluBYBW")</code> has been moved to a separate demo script ‘fluBYBW.R’. Due to the abundance of models and the relatively long runtime, we recommend to open the script in an editor rather than running all the code at once using <code>demo("fluBYBW")</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-12-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-12-0"></a></h3>
<ul><li><p>Overhaul of the <code>"sts"</code> implementation. This mostly affects package-internal code, which is simpler, cleaner and better tested now, but requires R &gt;= 3.2.0 (due to <code>callNextMethod()</code> bugs in older versions of R). Beyond that, the user-level constructor function <code><a href="../reference/sts-class.html">sts()</a></code> now has explicit arguments for clarity and convenience. For instance, its first argument sets the <code>observed</code> slot and no longer needs to be named, i.e., <code>sts(mycounts, start=c(2016,3), frequency=12)</code> works just like for the classical <code><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts()</a></code> function.</p></li>
<li><p><code>stsplot_time(..., as.one=TRUE)</code> is now implemented (yielding a simple <code>matplot</code> of multiple time series).</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-12-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-12-0"></a></h3>
<ul><li><p><code><a href="../reference/hhh4_plot.html">plotHHH4_season()</a></code> now by default draws a horizontal reference line at unity if the multiplicative effect of component seasonality is shown (i.e., if <code>intercept=FALSE</code>).</p></li>
<li><p>Since <strong>surveillance</strong> 1.8-0, <code><a href="../reference/hhh4.html">hhh4()</a></code> results are of class <code>"hhh4"</code> instead of <code>"ah4"</code> (renamed). Legacy methods for the old class name <code>"ah4"</code> have been removed.</p></li>
<li><p>The internal model preparation in <code><a href="../reference/twinstim.html">twinstim()</a></code> is more efficient (the distance matrix of the events is only computed if event sources actually need to be updated).</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-12-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-12-0"></a></h3>
<ul><li><p><code>stsplot_spacetime()</code> now recognizes its <code>opts.col</code> argument.</p></li>
<li><p>Conversion from <code>"ts"</code> to <code>"sts"</code> using <code>as(ts, "sts")</code> could set a wrong start time. For instance, <code>as(ts(1:10, start=c(1959,2), frequency=4), "sts")@start</code> was <code>c(1959,1)</code>.</p></li>
<li><p><code><a href="../reference/surveillance-defunct.html">algo.twins()</a></code> now also accepts <code>"sts"</code> input and the automatic legend in the first plot of <code><a href="../reference/surveillance-defunct.html">plot.atwins()</a></code> works again.</p></li>
<li><p>The experimental <code>profile</code>-method for <code>"twinstim"</code> objects did not work if embedded <code><a href="../reference/twinstim.html">twinstim()</a></code> fits issued warnings.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.11.0" id="surveillance-1110-2016-02-08">surveillance 1.11.0 (2016-02-08)<a class="anchor" aria-label="anchor" href="#surveillance-1110-2016-02-08"></a></h2>
<div class="section level3">
<h3 id="new-features-1-11-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-11-0"></a></h3>
<ul><li><p><code><a href="../reference/epidata.html">update.epidata()</a></code> can now handle a distance matrix <code>D</code> in the form of a classed <code>"Matrix"</code>. [suggested by George Wood]</p></li>
<li><p><code><a href="../reference/wrap.algo.html">glrnb()</a></code> can now handle <code>ret="cases"</code> for the generalized likelihood ratio detector based on the negative binomial distribution. It’s based on a brute-force search and hence might be slow in some situations.</p></li>
<li><p><code><a href="../reference/boda.html">boda()</a></code> and <code><a href="../reference/bodaDelay.html">bodaDelay()</a></code> now support an alternative method (<code>quantileMethod="MM"</code>) to compute quantiles based on the posterior distribution. The new method samples parameters from the posterior distribution and then computes the quantile of the mixture distribution using bisectionning, which is faster and yields similar results compared to the original method (<code>quantileMethod="MC"</code>, still the default).</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-11-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-11-0"></a></h3>
<ul><li>Revised <code>vignette("hhh4")</code>, updated the package description as well as some references in the documentation. Also updated (the cache of) the slightly outdated <code>vignette("surveillance")</code> to account for the corrected version of <code><a href="../reference/algo.bayes.html">algo.bayes()</a></code> implemented since <strong>surveillance</strong> 1.10-0.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-11-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-11-0"></a></h3>
<ul><li><p>Fixed bug in <code><a href="../reference/categoricalCUSUM.html">categoricalCUSUM()</a></code>, which ignored alarms generated for the last time point in <code>range</code>. Furthermore, the exact computation in case of returns of the type <code>"value"</code> for the binomial are now checked through an attribute.</p></li>
<li><p>Fixed bug in the <code>estimateGLRNbHook</code> function of <code>algo.glrnb</code>, which ignored potential fixed <code>alpha</code> values. If <code>alpha</code> is fixed this is now taken into consideration while fitting the negative binomial function. See revised help files for the details.</p></li>
<li><p>Made a hot-fix such that the <code>algo.quality</code> function now also works for <code>sts</code> objects and if the <code>state</code> or <code>alarm</code> slots consists of TRUE/FALSE instead of 0/1.</p></li>
<li><p><code><a href="../reference/twinstim_intensity.html">intensity.twinstim()</a></code> did not work for non-endemic models.</p></li>
<li><p>A parallelized <code><a href="../reference/twinstim_epitest.html">epitest()</a></code> could fail with a strange error message if some replications were left unassigned. This seems to happen if forking is used (<code>mclapply</code>) with insufficient memory. Incomplete replications are now ignored with a warning.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.10-0" id="surveillance-110-0-2015-11-04">surveillance 1.10-0 (2015-11-04)<a class="anchor" aria-label="anchor" href="#surveillance-110-0-2015-11-04"></a></h2>
<p>This package is now maintained by Sebastian Meyer, who has been an active co-author since version 1.3. We thank Michael Höhle for 10 years of maintenance ever since he created <strong>surveillance</strong> and published the package on CRAN in November 2005 for R 2.2.0.</p>
<div class="section level3">
<h3 id="new-features-1-10-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-10-0"></a></h3>
<ul><li><p>Calibration tests for count data (Wei and Held, 2014, Test) are now implemented and available as <code><a href="../reference/calibration.html">calibrationTest()</a></code>. In addition to a default method taking pure counts and predictive means and dispersion parameters, there are convenient methods for <code>"hhh4"</code> and <code>"oneStepAhead"</code> objects.</p></li>
<li><p>Shared overdispersion across units in negative binomial <code><a href="../reference/hhh4.html">hhh4()</a></code> time series models (by specifying a factor variable as the <code>family</code> argument).</p></li>
<li><p><code><a href="../reference/scores.html">scores()</a></code> and <code><a href="../reference/pit.html">pit()</a></code> are now generic and have convenient methods for <code>"oneStepAhead"</code> predictions and <code>"hhh4"</code> fits.</p></li>
<li><p>The initial values used for model updates during the <code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> procedure can now be specified directly through the <code>which.start</code> argument (as an alternative to the previous options <code>"current"</code> and <code>"final"</code>).</p></li>
<li><p><code><a href="../reference/hhh4_plot.html">plotHHH4_fitted()</a></code> (and <code><a href="../reference/hhh4_plot.html">plotHHH4_fitted1()</a></code>) gained an option <code>decompose</code> to plot the contributions from each single unit (and the endemic part) instead of the default endemic + AR + neighbours decomposition. Furthermore, a formatted time axis similar to <code><a href="../reference/stsplot_time.html">stsplot_time1()</a></code> can now be enabled via the new argument <code>xaxis</code>.</p></li>
<li><p>The new <code>plot</code> <code>type</code> <code>"maps"</code> for <code>"hhh4"</code> fits shows maps of the fitted mean components averaged over time.</p></li>
<li><p>New <code>plot</code>-method for simulations from <code>"hhh4"</code> models (using <code>simulate.hhh4(..., simplify = TRUE)</code>, which now has a dedicated class: <code>"hhh4sims"</code>) to show the final size distribution or the simulated time series (possibly stratified by groups of units). There is also a new <code>scores</code>-method to compute proper scoring rules based on such simulations.</p></li>
<li><p>The argument <code>idx2Exp</code> of <code><a href="../reference/hhh4_methods.html">coef.hhh4()</a></code> may now be conveniently set to <code>TRUE</code> to exp-transform all coefficients.</p></li>
<li><p>Added a <code><a href="../reference/coeflist.html">coeflist()</a></code>-method for <code>"hhh4"</code> fits.</p></li>
<li><p>The generator function <code><a href="../reference/sts-class.html">sts()</a></code> can now be used to initialize objects of class <code>"sts"</code> (instead of writing <code>new("sts", ...)</code>).</p></li>
<li><p>Additional arguments of <code><a href="../reference/layout.labels.html">layout.scalebar()</a></code> now allow to change the style of the labels.</p></li>
<li><p>A pre-computed distance matrix <code>D</code> can now be used as input for the <code><a href="../reference/epidata.html">as.epidata()</a></code> converter – offering an alternative to the default Euclidean distance based on the individuals coordinates. (Request of George Wood to support <code>twinSIR</code> models on networks.)</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-10-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-10-0"></a></h3>
<ul><li><p>The first argument of <code><a href="../reference/scores.html">scores()</a></code> is now called <code>x</code> instead of <code>object</code> (for consistency with <code><a href="../reference/calibration.html">calibrationTest()</a></code>).</p></li>
<li><p>The result of <code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> now has the dedicated class attribute <code>"oneStepAhead"</code> (previously was just a list).</p></li>
<li><p>Changed interpretation of the <code>col</code> argument of <code><a href="../reference/hhh4_plot.html">plotHHH4_fitted()</a></code> and <code><a href="../reference/hhh4_plot.html">plotHHH4_fitted1()</a></code> (moved color of “observed” to separate argument <code>pt.col</code> and reversed remaining colors). The old <code>col</code> specification as a vector of length 4 still works (caught internally) but is undocumented.</p></li>
<li><p>The <code>epoch</code> slot of class <code>"sts"</code> is now initialized to <code>1:nrow(observed)</code> by default and thus no longer needs to be explicitly set when creating a <code>new("sts", ...)</code> for this standard case.</p></li>
<li><p>Initialization of <code>new("sts", ...)</code> now supports the argument <code>frequency</code> (for consistency with <code><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts()</a></code>). Note that <code>freq</code> still works (via partial argument matching) and that the corresponding <code>"sts"</code> slot is still called <code>freq</code>.</p></li>
<li><p>If <code>missing(legend.opts)</code> in <code><a href="../reference/stsplot_time.html">stsplot_time1()</a></code>, the default legend will only be produced if the <code>"sts"</code> object contains information on outbreaks, alarms, or upperbounds.</p></li>
<li><p>The default <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> of a <code>"twinstim"</code> fit is more concise since it no longer includes the number of log-likelihood and score function evaluations and the elapsed time during model fitting. Set the new <code>runtime</code> argument of <code><a href="../reference/twinstim_methods.html">summary.twinstim()</a></code> to <code>TRUE</code> to add this information to the summary as before.</p></li>
<li><p>The <code>animate</code>-method for <code>"sts"</code> objects gained an argument <code>draw</code> (to disable the default instantaneous plotting) and now invisibly returns the sequential plot objects (of class <code>"gtable"</code> or <code>"trellis"</code>) in a list for post-processing.</p></li>
<li><p>The flexible time axis configurations for <code>"sts"</code> plots introduced in version 1.8-0 now also work for classical <code>"sts"</code> objects with integer epochs and standard frequencies (try <code>plot(..., epochsAsDate = TRUE)</code>).</p></li>
<li><p><code><a href="../reference/stsplot_time.html">stsplot_time()</a></code> initiates <code>par</code> settings only if the <code>par.list</code> argument is a list.</p></li>
<li><p>The new <code><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal()</a></code> method for class <code>"hhh4"</code> compares two fits ignoring their <code>"runtime"</code> and <code>"call"</code> elements (at least).</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-10-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-10-0"></a></h3>
<ul><li><p>Fixed a bug in <code>algo.bayes</code>, where an alarm was already sounded if the current observation was equal to the quantile of the predictive posterior. This was changed in order to get <em>alarm_t = I(obs_t &gt; quantile_t)</em> which is consistent with the use in <code>boda</code> and <code>bodaDelay</code>.</p></li>
<li><p>Fixed bug in <code>algo.outbreakP</code> causing a halt in the computations of <code>value="cases"</code> when <code>calc.outbreakP.statistic</code> returned <code>NaN</code>. Now, a <code>NaN</code> is returned.</p></li>
<li><p><code>wrap.algo</code> argument <code>control.hook</code> used <code>control</code> argument defined outside it’s scope (and not the one provided to the function). It is now added as additional 2nd argument to the <code>control.hook</code> function.</p></li>
<li><p><code><a href="../reference/stsplot_time.html">stsplot_time()</a></code> did not account for the optional <code>units</code> argument for multivariate <code>"sts"</code> objects when choosing a suitable value for <code>par("mfrow")</code>.</p></li>
<li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> could have used a function <code><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois()</a></code> or <code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom()</a></code> from the global environment instead of the respective function from package <strong>stats</strong>.</p></li>
<li><p>The default time variable <code>t</code> created as part of the <code>data</code> argument in <code><a href="../reference/hhh4.html">hhh4()</a></code> was incompatible with <code>"sts"</code> objects having <code>epochAsDate=TRUE</code>.</p></li>
<li><p>A consistency check in <code><a href="../reference/epidata.html">as.epidata.default()</a></code> failed for SI-type data (and, more generally, for all data which ended with an I-event in the last time block). [spotted by George Wood]</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.9-1" id="surveillance-19-1-2015-06-12">surveillance 1.9-1 (2015-06-12)<a class="anchor" aria-label="anchor" href="#surveillance-19-1-2015-06-12"></a></h2>
<ul><li><p>This is a quick patch release to make the test suite run smoothly on CRAN’s Windows and Solaris Sparc systems.</p></li>
<li><p>The new <code><a href="../reference/hhh4.html">hhh4()</a></code> option to scale neighbourhood weights did not work for parametric weights with more than one parameter if <code>normalize=FALSE</code>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.9-0" id="surveillance-19-0-2015-06-09">surveillance 1.9-0 (2015-06-09)<a class="anchor" aria-label="anchor" href="#surveillance-19-0-2015-06-09"></a></h2>
<div class="section level3">
<h3 id="new-features-1-9-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-9-0"></a></h3>
<ul><li><p>New functions and data for Bayesian outbreak detection in the presence of reporting delays (Salmon et al., 2015): <code><a href="../reference/bodaDelay.html">bodaDelay()</a></code>, <code><a href="../reference/sts_observation.html">sts_observation()</a></code>, and <code><a href="../reference/sts_creation.html">sts_creation()</a></code>.</p></li>
<li>
<p>New functions implementing tests for space-time interaction:</p>
<ul><li><p><code><a href="../reference/knox.html">knox()</a></code> supports both the Poisson approximation and a Monte Carlo permutation approach to determine the p-value,</p></li>
<li><p><code><a href="../reference/stK.html">stKtest()</a></code> wraps space-time K-function methods from package <a href="https://CRAN.R-project.org/package=splancs" class="external-link"><strong>splancs</strong></a> for use with <code>"epidataCS"</code>,</p></li>
<li><p>and <code><a href="../reference/twinstim_epitest.html">epitest()</a></code> for <code>twinstim</code> models (makes use of the new auxiliary function <code><a href="../reference/R0.html">simpleR0()</a></code>).</p></li>
</ul></li>
<li><p>New function <code><a href="../reference/plapply.html">plapply()</a></code>: a parallel and verbose version of <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> wrapping around both <code>mclapply()</code> and <code>parLapply()</code> of package <strong>parallel</strong>.</p></li>
<li><p>New converter <code><a href="../reference/sts-class.html">as.xts.sts()</a></code> to transform <code>"sts"</code> objects to the quasi standard <code>"xts"</code> class, e.g., to make use of package <a href="https://CRAN.R-project.org/package=dygraphs" class="external-link"><strong>dygraphs</strong></a> for interactive time series plots.</p></li>
<li><p>New options for scaling and normalization of neighbourhood weights in <code><a href="../reference/hhh4.html">hhh4()</a></code> models.</p></li>
<li><p>New auxiliary function <code><a href="../reference/layout.labels.html">layout.scalebar()</a></code> for use as part of <code>sp.layout</code> in <code><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">sp::spplot()</a></code> or in the traditional graphics system.</p></li>
</ul><div class="section level4">
<h4 id="new-features-for-epidatacs-1-9-0">New features for <code>"epidataCS"</code>
<a class="anchor" aria-label="anchor" href="#new-features-for-epidatacs-1-9-0"></a></h4>
<ul><li><p>New argument <code>by</code> for <code><a href="../reference/epidataCS_plot.html">plot.epidataCS()</a></code>, which defines a stratifying variable for the events (default is the event type as before). It can also be set to <code>NULL</code> to make the plot not distinguish between event types.</p></li>
<li><p>The spatial plot of <code>"epidataCS"</code> gained the arguments <code>tiles</code>, <code>pop</code> and <code>sp.layout</code>, and can now produce an <code><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">sp::spplot()</a></code> with the tile-specific population levels behind the point pattern.</p></li>
<li><p>New function <code><a href="../reference/epidataCS_permute.html">permute.epidataCS()</a></code> to randomly permute time points or locations of the events (holding other marks fixed).</p></li>
</ul></div>
<div class="section level4">
<h4 id="new-features-for-twinstim-1-9-0">New features for <code>twinstim()</code>
<a class="anchor" aria-label="anchor" href="#new-features-for-twinstim-1-9-0"></a></h4>
<ul><li><p>New S3-generic <code><a href="../reference/coeflist.html">coeflist()</a></code> to list model coefficients by component. It currently has a default method and one for <code>"twinstim"</code> and <code>"simEpidataCS"</code>.</p></li>
<li><p>New argument <code>newcoef</code> for <code><a href="../reference/twinstim_simulation.html">simulate.twinstim()</a></code> to customize the model parameters used for the simulation.</p></li>
<li><p>New argument <code>epilink</code> for <code><a href="../reference/twinstim.html">twinstim()</a></code>, offering experimental support for an identity link for the epidemic predictor. The default remains <code>epilink = "log"</code>.</p></li>
<li><p>Simulation from <code>"twinstim"</code> models and generation of <code>"epidataCS"</code> is slightly faster now (faster <strong>spatstat</strong> functions are used to determine the distance of events to the border).</p></li>
<li><p>New option <code>scaled = "standardized"</code> in <code><a href="../reference/twinstim_iafplot.html">iafplot()</a></code> to plot <em>f(x) / f(0)</em> or <em>g(t) / g(0)</em>, respectively.</p></li>
</ul></div>
</div>
<div class="section level3">
<h3 id="minor-changes-1-9-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-9-0"></a></h3>
<ul><li><p>Initial data processing in <code><a href="../reference/twinstim.html">twinstim()</a></code> is faster since event sources are only re-determined if there is effective need for an update (due to subsetting or a change of <code>qmatrix</code>).</p></li>
<li><p><code><a href="../reference/formatPval.html">formatPval()</a></code> disables <code>scientific</code> notation by default.</p></li>
<li><p>The <code>"time"</code> plot for <code>"epidataCS"</code> uses the temporal grid points as the default histogram <code>breaks</code>.</p></li>
<li><p>The special <code><a href="../reference/hhh4_formula.html">fe()</a></code> function which sets up fixed effects in <code><a href="../reference/hhh4.html">hhh4()</a></code> models gained an argument <code>unitSpecific</code> as a convenient shortcut for <code>which = rep(TRUE, nUnits)</code>.</p></li>
<li><p>The convenient <code>plot</code> option of <code><a href="../reference/permutationTest.html">permutationTest()</a></code> uses <a href="https://CRAN.R-project.org/package=MASS" class="external-link"><strong>MASS</strong></a>::<code>truehist()</code> instead of <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code> and accepts graphical parameters to customize the histogram.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-9-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-9-0"></a></h3>
<ul><li><p>The <code>bodaFit</code> function did not draw samples from the joint posterior. Instead draws were from the respective posterior marginals. A new argument <code>samplingMethod</code> is now introduced defaulting to the proper ‘joint’. For backwards compatibility use the value ‘marginal’.</p></li>
<li><p>The functions <code><a href="../reference/epidataCS.html">as.epidataCS()</a></code> and <code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> could throw inappropriate warnings when checking polygon areas (only if <code>W</code> or <code>tiles</code>, respectively, contained holes).</p></li>
<li><p>Non-convergent endemic-only <code>twinstim</code> models produced an error. [spotted by Bing Zhang]</p></li>
<li><p>The <code>"owin"</code>-method of <code>intersectPolyCircle</code> could have returned a rectangle-type <code>"owin"</code> instead of a polygon.</p></li>
<li><p>An error occurred in <code><a href="../reference/twinstim.html">twinstim()</a></code> if <code>finetune=TRUE</code> or choosing <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> instead of the default <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb()</a></code> optimizer without supplying a <code>control</code> list in <code>optim.args</code>.</p></li>
<li><p>The <code>"time"</code> plot for <code>"epidataCS"</code> did not necessarily use the same histogram <code>breaks</code> for all strata.</p></li>
<li><p>Specifying a step function of interaction via a numeric vector of knots did not work in <code><a href="../reference/twinstim.html">twinstim()</a></code>.</p></li>
<li><p><code><a href="../reference/hhh4_plot.html">plot.hhh4()</a></code> did not support an unnamed <code>type</code> argument such as <code>plot(x, "season")</code>.</p></li>
<li><p><code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> did not work if <code>t0</code> was in the last block of <code>stgrid</code> (thus it did not work for single-cell grids), and mislabeled the <code>start</code> column copied to <code>events</code> if there were no covariates in <code>stgrid</code>.</p></li>
<li><p>Evaluating <code>intensity.twinstim()$hFUN()</code> at time points before <code>t0</code> was an error. The function now returns <code>NA_real_</code> as for time points beyond <code>T</code>.</p></li>
<li><p>Truncated, normalized power-law weights for <code><a href="../reference/hhh4.html">hhh4()</a></code> models, i.e., <code>W_powerlaw(maxlag = M, normalize = TRUE)</code> with <code>M &lt; max(neighbourhood(stsObj))</code>, had wrong derivatives and thus failed to converge.</p></li>
<li><p><code>update.hhh4(..., use.estimates = TRUE)</code> did not use the estimated weight function parameters as initial values for the new fit. It does so now iff the weight function <code>ne$weights</code> is left unchanged.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.8-3" id="surveillance-18-3-2015-01-05">surveillance 1.8-3 (2015-01-05)<a class="anchor" aria-label="anchor" href="#surveillance-18-3-2015-01-05"></a></h2>
<ul><li><p>Accommodate a new note given by R-devel checks, and set the new INLA additional repository in the ‘DESCRIPTION’ file.</p></li>
<li><p>Made <code><a href="../reference/linelist2sts.html">linelist2sts()</a></code> work for quarters by adding extra <code>"%q"</code> formatting in <code><a href="../reference/formatDate.html">formatDate()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.8-2" id="surveillance-18-2-2014-12-16">surveillance 1.8-2 (2014-12-16)<a class="anchor" aria-label="anchor" href="#surveillance-18-2-2014-12-16"></a></h2>
<div class="section level3">
<h3 id="minor-changes-for-hhh4-1-8-2">Minor Changes for <code>hhh4()</code>
<a class="anchor" aria-label="anchor" href="#minor-changes-for-hhh4-1-8-2"></a></h3>
<ul><li><p>In the coefficient vector resulting from a <code>hhh4</code> fit, random intercepts are now named.</p></li>
<li><p>Parameter <code>start</code> values in <code><a href="../reference/hhh4.html">hhh4()</a></code> are now matched by name but need not be complete in that case (default initial values are used for unspecified parameters).</p></li>
<li><p>The <code><a href="../reference/hhh4_update.html">update.hhh4()</a></code>-method now by default does <code>use.estimates</code> from the previous fit. This reduces the number of iterations during model fitting but may lead to slightly different parameter estimates (within a tolerance of <code>1e-5</code>). Setting <code>use.estimates = FALSE</code> means to re-use the previous start specification.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-for-the-sts-class-1-8-2">Minor Changes for the <code>"sts"</code> Class<a class="anchor" aria-label="anchor" href="#minor-changes-for-the-sts-class-1-8-2"></a></h3>
<ul><li><p>For univariate <code>"sts"</code> objects, the (meaningless) “head of neighbourhood” is no longer <code>show</code>n.</p></li>
<li><p>The <code>"sts"</code> class now has a <code>dimnames</code>-method instead of a <code>colnames</code>-method. Furthermore, the redundant <code>nrow</code> and <code>ncol</code> methods have been removed (the <code>dim</code>-method is sufficient).</p></li>
<li><p>If a <code>map</code> is provided when <code>initialize()</code>ing an <code>"sts"</code> object, it is now verified that all <code>observed</code> regions are part of the <code>map</code> (matched by <code>row.names</code>).</p></li>
<li><p>In <code><a href="../reference/stsplot_space.html">stsplot_space()</a></code>, extra (unobserved) regions of the <code>map</code> are no longer dropped but shown with a dashed border by default.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.8-1" id="surveillance-18-1-2014-10-29">surveillance 1.8-1 (2014-10-29)<a class="anchor" aria-label="anchor" href="#surveillance-18-1-2014-10-29"></a></h2>
<div class="section level3">
<h3 id="new-features-1-8-1">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-8-1"></a></h3>
<ul><li><p>The <code>R0</code>-method for <code>"twinstim"</code> gained an argument <code>newcoef</code> to simplify computation of reproduction numbers with a different parameter vector (also used for Monte Carlo CI’s).</p></li>
<li><p>New plot <code>type="neweights"</code> for <code>"hhh4"</code> fits.</p></li>
<li><p>The <code><a href="../reference/scores.html">scores()</a></code> function allows the selection of multiple <code>units</code> (by index or name) for which to compute (averaged) proper scores. Furthermore, one can now select <code>which</code> scores to compute.</p></li>
<li><p>Added a <code>formula</code>-method for <code>"hhh4"</code> fits to extract the <code>f</code> specifications of the three components from the control list.</p></li>
<li><p>The <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>-method for fitted <code>"hhh4"</code> models gained an argument <code>S</code> for convenient modification of component seasonality using <code><a href="../reference/addSeason2formula.html">addSeason2formula()</a></code>.</p></li>
<li><p>The new auxiliary function <code><a href="../reference/layout.labels.html">layout.labels()</a></code> generates an <code>sp.layout</code> item for <code><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">sp::spplot()</a></code> in order to draw labels.</p></li>
<li><p>When generating the <code><a href="../reference/pit.html">pit()</a></code> histogram with a single predictive CDF <code>pdistr</code>, the <code>...</code> arguments can now be <code>x</code>-specific and are recycled if necessary using <code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>. If <code>pdistr</code> is a list of CDFs, <code><a href="../reference/pit.html">pit()</a></code> no longer requires the functions to be vectorized.</p></li>
<li><p>New method <code><a href="../reference/epidata.html">as.epidata.data.frame()</a></code>, which constructs the start/stop SIR event history format from a simple individual-based data frame (e.g., <code>hagelloch.df</code>).</p></li>
<li><p>New argument <code>w</code> in <code><a href="../reference/epidata.html">as.epidata.default()</a></code> to generate covariate-based weights for the force of infection in <code>twinSIR</code>. The <code>f</code> argument is for distance-based weights.</p></li>
<li><p>The result of <code><a href="../reference/twinSIR_profile.html">profile.twinSIR()</a></code> gained a class and an associated <code>plot</code>-method.</p></li>
</ul></div>
<div class="section level3">
<h3 id="significant-changes-1-8-1">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-8-1"></a></h3>
<ul><li><p>For multivariate <code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> predictions, <code>scores(..., individual=TRUE)</code> now returns a 3d array instead of a collapsed matrix. Furthermore, the scores computed by default are <code>c("logs","rps","dss","ses")</code>, excluding the normalized squared error score <code>"nses"</code> which is improper.</p></li>
<li><p>The plot-<code>type="season"</code> for <code>"hhh4"</code> fits now by default plots the multiplicative effect of seasonality on the respective component (new argument <code>intercept=FALSE</code>). The default set of components to plot has also changed.</p></li>
<li><p>When <code><a href="../reference/epidata.html">as.epidata()</a></code> and <code><a href="../reference/twinSIR_simulation.html">simEpidata()</a></code> calculate distance-based epidemic weights from the <code>f</code> functions, they no longer set the distance of an infectious individual to itself artificially to <code>Inf</code>. This changes the corresponding columns in the <code>"epidata"</code> in rows of currently infectious individuals, but the <code>twinSIR</code> model itself is invariant, since only rows with <code>atRiskY=1</code> contribute to the likelihood.</p></li>
<li><p>Several modifications and corrections in <code>data("hagelloch")</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-8-1">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-8-1"></a></h3>
<ul><li><p>Better plotting of <code>stsNC</code> objects by writing an own plot method for them. Prediction intervals are now shown jointly with the point estimate.</p></li>
<li><p>Reduced package size by applying <code><a href="https://rdrr.io/r/tools/checkRdaFiles.html" class="external-link">tools::resaveRdaFiles</a></code> to some large datasets and by building the package with <code>--compact-vignettes=both</code>, i.e., using additional GhostScript compression with ebook quality, see <code><a href="https://rdrr.io/r/tools/compactPDF.html" class="external-link">?tools::compactPDF</a></code>.</p></li>
<li><p>Added <code>units</code> argument to <code>stsplot_time</code> to select only a subset of the multivariate time series for plotting.</p></li>
<li><p>The <code>untie</code>-method for class <code>"epidataCS"</code> gained an argument <code>verbose</code> which is now <code>FALSE</code> by default.</p></li>
<li><p><code>"epidataCS"</code> objects store the <code>clipper</code> used during generation as attribute of <code>$events$.influenceRegion</code>.</p></li>
<li><p>In <code><a href="../reference/hhh4_plot.html">plotHHH4_fitted()</a></code>, the argument <code>legend.observed</code> now defaults to <code>FALSE</code>.</p></li>
<li><p>The default weights for the spatio-temporal component in <code>hhh4</code> models now are <code>neighbourhood(stsObj) == 1</code>. The previous default <code>neighbourhood(stsObj)</code> does not make sense for the newly supported <code>nbOrder</code> neighbourhood matrices (shortest-path distances). The new default makes no difference for (old) models with binary adjacency matrices in the neighbourhood slot of the <code>stsObj</code>.</p></li>
<li><p>The default for nonparametric weights <code><a href="../reference/hhh4_W.html">W_np()</a></code> in <code><a href="../reference/hhh4.html">hhh4()</a></code> is now to assume zero weight for neighbourhood orders above <code>maxlag</code>, i.e., <code><a href="../reference/hhh4_W.html">W_np()</a></code>’s argument <code>to0</code> now defaults to <code>TRUE</code>.</p></li>
<li><p>Added a <code>verbose</code> argument to <code><a href="../reference/permutationTest.html">permutationTest()</a></code>, which defaults to <code>FALSE</code>. The previous behaviour corresponds to <code>verbose=TRUE</code>.</p></li>
<li><p><code><a href="../reference/twinstim_simulation.html">simulate.twinstim()</a></code> now by default uses the original <code>data$W</code> as observation region.</p></li>
<li><p>The <code>data("measlesWeserEms")</code> contain two additional variables in the <code>@map@data</code> slot: <code>"vaccdoc.2004"</code> and <code>"vacc1.2004"</code>.</p></li>
<li><p>The plot-method for <code>"epidata"</code> objects now uses colored lines by default.</p></li>
<li><p>The <strong>surveillance</strong> package now depends on R &gt;= 3.0.2, which, effectively, is the minimum version required since <strong>surveillance</strong> 1.7-0.</p></li>
<li><p>The two diagnostic plots of <code><a href="../reference/checkResidualProcess.html">checkResidualProcess()</a></code> are now by default plotted side by side (<code>mfrow=c(1,2)</code>) instead of one below the other.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-8-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-8-1"></a></h3>
<ul><li><p>In <code>farringtonFlexible</code> alarms are now for <code>observed&gt;upperbound</code> and not for <code>observed&gt;=upperbound</code> which was not correct.</p></li>
<li><p>Fixed duplicate <code>"functions"</code> element resulting from <code>update.twinstim(*,model=TRUE)</code> and ensured that <code>"twinstim"</code> objects always have the same components (some may be <code>NULL</code>).</p></li>
<li><p><code>animate.epidata</code> works again with the <a href="https://CRAN.R-project.org/package=animation" class="external-link"><strong>animation</strong></a> package (<code>ani.options("outdir")</code> was removed in version 2.3)</p></li>
<li><p>For <code>hhh4</code> models with random effects, <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> only worked if argument <code>parm</code> was specified.</p></li>
<li><p>Computing one-sided AIC weights by simulation for <code>twinSIR</code> models with more than 2 epidemic covariates now is more robust (by rescaling the objective function for the quadratic programming solver) and twice as fast (due to code optimization).</p></li>
<li><p><code>simulate.twinstim(..., rmarks=NULL)</code> can now handle the case where <code>data</code> has no events within the simulation period (by sampling marks from all of <code>data$events</code>).</p></li>
<li><p>The <code>lambda.h</code> values of simulated events in <code>"simEpidataCS"</code> objects were wrong if the model contained an endemic intercept (which is usually the case).</p></li>
<li><p>Automatic choice of color breaks in the <code>animate</code>-method for class <code>"sts"</code> now also works for incidence maps (i.e., with a <code>population</code> argument).</p></li>
<li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> did not allow the use of nonparametric neighbourhood weights <code><a href="../reference/hhh4_W.html">W_np()</a></code> with <code>maxlag=2</code>.</p></li>
<li><p><code><a href="../reference/scores.html">scores()</a></code> did not work for multivariate <code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> predictions if both <code>individual=TRUE</code> and <code>sign=TRUE</code>, and it could not handle a <code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> prediction of only one time point. Furthermore, the <code>"sign"</code> column of <code>scores(..., sign=TRUE)</code> was wrong (reversed).</p></li>
<li><p>For <code>"epidataCS"</code> with only one event, <code><a href="../reference/epidataCS_plot.html">epidataCSplot_space()</a></code> did not draw the point.</p></li>
<li><p>The trivial (identity) call <code>aggregate(stsObj, nfreq=stsObj@freq)</code> did not work.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.8-0" id="surveillance-18-0-2014-06-16">surveillance 1.8-0 (2014-06-16)<a class="anchor" aria-label="anchor" href="#surveillance-18-0-2014-06-16"></a></h2>
<div class="section level3">
<h3 id="package-infrastructure-1-8-0">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-8-0"></a></h3>
<ul><li><p>Package <strong>surveillance</strong> now depends on newer versions of packages <a href="https://CRAN.R-project.org/package=sp" class="external-link"><strong>sp</strong></a> (&gt;= 1.0-15), <a href="https://CRAN.R-project.org/package=polyCub" class="external-link"><strong>polyCub</strong></a> (&gt;= 0.4-2), and <a href="https://CRAN.R-project.org/package=spatstat" class="external-link"><strong>spatstat</strong></a> (&gt;= 1.36-0). The R packages <strong>INLA</strong> and <a href="https://CRAN.R-project.org/package=runjags" class="external-link"><strong>runjags</strong></a> are now suggested to support a new outbreak detection algorithm (<code><a href="../reference/boda.html">boda()</a></code>) and the new <code><a href="../reference/nowcast.html">nowcast()</a></code>ing procedure, respectively. The R packages for <a href="https://CRAN.R-project.org/package=lattice" class="external-link"><strong>lattice</strong></a>, <a href="https://CRAN.R-project.org/package=grid" class="external-link"><strong>grid</strong></a>, <a href="https://CRAN.R-project.org/package=gridExtra" class="external-link"><strong>gridExtra</strong></a>, and <a href="https://CRAN.R-project.org/package=scales" class="external-link"><strong>scales</strong></a> are suggested for added visualization facilities.</p></li>
<li><p>More tests have been implemented to ensure package integrity. We now use <a href="https://CRAN.R-project.org/package=testthat" class="external-link"><strong>testthat</strong></a> instead of the outdated package <a href="https://CRAN.R-project.org/package=RUnit" class="external-link"><strong>RUnit</strong></a>.</p></li>
<li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> fits now have class <code>"hhh4"</code> instead of <code>"ah4"</code>, for consistency with <code><a href="../reference/twinstim.html">twinstim()</a></code>, <code><a href="../reference/twinSIR.html">twinSIR()</a></code>, and to follow the common convention (cp. <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>). Standard S3-methods for the old <code>"ah4"</code> name are still available for backwards compatibility but may be removed in the future.</p></li>
<li><p>Plot variants for <code>"sts"</code> objects have been cleaned up: The functions implementing the various plot types (<code>stsplot_*</code>, previously named <code>plot.sts.*</code>) are now exported and documented separately.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-8-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-8-0"></a></h3>
<ul><li><p>The <code>nowcast</code> procedure has been completely re-written to handle the inherit right-truncation of reporting data (best visualized as a reporting triangle). The new code implements the generalized-Dirichlet and the hierarchical Bayesian approach described in Höhle and an der Heiden (2014). No backwards compatibility to the old nowcasting procedure is given.</p></li>
<li><p>The package contains a new monitoring function <code>boda</code>. This is a first experimental surveillance implementation of the Bayesian Outbreak Detection Algorithm (BODA) proposed in Manitz and Höhle (2012). The function relies on the non-CRAN package <strong>INLA</strong>, which has to be installed first in order to use this function. Expect initial problems.</p></li>
<li><p>New <code>toLatex</code>-method for <code>"sts"</code> objects.</p></li>
<li><p>The new function <code><a href="../reference/stsplot_space.html">stsplot_space()</a></code> provides an improved map plot of disease incidence for <code>"sts"</code> objects aggregated over time. It corresponds to the new <code>type = observed ~ unit</code> of the <code>stsplot</code>-method, and supersedes <code>type = observed ~ 1|unit</code> (except for alarm shading).</p></li>
<li><p>An <code><a href="../reference/animate.html">animate()</a></code>-method for the <code>"sts"</code> class provides a new implementation for animated maps (superseding the <code>plot</code> <code>type=observed ~ 1 | unit * time</code>) with an optional evolving time series plot below the map.</p></li>
<li><p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for <code>"sts"</code> objects with epochs as dates is now made more flexible by introducing the arguments <code>xaxis.tickFreq</code>, <code>xaxis.labelFreq</code> and <code>xaxis.labelFormat</code>. These allow the specification of tick-marks and labelling based on <code>strftime</code> compatible conversion codes – independently if data are daily, weekly, monthly, etc. As a consequence, the old argument <code>xaxis.years</code> is removed. See <code><a href="../reference/stsplot_time.html">stsplot_time()</a></code> for more information.</p></li>
<li><p>Inference for neighbourhood weights in <code><a href="../reference/hhh4.html">hhh4()</a></code> models: <code><a href="../reference/hhh4_W.html">W_powerlaw()</a></code> and <code><a href="../reference/hhh4_W.html">W_np()</a></code> both implement weights depending on the order of neighbourhood between regions, a power-law decay and nonparametric weights, i.e., unconstrained estimation of individual weights for each neighbourhood order.</p></li>
<li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> now allows the inclusion of multiplicative offsets also in the epidemic components <code>"ar"</code> and <code>"ne"</code>.</p></li>
<li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> now has support for <code>lag != 1</code> in the autoregressive and neighbor-driven components. The applied lags are stored as component <code>"lags"</code> of the return value (previously there was an unused component <code>"lag"</code> which was always 1 and has been removed now).</p></li>
<li>
<p><code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code>:</p>
<ul><li><p>Added support for parallel computation of predictions using <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply()</a></code>.</p></li>
<li><p>New argument <code>type</code> with a new <code>type</code> <code>"first"</code> to base all subsequent one-step-ahead predictions on a single initial fit.</p></li>
<li><p>Nicer interpretation of <code>verbose</code> levels, and <code><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">txtProgressBar()</a></code>.</p></li>
</ul></li>
<li><p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>-method for fitted <code><a href="../reference/hhh4.html">hhh4()</a></code> objects now offers three additional types of plots: component seasonality, seasonal or time course of the dominant eigenvalue, and maps of estimated random intercepts. It is documented and more customizable. Note that argument order and some names have changed: <code>i</code> -&gt; <code>units</code>, <code>title</code> -&gt; <code>names</code>.</p></li>
<li><p>(Deviance) <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code>-method for fitted <code><a href="../reference/hhh4.html">hhh4()</a></code> models.</p></li>
<li><p>Added methods of <code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code> and <code><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs()</a></code> for the <code>"hhh4"</code> class. For <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code> and <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC()</a></code>, the default methods work smoothly now (due to changes to <code><a href="../reference/hhh4_methods.html">logLik.hhh4()</a></code> documented below).</p></li>
<li><p>New predefined interaction functions for <code><a href="../reference/twinstim.html">twinstim()</a></code>: <code><a href="../reference/twinstim_iaf.html">siaf.student()</a></code> implements a <em>t</em>-kernel for the distance decay, and <code><a href="../reference/twinstim_iaf.html">siaf.step()</a></code> and <code><a href="../reference/twinstim_iaf.html">tiaf.step()</a></code> provide step function kernels (which may also be invoked by specifying the vector of knots as the <code>siaf</code> or <code>tiaf</code> argument in <code>twinstim</code>).</p></li>
<li><p>Numerical integration over polygonal domains in the <code>F</code> and <code>Deriv</code> components of <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw()</a></code> and <code><a href="../reference/twinstim_iaf.html">siaf.powerlawL()</a></code> is much faster and more accurate now since we use the new <code>polyCub.iso()</code> instead of <code>polyCub.SV()</code> from package <a href="https://CRAN.R-project.org/package=polyCub" class="external-link"><strong>polyCub</strong></a>.</p></li>
<li><p>New <code><a href="https://rdrr.io/r/stats/stepfun.html" class="external-link">as.stepfun()</a></code>-method for <code>"epidataCS"</code> objects.</p></li>
<li>
<p><code><a href="../reference/epidataCS_plot.html">plot.epidataCS()</a></code>:</p>
<ul><li><p>The spatial plot has new arguments to automatically add legends to the plot: <code>legend.types</code> and <code>legend.counts</code>. It also gained an <code>add</code> argument.</p></li>
<li><p>The temporal plot now supports type-specific sub-histograms, additional lines for the cumulative number of events, and an automatic legend.</p></li>
</ul></li>
<li><p>The new function <code><a href="../reference/glm_epidataCS.html">glm_epidataCS()</a></code> can be used to fit an endemic-only <code><a href="../reference/twinstim.html">twinstim()</a></code> via <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>. This is mainly provided for testing purposes since wrapping into <code>glm</code> usually takes longer.</p></li>
</ul></div>
<div class="section level3">
<h3 id="significant-changes-1-8-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-8-0"></a></h3>
<ul><li><p>Fitted <code><a href="../reference/hhh4.html">hhh4()</a></code> objects no longer contain the associated <code>"sts"</code> data twice: it is now only stored as <code>$stsObj</code> component, the hidden duplicate in <code>$control$data$.sts</code> was dropped, which makes fitted objects substantially smaller.</p></li>
<li><p><code><a href="../reference/hhh4_methods.html">logLik.hhh4()</a></code> always returns an object of class <code>"logLik"</code> now; for random effects models, its <code>"df"</code> attribute is <code>NA_real_</code>. Furthermore, for non-convergent fits, <code><a href="../reference/hhh4_methods.html">logLik.hhh4()</a></code> gives a warning and returns <code>NA_real_</code>; previously, an error was thrown in this case.</p></li>
<li>
<p><code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code>:</p>
<ul><li><p>Default of <code>tp[2]</code> is now the penultimate time point of the fitted subset (not of the whole <code>stsObj</code>).</p></li>
<li><p><code>+1</code> on rownames of <code>$pred</code> (now the same as for <code>$observed</code>).</p></li>
</ul></li>
<li><p>The optional <code>"twinstim"</code> result components <code>fisherinfo</code>, <code>tau</code>, and <code>functions</code> are always included. They are set to <code>NULL</code> if they are not applicable instead of missing completely (as before), such that all <code>"twinstim"</code> objects have the same list structure.</p></li>
<li>
<p><code><a href="../reference/twinstim_iafplot.html">iafplot()</a></code> …</p>
<ul><li><p>invisibly returns a matrix containing the plotted values of the (scaled) interaction function (and the confidence interval as an attribute). Previously, nothing (<code>NULL</code>) was returned.</p></li>
<li><p>detects a type-specific interaction function and by default uses <code>types=1</code> if it is not type-specific.</p></li>
<li><p>has better default axis ranges.</p></li>
<li><p>adapts to the new step function kernels (with new arguments <code>verticals</code> and <code>do.points</code>).</p></li>
<li><p>supports logarithmic axes (via new <code>log</code> argument passed on to <code>plot.default</code>).</p></li>
<li><p>optionally respects <code>eps.s</code> and <code>eps.t</code>, respectively (by the new argument <code>truncated</code>).</p></li>
<li><p>now uses <code>scaled=TRUE</code> by default.</p></li>
</ul></li>
<li><p>The argument <code>colTypes</code> of <code>plot.epidataCS(,aggregate="space")</code> is deprecated (use <code>points.args$col</code> instead).</p></li>
<li><p>The events in an <code>"epidataCS"</code> object no longer have a reserved <code>"ID"</code> column.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-8-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-8-0"></a></h3>
<ul><li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> now stores the runtime just like <code><a href="../reference/twinstim.html">twinstim()</a></code>.</p></li>
<li><p>Take <code>verbose=FALSE</code> in <code><a href="../reference/hhh4.html">hhh4()</a></code> more seriously.</p></li>
<li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> issues a <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning()</a></code> if non-convergent.</p></li>
<li><p>The following components of a <code><a href="../reference/hhh4.html">hhh4()</a></code> fit now have names: <code>"se"</code>, <code>"cov"</code>, <code>"Sigma"</code>.</p></li>
<li><p>The new default for <code><a href="../reference/pit.html">pit()</a></code> is to produce the plot.</p></li>
<li><p>The <code><a href="../reference/twinstim.html">twinstim()</a></code> argument <code>cumCIF</code> now defaults to <code>FALSE</code>.</p></li>
<li><p><code><a href="../reference/twinstim_update.html">update.twinstim()</a></code> no longer uses recursive <code><a href="https://rdrr.io/r/utils/modifyList.html" class="external-link">modifyList()</a></code> for the <code>control.siaf</code> argument. Instead, the supplied new list elements (<code>"F"</code>, <code>"Deriv"</code>) completely replace the respective elements from the original <code>control.siaf</code> specification.</p></li>
<li><p><code>siaf.lomax()</code> is now defunct (it has been deprecated since version 1.5-2); use <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw()</a></code> instead.</p></li>
<li><p>Allow the default <code>adapt</code>ive bandwidth to be specified via the <code>F.adaptive</code> argument in <code><a href="../reference/twinstim_iaf.html">siaf.gaussian()</a></code>.</p></li>
<li><p>Unsupported options (<code>logpars=FALSE</code>, <code>effRangeProb</code>) have been dropped from <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw()</a></code> and <code><a href="../reference/twinstim_iaf.html">siaf.powerlawL()</a></code>.</p></li>
<li><p>More rigorous checking of <code>tiles</code> in <code><a href="../reference/twinstim_simulation.html">simulate.twinstim()</a></code> and <code><a href="../reference/twinstim_intensity.html">intensityplot.twinstim()</a></code>.</p></li>
<li><p><code><a href="../reference/epidataCS.html">as.epidataCS()</a></code> gained a <code>verbose</code> argument.</p></li>
<li><p><code><a href="../reference/epidataCS_animate.html">animate.epidataCS()</a></code> now by default does not draw influence regions (<code>col.influence=NULL</code>), is <code>verbose</code> if <code><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive()</a></code>, and ignores <code>sleep</code> on non-interactive devices.</p></li>
<li><p>The <code>multiplicity</code>-generic and its default method have been integrated into <a href="https://CRAN.R-project.org/package=spatstat" class="external-link"><strong>spatstat</strong></a> and are imported from there.</p></li>
</ul></div>
<div class="section level3">
<h3 id="data-1-8-0">Data<a class="anchor" aria-label="anchor" href="#data-1-8-0"></a></h3>
<ul><li><p>The polygon representation of Germany’s districts ( <code>system.file("shapes", "districtsD.RData", package="surveillance")</code> ) has been simplified further. The union of <code>districtsD</code> is used as observation window <code>W</code> in <code>data("imdepi")</code>. The exemplary <code><a href="../reference/twinstim.html">twinstim()</a></code> fit <code>data("imdepifit")</code> has been updated as well. Furthermore, <code>row.names(imdepi$events)</code> have been reset (chronological index), and numerical differences in <code>imdepi$events$.influenceRegion</code> are due to changes in <a href="https://CRAN.R-project.org/package=polyclip" class="external-link"><strong>polyclip</strong></a> 1.3-0.</p></li>
<li><p>The Campylobacteriosis data set <code>campyDE</code>, where absolute humidity is used as concurrent covariate to adjust the outbreak detection is added to the package to exemplify <code><a href="../reference/boda.html">boda()</a></code>.</p></li>
<li><p>New <code>data("measlesWeserEms")</code> (of class <code>"sts"</code>), a corrected version of <code>data("measles.weser")</code> (of the old <code>"disProg"</code> class).</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-8-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-8-0"></a></h3>
<ul><li><p>Fixed a bug in <code>LRCUSUM.runlength</code> where computations were erroneously always done under the in-control parameter <code>mu0</code> instead of <code>mu</code>.</p></li>
<li><p>Fixed a bug during alarm plots (<code><a href="../reference/stsplot_time.html">stsplot_alarm()</a></code>), where the use of <code>alarm.symbol</code> was ignored.</p></li>
<li><p>Fixed a bug in <code>algo.glrnb</code> where the overdispersion parameter <code>alpha</code> from the automatically fitted <code>glm.nb</code> model (fitted by <code>estimateGLRNbHook</code>) was incorrectly taken as <code>mod[[1]]$theta</code> instead of <code>1/mod[[1]]$theta</code>. The error is due to a different parametrization of the negative binomial distribution compared to the parametrization in Höhle and Paul (2008).</p></li>
<li><p>The score function of <code><a href="../reference/hhh4.html">hhh4()</a></code> was wrong when fitting endemic-only models to a <code>subset</code> including the first time point. This led to “false convergence”.</p></li>
<li><p><code><a href="../reference/twinstim.html">twinstim()</a></code> did not work without an endemic offset if <code>is.null(optim.args$par)</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.7-0" id="surveillance-17-0-2013-11-19">surveillance 1.7-0 (2013-11-19)<a class="anchor" aria-label="anchor" href="#surveillance-17-0-2013-11-19"></a></h2>
<div class="section level3">
<h3 id="package-infrastructure-1-7-0">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-7-0"></a></h3>
<ul><li><p>Package <a href="https://CRAN.R-project.org/package=gpclib" class="external-link"><strong>gpclib</strong></a> is no longer necessary for the construction of <code>"epidataCS"</code>-objects. Instead, we make use of the new dedicated package <a href="https://CRAN.R-project.org/package=polyclip" class="external-link"><strong>polyclip</strong></a> (licensed under the BSL) for polygon clipping operations (via <code>spatstat::intersect.owin()</code>). This results in a slightly different <code>$events$.influenceRegion</code> component of <code>"epidataCS"</code> objects, one reason being that <strong>polyclip</strong> uses integer arithmetic. Change of <code><a href="../reference/twinstim.html">twinstim()</a></code> estimates for a newly created <code>"epidataCS"</code> compared with the same data prepared in earlier versions should be very small (e.g., for <code>data("imdepifit")</code> the mean relative difference of coefficients is 3.7e-08, while the <code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code> is <code><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal()</a></code>). As an alternative, <strong>rgeos</strong> can still be chosen to do the polygon operations.</p></li>
<li><p>The <strong>surveillance</strong>-internal code now depends on R &gt;= 2.15.2 (for <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb()</a></code> <code>NA</code> fix of PR#15052, consistent <code>rownames(model.matrix)</code> of PR#14992, <code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0()</a></code>, <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mcmapply()</a></code>). However, the required recent version of <strong>spatstat</strong> (1.34-0, for <strong>polyclip</strong>) actually needs R &gt;= 3.0.2, which therefore also applies to <strong>surveillance</strong>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-7-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-7-0"></a></h3>
<ul><li><p>Functions <code><a href="../reference/unionSpatialPolygons.html">unionSpatialPolygons()</a></code> and <code><a href="../reference/intersectPolyCircle.html">intersectPolyCircle()</a></code> are now exported. Both are wrappers around functionality from different packages supporting polygon operations: for determining the union of all subpolygons of a <code>"SpatialPolygons"</code> object, and the intersection of a polygonal and a circular domain, respectively.</p></li>
<li><p><code><a href="../reference/discpoly.html">discpoly()</a></code> moved back from <a href="https://CRAN.R-project.org/package=polyCub" class="external-link"><strong>polyCub</strong></a> to <strong>surveillance</strong>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-7-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-7-0"></a></h3>
<ul><li><p><strong>surveillance</strong> now Depends on <a href="https://CRAN.R-project.org/package=polyCub" class="external-link"><strong>polyCub</strong></a> (&gt;= 0.4-0) and not only Imports it (which avoids <code>::</code>-references in .GlobalEnv-made functions).</p></li>
<li><p>Nicer default axis labels for <code><a href="../reference/twinstim_iafplot.html">iafplot()</a></code>.</p></li>
<li><p>For <code><a href="../reference/twinstim.html">twinstim()</a></code>, the default is now to <code>trace</code> every iteration instead of every fifth only.</p></li>
<li><p>Slightly changed default arguments for <code><a href="../reference/epidata_plot.html">plot.epidata()</a></code>: <code>lwd</code> (1-&gt;2), <code>rug.opts</code> (<code>col</code> is set according to <code>which.rug</code>)</p></li>
<li><p><code><a href="../reference/twinstim.html">twinstim()</a></code> saves the vector of <code>fixed</code> coefficients as part of the returned <code>optim.args</code> component, such that these will again be held fixed upon <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>.</p></li>
<li><p>The <code>plot</code>-method for <code><a href="../reference/hhh4.html">hhh4()</a></code>-fits allows for region selection by name.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.6-0" id="surveillance-16-0-2013-09-03">surveillance 1.6-0 (2013-09-03)<a class="anchor" aria-label="anchor" href="#surveillance-16-0-2013-09-03"></a></h2>
<div class="section level3">
<h3 id="synopsis-1-6-0">Synopsis<a class="anchor" aria-label="anchor" href="#synopsis-1-6-0"></a></h3>
<ul><li><p>The <code>polyCub</code>-methods for cubature over polygonal domains have been moved to the new dedicated package <a href="https://CRAN.R-project.org/package=polyCub" class="external-link"><strong>polyCub</strong></a>, since they are of a rather general use. The <code><a href="../reference/discpoly.html">discpoly()</a></code> function has also been moved to that package.</p></li>
<li><p>As a replacement for the license-restricted <strong>gpclib</strong> package, the <strong>rgeos</strong> package is now used by default (<code>surveillance.options(gpclib=FALSE)</code>) in generating <code>"epidataCS"</code> (polygon intersections, slightly slower). Therefore, when installing <strong>surveillance</strong> version 1.6-0, the system requirements for <a href="https://CRAN.R-project.org/package=rgeos" class="external-link"><strong>rgeos</strong></a> have to be met, i.e., GEOS must be available on the system. On Linux variants this means installing ‘libgeos’ (‘libgeos-dev’).</p></li>
<li><p>The improved Farrington method described in Noufaily et al. (2012) is now available as function <code><a href="../reference/farringtonFlexible.html">farringtonFlexible()</a></code>.</p></li>
<li><p>New handling of reference dates in <code><a href="../reference/algo.farrington.html">algo.farrington()</a></code> for <code>"sts"</code> objects with <code>epochAsDate=TRUE</code>. Instead of always going back in time to the next Date in the <code>"epoch"</code> slot, the function now determines the <em>closest</em> Date. Note that this might lead to slightly different results for the upperbound compared to previously. Furthermore, the functionality is only tested for weekly data (monthly data are experimental). The same functionality applies to <code><a href="../reference/farringtonFlexible.html">farringtonFlexible()</a></code>.</p></li>
<li><p>To make the different retrospective modelling frameworks of the <strong>surveillance</strong> package jointly applicable, it is now possible to convert (aggregate) <code>"epidataCS"</code> (continuous-time continuous-space data) into an <code>"sts"</code> object (multivariate time series of counts) by the new function <code>epidataCS2sts</code>.</p></li>
<li><p>Simulation from <code>hhh4</code> models has been re-implemented, which fixes a bug and makes it more flexible and compatible with a wider class of models.</p></li>
<li><p>The <code>map</code>-slot of the <code>"sts"</code> class now requires <code>"SpatialPolygons"</code> (only) instead of <code>"SpatialPolygonsDataFrame"</code>.</p></li>
<li><p>Re-implementation of <code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> for <code>hhh4</code>-models with a bug fix, some speed-up and more options.</p></li>
<li><p>Slight speed-up for <code><a href="../reference/hhh4.html">hhh4()</a></code> fits, e.g., by more use of <code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">.rowSums()</a></code> and <code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">.colSums()</a></code>.</p></li>
<li><p>Crucial speed-up for <code><a href="../reference/twinstim.html">twinstim()</a></code> fits by more efficient code: <code>mapply</code>, dropped clumsy <code>for</code>-loop in <code>fisherinfo</code>, new argument <code>cores</code> for parallel computing via forking (not available on Windows).</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-6-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-6-0"></a></h3>
<ul><li><p>Using <code><a href="../reference/twinstim_iaf.html">tiaf.exponential()</a></code> in a <code><a href="../reference/twinstim.html">twinstim()</a></code> now works with <code>nTypes=1</code> for multi-type data.</p></li>
<li><p>A legend can be added automatically in <code><a href="../reference/twinstim_iafplot.html">iafplot()</a></code>.</p></li>
<li><p>The <code>untie</code> methods are now able to produce jittered points with a required minimum separation (<code>minsep</code>).</p></li>
<li><p><code>simulate.ah4</code> gained a <code>simplify</code> argument.</p></li>
<li><p>New <code>update</code>-method for fitted <code>hhh4</code>-models (class <code>"ah4"</code>).</p></li>
<li><p><code><a href="../reference/hhh4_validation.html">oneStepAhead()</a></code> has more options: specify time range (not only start), choose type of start values, <code>verbose</code> argument.</p></li>
<li><p><code><a href="../reference/pit.html">pit()</a></code> allows for a list of predictive distributions (<code>pdistr</code>), one for each observation <code>x</code>.</p></li>
<li><p>New spatial auxiliary function <code><a href="../reference/polyAtBorder.html">polyAtBorder()</a></code> indicating polygons at the border (for a <code>"SpatialPolygons"</code> object).</p></li>
<li><p><code><a href="../reference/epidataCS_animate.html">animate.epidataCS()</a></code> allows for a <code>main</code> title and can show a progress bar.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-6-0">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-6-0"></a></h3>
<ul><li><p>Changed parametrization of <code><a href="../reference/zetaweights.html">zetaweights()</a></code> and completed its documentation (now no longer marked as experimental).</p></li>
<li><p><code>twinstim(...)$converged</code> is <code>TRUE</code> if the optimization routine converged (as before) but contains the failure message otherwise.</p></li>
<li><p>Increased default <code>maxit</code> for the Nelder-Mead optimizer in <code>hhh4</code> from 50 to 300, and removed default artificial lower bound (-20) on intercepts of epidemic components.</p></li>
<li><p>Renamed returned list from <code>oneStepAhead</code> (mean-&gt;pred, x-&gt;observed, params-&gt;coefficients, variances-&gt;Sigma.orig) for consistency, and <code>oneStepAhead()$psi</code> is only non-<code>NULL</code> if we have a NegBin model.</p></li>
<li><p>Argument order of <code><a href="../reference/pit.html">pit()</a></code> has changed, which is also faster now and got additional arguments <code>relative</code> and <code>plot</code>.</p></li>
<li><p><code>twinstim(...)$runtime</code> now contains the complete information from <code><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time()</a></code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-6-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-6-0"></a></h3>
<ul><li><p>Fixed a bug in function <code><a href="../reference/refvalIdxByDate.html">refvalIdxByDate()</a></code> which produced empty reference values (i.e. <code>NA</code>s) in case the Date entries of <code>epoch</code> were not mondays. Note: The function works by subtracting <code>1:b</code> years from the date of the range value and then takes the span <code>-w:w</code> around this value. For each value in this set it is determined whether the closest date in the epoch slot is obtained by going forward or backward. Note that this behaviour is now slightly changed compared to previously, where we <em>always</em> went back in time.</p></li>
<li><p><code><a href="../reference/algo.farrington.html">algo.farrington()</a></code>: Reference values too far back in time and hence not being in the <code>"epoch"</code> slot of the <code>"sts"</code> object are now ignored (previously the resulting <code>NA</code>s caused the function to halt). A warning is displayed in this case.</p></li>
<li><p><code>hhh4</code>: The entry <em>(5,6)</em> of the marginal Fisher information matrix in models with random intercepts in all three components was incorrect. If <code>nlminb</code> was used as optimizer for the variance parameters (using the negative marginal Fisher information as Hessian), this could have caused false convergence (with warning) or minimally biased convergence (without warning). As a consequence, the <code>"Sigma.cov"</code> component of the <code><a href="../reference/hhh4.html">hhh4()</a></code> result, which is the inverse of the marginal Fisher information matrix at the MLE, was also wrong.</p></li>
<li><p><code><a href="../reference/untie.html">untie.matrix()</a></code> could have produced jittering greater than the specified <code>amount</code>.</p></li>
<li><p><code>hhh4</code>: if there are no random intercepts, the redundant <code>updateVariance</code> steps are no longer evaluated.</p></li>
<li><p><code><a href="../reference/twinstim_update.html">update.twinstim()</a></code> did not work with <code>optim.args=..1</code> (e.g., if updating a list of models with lapply). Furthermore, if adding the <code>model</code> component only, the <code>control.siaf</code> and <code>optim.args</code> components were lost.</p></li>
<li><p><code>earsC</code> should now also work with multivariate <code>sts</code> time-series objects.</p></li>
<li><p>The last week in <code>data(fluBYBW)</code> (row index 417) has been removed. It corresponded to week 1 in year 2009 and was wrong (an artifact, filled with zero counts only). Furthermore, the regions in <code>@map</code> are now ordered the same as in <code>@observed</code>.</p></li>
<li><p>Fixed start value of the overdispersion parameter in <code>oneStepAhead</code> (must be on internal log-scale, not reparametrized as returned by <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> by default).</p></li>
<li><p>When subsetting <code>"sts"</code> objects in time, <code>@start</code> was updated but not <code>@epoch</code>.</p></li>
<li><p><code>pit</code> gave <code>NA</code> results if any <code>x[-1]==0</code>.</p></li>
<li><p>The returned <code>optim.args$par</code> vector in <code><a href="../reference/twinstim.html">twinstim()</a></code> was missing any fixed parameters.</p></li>
<li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> did not work with time-varying neighbourhood weights due to an error in the internal <code>checkWeightsArray()</code> function.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.5-4" id="surveillance-15-4-2013-04-21">surveillance 1.5-4 (2013-04-21)<a class="anchor" aria-label="anchor" href="#surveillance-15-4-2013-04-21"></a></h2>
<ul><li><p>Fixed obsolete <code>.path.package()</code> calls.</p></li>
<li><p>Small corrections in the documentation.</p></li>
<li><p><code><a href="../reference/twinstim_update.html">update.twinstim()</a></code> performs better in preserving the original initial values of the parameters.</p></li>
<li><p>New pre-defined spatial interaction function <code><a href="../reference/twinstim_iaf.html">siaf.powerlawL()</a></code>, which implements a _L_agged power-law kernel, i.e. accounts for uniform short-range dispersal.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.5-2" id="surveillance-15-2-2013-03-15">surveillance 1.5-2 (2013-03-15)<a class="anchor" aria-label="anchor" href="#surveillance-15-2-2013-03-15"></a></h2>
<div class="section level3">
<h3 id="new-features-1-5-2">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-5-2"></a></h3>
<ul><li><p>New method for outbreak detection: <code>earsC</code> (CUSUM-method described in the CDC Early Aberration Reporting System, see Hutwagner et al, 2003).</p></li>
<li><p>Yet another p-value formatting function <code><a href="../reference/formatPval.html">formatPval()</a></code> is now also part of the <strong>surveillance</strong> package.</p></li>
<li><p><code>polyCub.SV()</code> now also accepts objects of classes <code>"Polygon"</code> and <code>"Polygons"</code> for convenience.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-for-twinstim-1-5-2">New Features for <code>twinstim()</code>
<a class="anchor" aria-label="anchor" href="#new-features-for-twinstim-1-5-2"></a></h3>
<ul><li><p>New spatial interaction function <code><a href="../reference/twinstim_iaf.html">siaf.powerlaw()</a></code>, a re-parametrization of the now-deprecated <code>siaf.lomax()</code>.</p></li>
<li><p>The temporal <code>plot</code>-method for class <code>"epidataCS"</code> now understands the <code>add</code> parameter to add the histogram to an existing plot window, and auto-transforms the <code>t0.Date</code> argument using <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code> if necessary.</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs()</a></code> methods for classes <code>"epidataCS"</code> and <code>"twinstim"</code>.</p></li>
<li><p>New argument <code>verbose</code> for <code><a href="../reference/twinstim.html">twinstim()</a></code> which, if set to <code>FALSE</code>, disables the printing of information messages during execution.</p></li>
<li><p>New argument <code>start</code> for <code><a href="../reference/twinstim.html">twinstim()</a></code>, where (some) initial parameter values may be provided, which overwrite those in <code>optim.args$par</code>, which is no longer required (as a naive default, a crude estimate for the endemic intercept and zeroes for the other parameters are used).</p></li>
<li><p>Implemented a wrapper <code><a href="../reference/twinstim_step.html">stepComponent()</a></code> for <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step()</a></code> to perform algorithmic component-specific model selection in <code>"twinstim"</code> models. This also required the implementation of suitable <code><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms()</a></code> and <code><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC()</a></code> methods. The single-step methods <code><a href="https://rdrr.io/r/stats/add1.html" class="external-link">add1()</a></code> and <code><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1()</a></code> are also available.</p></li>
<li><p>The <code><a href="../reference/twinstim_update.html">update.twinstim()</a></code> method now by default uses the parameter estimates from the previous model as initial values for the new fit (new argument <code>use.estimates = TRUE</code>).</p></li>
<li><p><code><a href="../reference/epidataCS.html">as.epidataCS()</a></code> checks for consistency of the area of <code>W</code> and the (now really obligatory) area column in <code>stgrid</code>.</p></li>
<li><p><code><a href="../reference/twinstim_simulation.html">simulate.twinstim()</a></code> now by default uses the previous <code>nCircle2Poly</code> from the <code>data</code> argument.</p></li>
<li><p><code>direction</code> argument for <code><a href="../reference/untie.html">untie.epidataCS()</a></code>.</p></li>
<li><p>The <code>toLatex</code>-method for <code>"summary.twinstim"</code> got different defaults and a new argument <code>eps.Pvalue</code>.</p></li>
<li><p>New <code>xtable</code>-method for <code>"summary.twinstim"</code> for printing the covariate effects as risk ratios (with CI’s and p-values).</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-for-hhh4-1-5-2">New Features for <code>hhh4()</code>
<a class="anchor" aria-label="anchor" href="#new-features-for-hhh4-1-5-2"></a></h3>
<ul><li><p>New argument <code>hide0s</code> in the <code>plot</code>-method for class <code>"ah4"</code>.</p></li>
<li><p>New argument <code>timevar</code> for <code><a href="../reference/addSeason2formula.html">addSeason2formula()</a></code>, which now also works for long formulae.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.5-1" id="surveillance-15-1-2012-12-14">surveillance 1.5-1 (2012-12-14)<a class="anchor" aria-label="anchor" href="#surveillance-15-1-2012-12-14"></a></h2>
<ul><li>The <strong>surveillance</strong> package is again backward-compatible with R version 2.14.0, which is now declared as the minimum required version.</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.5-0" id="surveillance-15-0-2012-12-12">surveillance 1.5-0 (2012-12-12)<a class="anchor" aria-label="anchor" href="#surveillance-15-0-2012-12-12"></a></h2>
<div class="section level3">
<h3 id="package-infrastructure-1-5-0">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-5-0"></a></h3>
<ul><li><p>As requested by the CRAN team, examples now run faster. Some are conditioned on the value of the new package option <code>"allExamples"</code>, which usually defaults to <code>TRUE</code> (but is set to <code>FALSE</code> for CRAN checking, if timings are active).</p></li>
<li><p>Moved some rarely used package dependencies to “Suggests:”, and also removed some unused packages from there.</p></li>
<li><p>Dropped strict dependence on <a href="https://CRAN.R-project.org/package=gpclib" class="external-link"><strong>gpclib</strong></a>, which has a restricted license, for the <strong>surveillance</strong> package to be clearly GPL-2. Generation of <code>"epidataCS"</code> objects, which makes use of <strong>gpclib</strong>’s polygon intersection capabilities, now requires prior explicit acceptance of the <strong>gpclib</strong> license via setting <code>surveillance.options(gpclib = TRUE)</code>. Otherwise, <code><a href="../reference/epidataCS.html">as.epidataCS()</a></code> and <code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> may not be used.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-for-twinstim-1-5-0">New Features for <code>twinstim()</code>
<a class="anchor" aria-label="anchor" href="#new-features-for-twinstim-1-5-0"></a></h3>
<ul><li><p>Speed-up by memoisation of the <code>siaf</code> cubature (using the <a href="https://CRAN.R-project.org/package=memoise" class="external-link"><strong>memoise</strong></a> package).</p></li>
<li><p>Allow for <code>nlm</code>-optimizer (really not recommended).</p></li>
<li><p>Allow for <code>nlminb</code>-specific control arguments.</p></li>
<li><p>Use of the expected Fisher information matrix can be disabled for <code>nlminb</code> optimization.</p></li>
<li><p>Use of the <code>effRange</code>-trick can be disabled in <code><a href="../reference/twinstim_iaf.html">siaf.gaussian()</a></code> and <code>siaf.lomax()</code>. The default <code>effRangeProb</code> argument for the latter has been changed from 0.99 to 0.999.</p></li>
<li><p>The <code><a href="../reference/twinstim.html">twinstim()</a></code> argument <code>nCub</code> has been replaced by the new <code>control.siaf</code> argument list. The old <code>nCub.adaptive</code> indicator became a feature of the <code><a href="../reference/twinstim_iaf.html">siaf.gaussian()</a></code> generator (named <code>F.adaptive</code> there) and does no longer depend on the <code>effRange</code> specification, but uses the bandwidth <code>adapt*sd</code>, where the <code>adapt</code> parameter may be specified in the <code>control.siaf</code> list in the <code><a href="../reference/twinstim.html">twinstim()</a></code> call. Accordingly, the components <code>"nCub"</code> and <code>"nCub.adaptive"</code> have been removed from the result of <code><a href="../reference/twinstim.html">twinstim()</a></code>, and are replaced by <code>"control.siaf"</code>.</p></li>
<li><p>The <code>"method"</code> component of the <code><a href="../reference/twinstim.html">twinstim()</a></code> result has been replaced by the whole <code>"optim.args"</code>.</p></li>
<li><p>The new <code>"Deriv"</code> component of <code>siaf</code> specifications integrates the “siaf$deriv” function over a polygonal domain. <code><a href="../reference/twinstim_iaf.html">siaf.gaussian()</a></code> and <code>siaf.lomax()</code> use <code>polyCub.SV()</code> (with intelligent <code>alpha</code> parameters) for this task (previously: midpoint-rule with naive bandwidth)</p></li>
<li><p><code>scaled</code> <code><a href="../reference/twinstim_iafplot.html">iafplot()</a></code> (default <code>FALSE</code>). The <code>ngrid</code> parameter has been renamed to <code>xgrid</code> and is more general.</p></li>
<li><p>The <code>"simulate"</code> component of <code>siaf</code>’s takes an argument <code>ub</code> (upperbound for distance from the source).</p></li>
<li><p>Numerical integration of spatial interaction functions with an <code>Fcircle</code> trick is more precise now; this slightly changes previous results.</p></li>
<li><p>New S3-generic <code><a href="../reference/untie.html">untie()</a></code> with a method for the <code>"epidataCS"</code> class (to randomly break tied event times and/or locations).</p></li>
<li><p>Renamed <code>N</code> argument of <code>polyCub.SV()</code> to <code>nGQ</code>, and <code>a</code> to <code>alpha</code>, which both have new default values. The optional polygon rotation proposed by Sommariva &amp; Vianello is now also implemented (based on the corresponding MATLAB code) and available as the new <code>rotation</code> argument.</p></li>
<li><p>The <code>scale.poly()</code> method for <code>"gpc.poly"</code> is now available as <code><a href="../reference/surveillance-defunct.html">scale.gpc.poly()</a></code>. The default return class of <code><a href="../reference/discpoly.html">discpoly()</a></code> was changed from <code>"gpc.poly"</code> to <code>"Polygon"</code>.</p></li>
<li><p>An <code><a href="../reference/intensityplot.html">intensityplot()</a></code>-method is now also implemented for <code>"simEpidataCS"</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-for-hhh4-1-5-0">New Features for <code>hhh4()</code>
<a class="anchor" aria-label="anchor" href="#new-features-for-hhh4-1-5-0"></a></h3>
<ul><li><p>Significant speed-up (runs about 6 times faster now, amongst others by many code optimizations and by using sparse <a href="https://CRAN.R-project.org/package=Matrix" class="external-link"><strong>Matrix</strong></a> operations).</p></li>
<li><p><code><a href="../reference/hhh4.html">hhh4()</a></code> optimization routines can now be customized for the updates of regression and variance parameters separately, which for instance enables the use of Nelder-Mead for the variance updates, which seems to be more stable/robust as it does not depend on the inverse Fisher info and is usually faster.</p></li>
<li><p>The <code><a href="../reference/ranef.html">ranef()</a></code> extraction function for <code>"ah4"</code> objects gained a useful <code>tomatrix</code> argument, which re-arranges random effects in a unit x effect matrix (also transforming CAR effects appropriately).</p></li>
<li><p>Generalized <code><a href="../reference/hhh4.html">hhh4()</a></code> to also capture parametric neighbourhood weights (like a power-law decay). The new function <code><a href="../reference/nbOrder.html">nbOrder()</a></code> determines the neighbourhood order matrix from a binary adjacency matrix (depends on package <a href="https://CRAN.R-project.org/package=spdep" class="external-link"><strong>spdep</strong></a>).</p></li>
<li><p>New argument <code>check.analyticals</code> (default <code>FALSE</code>) mainly for development purposes.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-5-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-5-0"></a></h3>
<ul><li><p>Fixed sign of observed Fisher information matrix in <code>twinstim</code>.</p></li>
<li><p>Simulation from the Lomax kernel is now correct (via polar coordinates).</p></li>
<li><p>Fixed wrong Fisher information entry for the overdispersion parameter in <code>hhh4</code>-models.</p></li>
<li><p>Fixed wrong entries in penalized Fisher information wrt the combination fixed effects x CAR intercept.</p></li>
<li><p>Fixed indexing bug in penalized Fisher calculation in the case of multiple overdispersion parameters and random intercepts.</p></li>
<li><p>Fixed bug in Fisher matrix calculation concerning the relation of unit-specific and random effects (did not work previously).</p></li>
<li><p>Improved handling of non-convergent / degenerate solutions during <code>hhh4</code> optimization. This involves using <code>ginv()</code> from package <a href="https://CRAN.R-project.org/package=MASS" class="external-link"><strong>MASS</strong></a>, if the penalized Fisher info is singular.</p></li>
<li><p>Correct labeling of overdispersion parameter in <code>"ah4"</code>-objects.</p></li>
<li><p>Some control arguments of <code><a href="../reference/hhh4.html">hhh4()</a></code> have more clear defaults.</p></li>
<li><p>The result of <code><a href="../reference/algo.farrington.fitGLM.html">algo.farrington.fitGLM.fast()</a></code> now additionally inherits from the <code>"lm"</code> class to avoid warnings from <code><a href="https://rdrr.io/r/stats/predict.lm.html" class="external-link">predict.lm()</a></code> about fake object.</p></li>
<li><p>Improved ‘NAMESPACE’ imports.</p></li>
<li><p>Some additional tiny bug fixes, see the subversion log on R-Forge for details.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.4-2" id="surveillance-14-2-2012-08-17">surveillance 1.4-2 (2012-08-17)<a class="anchor" aria-label="anchor" href="#surveillance-14-2-2012-08-17"></a></h2>
<div class="section level3">
<h3 id="package-infrastructure-1-4-2">Package Infrastructure<a class="anchor" aria-label="anchor" href="#package-infrastructure-1-4-2"></a></h3>
<ul><li>The package is now again compatible with older releases of R (&lt; 2.15.0) as intended (by defining <code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0()</a></code> in the package namespace if it is not found in R <strong>base</strong> at installation of the <strong>surveillance</strong> package).</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-4-2">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-4-2"></a></h3>
<ul><li><p>Important new <code><a href="../reference/twinstim.html">twinstim()</a></code>-feature: fix parameters during optimization.</p></li>
<li><p>Useful <code>update</code>-method for <code>"twinstim"</code>-objects.</p></li>
<li><p>New <code>[[</code>- and <code>plot</code>-methods for <code>"simEpidataCSlist"</code>-objects.</p></li>
<li><p><code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> received tiny bug fixes and is now able to simulate from epidemic-only models.</p></li>
<li><p><code>R0</code>-method for <code>"simEpidataCS"</code>-objects (actually a wrapper for <code><a href="../reference/R0.html">R0.twinstim()</a></code>).</p></li>
<li><p>Removed <code>dimyx</code> and <code>eps</code> arguments from <code><a href="../reference/R0.html">R0.twinstim()</a></code>; now uses <code>nCub</code> and <code>nCub.adaptive</code> from the fitted model and applies the same (numerical) integration method.</p></li>
<li><p><code>animate.epidata</code> is now compatible with the <a href="https://CRAN.R-project.org/package=animation" class="external-link"><strong>animation</strong></a> package.</p></li>
<li><p>More thorough documentation of <code>"twinstim"</code>-related functions <em>including many examples</em>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-for-twinstim-1-4-2">Bug Fixes for <code>twinstim()</code>
<a class="anchor" aria-label="anchor" href="#bug-fixes-for-twinstim-1-4-2"></a></h3>
<ul><li><p><code>nlminb</code> (instead of <code>optim</code>’s <code>"BFGS"</code>) is now the default optimizer (as already documented).</p></li>
<li><p>The <code>twinstim</code>-argument <code>nCub</code> can now be omitted when using <code><a href="../reference/twinstim_iaf.html">siaf.constant()</a></code> (as documented) and is internally set to <code>NA_real_</code> in this case. Furthermore, <code>nCub</code> and <code>nCub.adaptive</code> are set to <code>NULL</code> if there is no epidemic component in the model.</p></li>
<li><p><code>toLatex.summary.twinstim</code> now again works for <code>summary(*, test.iaf=FALSE)</code>.</p></li>
<li><p><code>print</code>- and <code>summary</code>-methods for <code>"epidataCS"</code> no longer assume that the <code>BLOCK</code> index starts at 1, which may not be the case when using a subset in <code><a href="../reference/twinstim_simulation.html">simulate.twinstim()</a></code>.</p></li>
<li><p>The <code>"counter"</code> step function returned by <code><a href="../reference/epidataCS.html">summary.epidataCS()</a></code> does no longer produce false numbers of infectives (they were lagged by one timepoint).</p></li>
<li><p><code><a href="../reference/epidataCS_plot.html">plot.epidataCS()</a></code> now resolves … correctly and the argument <code>colTypes</code> takes care of a possible <code>subset</code>.</p></li>
<li><p><code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> now also works for endemic-only models and is synchronised with <code><a href="../reference/twinstim.html">twinstim()</a></code> regarding the way how <code>siaf</code> is numerically integrated (including the argument <code>nCub.adaptive</code>).</p></li>
<li><p>Fixed problem with <code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> related to missing ‘NAMESPACE’ imports (and re-exports) of <code>marks.ppp</code> and <code>markformat.default</code> from <a href="https://CRAN.R-project.org/package=spatstat" class="external-link"><strong>spatstat</strong></a>, which are required for <code>spatstat::runifpoint()</code> to work, probably because <strong>spatstat</strong> currently does not register its S3-methods.</p></li>
<li><p>Improved error handling in <code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code>. Removed a <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code>-call and avoid potentially infinite loop.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-for-twinsir-1-4-2">Bug Fixes for <code>twinSIR()</code>
<a class="anchor" aria-label="anchor" href="#bug-fixes-for-twinsir-1-4-2"></a></h3>
<ul><li><p>The <code>.allocate</code> argument of <code><a href="../reference/twinSIR_simulation.html">simEpidata()</a></code> has now a fail-save default.</p></li>
<li><p>Simulation without endemic <code><a href="../reference/twinSIR_cox.html">cox()</a></code>-terms now works.</p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-4-2">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-4-2"></a></h3>
<ul><li><p>Simplified <code>imdepi</code> data to monthly instead of weekly intervals in <code>stgrid</code> for faster examples and reduced package size.</p></li>
<li><p>The environment of all predefined interaction functions for <code><a href="../reference/twinstim.html">twinstim()</a></code> is now set to the <code>.GlobalEnv</code>. The previous behaviour of defining them in the <code><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame()</a></code> could have led to huge <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code>’s of <code>"twinstim"</code> objects even with <code>model=FALSE</code>.</p></li>
<li><p><code>simulate.twinSIR</code> only returns a list of epidemics if <code>nsim &gt; 1</code>.</p></li>
<li><p><code>simulate.twinstim</code> uses <code>nCub</code> and <code>nCub.adaptive</code> from fitted object as defaults.</p></li>
<li><p>Removed the …-argument from <code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code>.</p></li>
<li><p>The coefficients returned by <code><a href="../reference/twinstim_simulation.html">simEpidataCS()</a></code> are now stored in a vector rather than a list for compatibility with <code>"twinstim"</code>-methods.</p></li>
<li><p>Argument <code>cex.fun</code> of <code><a href="../reference/twinstim_intensity.html">intensityplot.twinstim()</a></code> now defaults to the <code>sqrt</code> function (as in <code><a href="../reference/epidataCS_plot.html">plot.epidataCS()</a></code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.4" id="surveillance-14-2012-07-26">surveillance 1.4 (2012-07-26)<a class="anchor" aria-label="anchor" href="#surveillance-14-2012-07-26"></a></h2>
<div class="section level3">
<h3 id="synopsis-1-4">Synopsis<a class="anchor" aria-label="anchor" href="#synopsis-1-4"></a></h3>
<ul><li>Besides minor bug fixes, additional functionality has entered the package and a new attempt is made to finally release a new version on CRAN (version 1.3 has not appeared on CRAN), including a proper ‘NAMESPACE’.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-4">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-4"></a></h3>
<ul><li><p>Support for non-parametric back-projection using the function <code><a href="../reference/backprojNP.html">backprojNP()</a></code> which returns an object of the new <code>"stsBP"</code> class which inherits from <code>"sts"</code>.</p></li>
<li><p>Bayesian nowcasting for discrete time count data is implemented in the function <code><a href="../reference/nowcast.html">nowcast()</a></code>.</p></li>
<li><p>Methods for cubature over polygonal domains can now also visualize what they do. There is also a new quasi-exact method for cubature of the bivariate normal density over polygonal domains. The function <code>polyCub()</code> is a wrapper for the different methods.</p></li>
<li><p><code><a href="../reference/residualsCT.html">residuals.twinstim()</a></code> and <code><a href="../reference/residualsCT.html">residuals.twinSIR()</a></code>: extract the “residual process”, see Ogata (1988). The residuals of <code>"twinSIR"</code> and <code>"twinstim"</code> models may be checked graphically by the new function <code><a href="../reference/checkResidualProcess.html">checkResidualProcess()</a></code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="significant-changes-for-twinstim-1-4">Significant Changes for <code>"twinstim"</code>
<a class="anchor" aria-label="anchor" href="#significant-changes-for-twinstim-1-4"></a></h3>
<ul><li><p>Modified arguments of <code><a href="../reference/twinstim.html">twinstim()</a></code>: new ordering, new argument <code>nCub.adaptive</code>, removed argument <code>typeSpecificEndemicIntercept</code> (which is now specified as part of the <code>endemic</code> formula as <code>(1|type)</code>).</p></li>
<li><p>Completely rewrote the <code>R0</code>-method (calculate “trimmed” and “untrimmed” <em>R_0</em> values)</p></li>
<li><p>The “trimmed” <code>R0</code> values are now part of the result of the model fit, as well as <code>bbox(W)</code>. The model evaluation environment is now set as attribute of the result if <code>model=TRUE</code>.</p></li>
<li><p>New predefined spatial kernel: the Lomax power law kernel <code>siaf.lomax()</code></p></li>
<li><p><code>plot</code>-methods for <code>"twinstim"</code> (<code><a href="../reference/intensityplot.html">intensityplot()</a></code> and <code><a href="../reference/twinstim_iafplot.html">iafplot()</a></code>)</p></li>
<li><p><code><a href="../reference/epidataCS.html">as.epidataCS()</a></code> now auto-generates the stop-column if this is missing</p></li>
<li><p><code>print</code>-method for class <code>"summary.epidataCS"</code></p></li>
<li><p><code>[</code>- and subset-method for <code>"epidataCS"</code> (subsetting <code>...$events</code>)</p></li>
<li><p><code>plot</code>-method for <code>"epidataCS"</code></p></li>
</ul></div>
<div class="section level3">
<h3 id="minor-changes-1-4">Minor Changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-4"></a></h3>
<ul><li><p>Improved documentation for the new functionalities.</p></li>
<li><p>Updated references.</p></li>
<li><p><code>twinSIR</code>’s <code>intensityPlot</code> is now a method of the new S3-generic function <code>intensityplot</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.3" id="surveillance-13-2011-04-25">surveillance 1.3 (2011-04-25)<a class="anchor" aria-label="anchor" href="#surveillance-13-2011-04-25"></a></h2>
<div class="section level3">
<h3 id="synopsis-1-3">Synopsis<a class="anchor" aria-label="anchor" href="#synopsis-1-3"></a></h3>
<ul><li>This is a major release integrating plenty of new code (unfortunately not all documented as good as it could be). This includes code for the <code>"twinstim"</code> and the <code>"hhh4"</code> model. The <code>"twinSIR"</code> class of models has been migrated from package <strong>RLadyBug</strong> to <strong>surveillance</strong>. It may take a while before this version will become available from CRAN.</li>
</ul></div>
<div class="section level3">
<h3 id="significant-changes-1-3">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-3"></a></h3>
<ul><li><p>Renamed the <code>"week"</code> slot of the <code>"sts"</code> S4 class to <code>"epoch"</code>. All saved data objects have accordingly be renamed, but some hassle is to be expected if one you have old <code>"sts"</code> objects stored in binary form. The function <code>convertSTS()</code> can be used to convert such “old school” <code>"sts"</code> objects.</p></li>
<li><p>Removed the functions <code><a href="../reference/algo.cdc.html">algo.cdc()</a></code> and <code><a href="../reference/algo.rki.html">algo.rki()</a></code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-3">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-3"></a></h3>
<ul><li><p>Support for <code>"twinSIR"</code> models (with associated <code>"epidata"</code> objects) as described in Höhle (2009) has been moved from package <strong>RLadyBug</strong> to <strong>surveillance</strong>. That means continuous-time discrete-space SIR models.</p></li>
<li><p>Support for <code>"twinstim"</code> models as described in Meyer et al (2012). That means continuous-time continuous-space infectious disease models.</p></li>
<li><p>Added functionality for non-parametric back projection (<code><a href="../reference/backprojNP.html">backprojNP()</a></code>) and now-casting (<code><a href="../reference/nowcast.html">nowcast()</a></code>) based on <code>"sts"</code> objects.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.2-2" id="surveillance-12-2">surveillance 1.2-2<a class="anchor" aria-label="anchor" href="#surveillance-12-2"></a></h2>
<ul><li><p>Replaced the deprecated <code>getSpPPolygonsLabptSlots()</code> calls by <code><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">sp::coordinates()</a></code> when plotting the map slot.</p></li>
<li><p>Minor proof-reading of the documentation.</p></li>
<li><p>Added an argument <code>"extraMSMargs"</code> to the algo.hmm function.</p></li>
<li><p>Fixed bug in <code><a href="../reference/wrap.algo.html">outbreakP()</a></code> when having observations equal to zero in the beginning. Here, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mrow><mi>C</mi><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">\hat{\mu}^{C1}</annotation></semantics></math> in (5) of Frisen et al (2008) is zero and hence the log-based summation in the code failed. Changed to product as in the original code, which however might be less numerically stable.</p></li>
<li><p>Fixed bug in stcd which added one to the calculated index of idxFA and idxCC. Thanks to Thais Rotsen Correa for pointing this out.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.2-1" id="surveillance-12-1-2010-06-10">surveillance 1.2-1 (2010-06-10)<a class="anchor" aria-label="anchor" href="#surveillance-12-1-2010-06-10"></a></h2>
<ul><li><p>Added <code><a href="../reference/algo.outbreakP.html">algo.outbreakP()</a></code> (Frisen &amp; Andersson, 2009) providing a semiparametric approach for outbreak detection for Poisson distributed variables.</p></li>
<li><p>Added a pure R function for extracting ISO week and year from Date objects. This function (isoWeekYear) is only called if <code>"%G"</code> and <code>"%V"</code> format strings are used on Windows (<code>sessionInfo()[[1]]$os == "mingw32"</code>) as this is not implemented for <code>"format.Date"</code> on Windows. Thanks to Ashley Ford, University of Warwick, UK for identifying this Windows specific bug.</p></li>
<li><p>For <code><a href="../reference/algo.farrington.html">algo.farrington()</a></code> a faster fit routine <code>"algo.farrington.fitGLM.fast"</code> has been provided by Mikko Virtanen, National Institute for Health and Welfare, Finland. The new function calls <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit()</a></code> directly, which gives a doubling of speed for long series. However, if one wants to process the fitted model output some of the GLM routines might not work on this output. For backwards compatibility the argument <code>control$fitFun = "algo.farrington.fitGLM"</code> provides the old (and slow) behaviour.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.1-6" id="surveillance-11-6-2010-05-25">surveillance 1.1-6 (2010-05-25)<a class="anchor" aria-label="anchor" href="#surveillance-11-6-2010-05-25"></a></h2>
<ul><li><p>A few minor bug fixes</p></li>
<li><p>Small improvements in the C-implementation of the <code>twins()</code> function by Daniel Sabanés Bové fixing the segmentation fault issue on 64-bit architectures.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.1-2" id="surveillance-11-2-2009-10-15">surveillance 1.1-2 (2009-10-15)<a class="anchor" aria-label="anchor" href="#surveillance-11-2-2009-10-15"></a></h2>
<ul><li><p>Added the functions categoricalCUSUM and LRCUSUM.runlength for the CUSUM monitoring of general categorical time series (binomial, beta-binomial, multinomial, ordered response, Bradley-Terry models).</p></li>
<li><p>Added the functions pairedbinCUSUM and pairedbinCUSUM.runlength implementing the CUSUM monitoring and run-length computations for a paired binary outcome as described in Steiner et al. (1999).</p></li>
<li><p>Experimental implementation of the prospective space-time cluster detection described in Assuncao and Correa (2009).</p></li>
<li><p>Added a <code>demo("biosurvbook")</code> containing the code of an upcoming book chapter on how to use the surveillance package. This contains the description of ISO date use, negative binomial CUSUM, run-length computation, etc. From an applicational point of view the methods are illustrated by Danish mortality monitoring.</p></li>
<li><p>Fixed a small bug in algo.cdc found by Marian Talbert Allen which resulted in the control$m argument being ignored.</p></li>
<li><p>The constructor of the sts class now uses the argument <code>"epoch"</code> instead of weeks to make clearer that also daily, monthly or other data can be handled.</p></li>
<li><p>Added additional epochAsDate slot to sts class. Modified plot functions so they can handle ISO weeks.</p></li>
<li><p>algo.farrington now also computes quantile and median of the predictive distribution. Furthermore has the computation of reference values been modified so its a) a little bit faster and b) it is also able to handle ISO weeks now. The reference values for date t0 are calculated as follows: For i, i=1,…, b look at date t0 - i*year. From this date on move w months/weeks/days to the left and right. In case of weeks: For each of these determined time points go back in time to the closest Monday</p></li>
<li><p>Renamed the functions obsinyear to epochInYear, which now also handles objects of class Date.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.0-2" id="surveillance-10-2-2009-03-06">surveillance 1.0-2 (2009-03-06)<a class="anchor" aria-label="anchor" href="#surveillance-10-2-2009-03-06"></a></h2>
<ul><li><p>Negative Binomial CUSUM or the more general NegBin likelihood ratio detector is now implemented as part of algo.glrnb. This includes the back calculation of the required number of cases before an alarm.</p></li>
<li><p>Time varying proportion binomial CUSUM.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.9-10" id="surveillance-09-10">surveillance 0.9-10<a class="anchor" aria-label="anchor" href="#surveillance-09-10"></a></h2>
<ul><li><p>Current status: Development version available from <a href="http://surveillance.r-forge.r-project.org/" class="external-link uri">http://surveillance.r-forge.r-project.org/</a></p></li>
<li><p>Rewriting of the plot.sts.time.one function to use polygons instead of lines for the number of observed cases. Due cause a number of problems were fixed in the plotting of the legend. Plotting routine now also handles binomial data, where the number of observed cases y are stored in <code>"observed"</code> and the denominator data n are stored in <code>"populationFrac"</code>.</p></li>
<li><p>Problems with the aggregate function not operating correctly for the populationFrac were fixed.</p></li>
<li><p>The <code>"rogerson"</code> wrapper function for algo.rogerson was modified so it now works better for distribution <code>"binomial"</code>. Thus a time varying binomial cusum can be run by calling <code>rogerson( x, control(..., distribution="binomial"))</code></p></li>
<li><p>An experimental implementation of the twins model documented in Held, L., Hofmann, M., Höhle, M. and Schmid V. (2006). A two-component model for counts of infectious diseases, Biostatistics, 7, pp. 422–437 is now available as algo.twins.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.9-9" id="surveillance-09-9-2008-01-21">surveillance 0.9-9 (2008-01-21)<a class="anchor" aria-label="anchor" href="#surveillance-09-9-2008-01-21"></a></h2>
<ul><li>Fixed a few small problems which gave warnings in the CRAN distribution</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.9-8" id="surveillance-09-8-2008-01-19">surveillance 0.9-8 (2008-01-19)<a class="anchor" aria-label="anchor" href="#surveillance-09-8-2008-01-19"></a></h2>
<ul><li><p>The algo_glrpois function now has an additional <code>"ret"</code> arguments, where one specifies the return type. The arguments of the underlying c functions have been changed to include an additional direction and return type value arguments.</p></li>
<li><p>added restart argument to the algo.glrpois control object, which allows the user to control what happens after the first alarm has been generated</p></li>
<li><p>experimental algo.glrnb function is added to the package. All calls to algo.glrpois are now just alpha=0 calls to this function. However, the underlying C functions differentiate between poisson and negative case</p></li>
</ul></div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by <a href="https://www.imbe.med.fau.de/person/sebastian-meyer" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>



  </body></html>

